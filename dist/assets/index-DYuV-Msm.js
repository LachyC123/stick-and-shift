var j=Object.defineProperty;var $=(g,o,e)=>o in g?j(g,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[o]=e;var c=(g,o,e)=>$(g,typeof o!="symbol"?o+"":o,e);import{P as p}from"./phaser-0RJB29YE.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&t(n)}).observe(document,{childList:!0,subtree:!0});function e(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(s){if(s.ep)return;s.ep=!0;const i=e(s);fetch(s.href,i)}})();class _{constructor(o){c(this,"scene");this.scene=o}generateAll(){this.generatePlayerTextures(),this.generateEnemyTextures(),this.generateBallTexture(),this.generateGoalTextures(),this.generatePitchTextures(),this.generateUITextures(),this.generateParticleTextures(),this.generateEffectTextures()}generatePlayerTextures(){[3447003,15158332,3066993,10181046,15965202,1752220,15105570,9323693,15844367,1482885,12597547,2600544,13849600,2719929,9109504,48340,6765239,16733986,3426654,15277667].forEach((e,t)=>{this.createPlayerSprite(`player_${t}`,e,!1)}),this.createPlayerSprite("player_selected",16777215,!0)}createPlayerSprite(o,e,t){const i=this.scene.add.graphics();i.fillStyle(0,.3),i.fillEllipse(48/2+2,42,28,12);const n=e;i.fillStyle(n,1),i.fillRoundedRect(48/2-12,8,24,28,6),i.fillStyle(16777215,.2),i.fillRoundedRect(48/2-10,10,8,24,4),i.fillStyle(0,.2),i.fillRoundedRect(48/2+2,10,8,24,4),i.fillStyle(16111048,1),i.fillCircle(48/2,10,10),i.lineStyle(2,3355443,1),i.strokeCircle(48/2,10,10),i.lineStyle(2,3355443,1),i.strokeRoundedRect(48/2-12,8,24,28,6),i.fillStyle(2899536,1),i.fillRoundedRect(48/2-10,34,8,12,3),i.fillRoundedRect(48/2+2,34,8,12,3),i.lineStyle(4,9127187,1),i.beginPath(),i.moveTo(48/2+14,12),i.lineTo(48/2+20,40),i.lineTo(48/2+28,42),i.strokePath(),i.fillStyle(3355443,1),i.fillRoundedRect(48/2+17,38,14,6,2),t&&(i.lineStyle(3,16776960,.8),i.strokeCircle(48/2,48/2,48/2-4)),i.generateTexture(o,48,48),i.destroy()}generateEnemyTextures(){[{key:"enemy_defender",color:8359053},{key:"enemy_mid",color:9807270},{key:"enemy_forward",color:12436423},{key:"enemy_boss",color:16739179},{key:"enemy_orange",color:16749824}].forEach(({key:e,color:t})=>{this.createEnemySprite(e,t,e==="enemy_boss"||e==="enemy_orange")})}createEnemySprite(o,e,t){const s=t?56:48,i=this.scene.add.graphics();i.fillStyle(0,.3),i.fillEllipse(s/2+2,s-6,t?36:28,12),i.fillStyle(e,1),i.fillRect(s/2-14,10,28,26),i.fillStyle(e,1),i.fillTriangle(s/2-14,10,s/2-20,18,s/2-14,26),i.fillTriangle(s/2+14,10,s/2+20,18,s/2+14,26),i.fillStyle(0,.3),i.fillRect(s/2,12,12,22),i.fillStyle(5592405,1),i.fillCircle(s/2,10,10),t?(i.fillStyle(16711680,1),i.fillCircle(s/2-4,9,3),i.fillCircle(s/2+4,9,3)):(i.fillStyle(16777215,1),i.fillCircle(s/2-4,9,2),i.fillCircle(s/2+4,9,2)),i.lineStyle(2,1710618,1),i.strokeRect(s/2-14,10,28,26),i.strokeCircle(s/2,10,10),i.fillStyle(1710618,1),i.fillRect(s/2-10,34,8,12),i.fillRect(s/2+2,34,8,12),i.lineStyle(4,4868682,1),i.beginPath(),i.moveTo(s/2-14,14),i.lineTo(s/2-22,40),i.lineTo(s/2-30,42),i.strokePath(),i.fillStyle(1710618,1),i.fillRoundedRect(s/2-33,38,14,6,2),t&&(i.lineStyle(3,16711680,.5),i.strokeCircle(s/2,s/2,s/2-2)),i.generateTexture(o,s,s),i.destroy()}generateBallTexture(){const e=this.scene.add.graphics();e.fillStyle(0,.3),e.fillEllipse(20/2+1,20/2+3,14,8),e.fillStyle(16777215,1),e.fillCircle(20/2,20/2-2,8),e.fillStyle(14737632,1),e.fillCircle(20/2-3,20/2-4,2),e.fillCircle(20/2+2,20/2-1,2),e.fillCircle(20/2-1,20/2,1.5),e.fillStyle(16777215,.8),e.fillCircle(20/2-3,20/2-5,3),e.lineStyle(1.5,10066329,1),e.strokeCircle(20/2,20/2-2,8),e.generateTexture("ball",20,20),e.destroy();const t=this.scene.add.graphics();t.fillStyle(16777215,.5),t.fillCircle(6,6,5),t.generateTexture("ball_trail",12,12),t.destroy()}generateGoalTextures(){this.createGoalTexture("goal_left",!0),this.createGoalTexture("goal_right",!1)}createGoalTexture(o,e){const i=this.scene.add.graphics();i.fillStyle(2960685,1),e?i.fillRect(0,0,8,120):i.fillRect(32,0,8,120),i.lineStyle(1,13421772,.7);const n=e?8:0,a=e?40:32;for(let l=5;l<120;l+=10)i.beginPath(),i.moveTo(n,l),i.lineTo(a,l),i.strokePath();for(let l=0;l<20;l++)i.beginPath(),i.moveTo(n,l*10),i.lineTo(a,l*10+20),i.strokePath(),i.beginPath(),i.moveTo(n,l*10+20),i.lineTo(a,l*10),i.strokePath();i.fillStyle(16777215,1);const r=e?34:0;i.fillRect(r,0,6,4),i.fillRect(r,116,6,4),i.fillRect(r,0,6,120),i.lineStyle(2,3355443,1),i.strokeRect(r,0,6,4),i.strokeRect(r,116,6,4),i.generateTexture(o,40,120),i.destroy()}generatePitchTextures(){this.createTurfTexture(),this.createLineTexture(),this.createCircleTexture()}createTurfTexture(){const t=this.scene.add.graphics();t.fillStyle(2263842,1),t.fillRect(0,0,64,64),t.fillStyle(1997598,1);for(let s=0;s<64;s+=16)t.fillRect(0,s,64,8);t.fillStyle(1731354,.3);for(let s=0;s<30;s++){const i=Math.random()*64,n=Math.random()*64;t.fillCircle(i,n,1)}t.generateTexture("turf",64,64),t.destroy()}createLineTexture(){const o=this.scene.add.graphics();o.fillStyle(16777215,1),o.fillRect(0,0,100,4),o.generateTexture("line_h",100,4),o.clear(),o.fillStyle(16777215,1),o.fillRect(0,0,4,100),o.generateTexture("line_v",4,100),o.destroy()}createCircleTexture(){const e=this.scene.add.graphics();e.lineStyle(4,16777215,1),e.strokeCircle(200/2,200/2,200/2-4),e.generateTexture("circle",200,200),e.destroy();const t=this.scene.add.graphics();t.lineStyle(4,16777215,1),t.beginPath(),t.arc(0,75,75,-Math.PI/2,Math.PI/2,!1),t.strokePath(),t.generateTexture("d_right",80,150),t.clear(),t.lineStyle(4,16777215,1),t.beginPath(),t.arc(80,75,75,Math.PI/2,-Math.PI/2,!1),t.strokePath(),t.generateTexture("d_left",80,150),t.destroy()}generateUITextures(){this.createButtonTexture("btn_normal",3447003,2719929),this.createButtonTexture("btn_hover",6139362,3447003),this.createButtonTexture("btn_pressed",2388387,1725046),this.createButtonTexture("btn_disabled",8359053,5662067),this.createPanelTexture(),this.createCardTextures(),this.createIconTextures()}createButtonTexture(o,e,t){const n=this.scene.add.graphics();n.fillStyle(0,.3),n.fillRoundedRect(4,4,200,50,10),n.fillStyle(e,1),n.fillRoundedRect(0,0,200,50,10),n.fillStyle(t,1),n.fillRoundedRect(0,50/2,200,50/2,{tl:0,tr:0,bl:10,br:10}),n.fillStyle(16777215,.2),n.fillRoundedRect(4,4,192,50/3,6),n.lineStyle(2,16777215,.3),n.strokeRoundedRect(0,0,200,50,10),n.generateTexture(o,208,58),n.destroy()}createPanelTexture(){const t=this.scene.add.graphics();t.fillStyle(0,.4),t.fillRoundedRect(6,6,300,200,15),t.fillStyle(1710638,.95),t.fillRoundedRect(0,0,300,200,15),t.lineStyle(3,3447003,.8),t.strokeRoundedRect(0,0,300,200,15),t.lineStyle(1,6139362,.3),t.strokeRoundedRect(4,4,292,192,12),t.generateTexture("panel",310,210),t.destroy()}createCardTextures(){[{key:"card_common",color:10395294},{key:"card_uncommon",color:5025616},{key:"card_rare",color:2201331},{key:"card_epic",color:10233776},{key:"card_legendary",color:16750592}].forEach(({key:e,color:t})=>{this.createCardTexture(e,t)})}createCardTexture(o,e){const i=this.scene.add.graphics();i.fillStyle(e,.3),i.fillRoundedRect(0,0,160,220,12),i.fillStyle(1973806,1),i.fillRoundedRect(4,4,152,212,10),i.fillStyle(e,1),i.fillRoundedRect(4,4,152,8,{tl:10,tr:10,bl:0,br:0}),i.lineStyle(2,e,.8),i.strokeRoundedRect(4,4,152,212,10),i.fillStyle(16777215,.05),i.fillRoundedRect(8,16,144,60,6),i.generateTexture(o,160,220),i.destroy()}createIconTextures(){const e=this.scene.add.graphics();e.fillStyle(15844367,1),e.beginPath(),e.moveTo(32/2,2),e.lineTo(28,32/3),e.lineTo(32/2,28),e.lineTo(4,32/3),e.closePath(),e.fillPath(),e.lineStyle(2,13937677,1),e.strokePath(),e.fillStyle(16777215,.4),e.fillTriangle(32/2,6,24,32/3,32/2,32/2),e.generateTexture("icon_gem",32,32),e.destroy();const t=this.scene.add.graphics();t.fillStyle(15528177,1),t.fillCircle(32/2,32/2,32/2-2),t.lineStyle(2,2899536,1),t.strokeCircle(32/2,32/2,32/2-2),t.lineStyle(2,15158332,1),t.beginPath(),t.moveTo(32/2,32/2),t.lineTo(32/2,6),t.strokePath(),t.beginPath(),t.moveTo(32/2,32/2),t.lineTo(24,32/2),t.strokePath(),t.generateTexture("icon_timer",32,32),t.destroy();const s=this.scene.add.graphics();s.fillStyle(3355443,.7),s.fillCircle(16,16,14),s.lineStyle(2,16777215,.5),s.strokeCircle(16,16,14),s.generateTexture("cooldown_bg",32,32),s.destroy()}generateParticleTextures(){const o=this.scene.add.graphics();o.fillStyle(16777215,1),o.fillCircle(8,8,6),o.generateTexture("particle_sprint",16,16),o.destroy();const e=this.scene.add.graphics();e.fillStyle(9139029,1),e.fillCircle(6,6,4),e.generateTexture("particle_dust",12,12),e.destroy(),[16739179,16697943,4774907,16752627,53971,5546239].forEach((n,a)=>{const r=this.scene.add.graphics();r.fillStyle(n,1),r.fillRect(0,0,8,4),r.generateTexture(`confetti_${a}`,8,4),r.destroy()});const s=this.scene.add.graphics();s.fillStyle(15844367,1),this.drawStar(s,10,10,5,10,4),s.generateTexture("particle_star",20,20),s.destroy();const i=this.scene.add.graphics();i.fillStyle(16777215,1),i.fillCircle(16,16,12),i.fillStyle(15844367,1),i.fillCircle(16,16,8),i.generateTexture("particle_burst",32,32),i.destroy()}drawStar(o,e,t,s,i,n){let a=Math.PI/2*3;const r=Math.PI/s;o.beginPath(),o.moveTo(e,t-i);for(let l=0;l<s;l++)o.lineTo(e+Math.cos(a)*i,t+Math.sin(a)*i),a+=r,o.lineTo(e+Math.cos(a)*n,t+Math.sin(a)*n),a+=r;o.lineTo(e,t-i),o.closePath(),o.fillPath()}generateEffectTextures(){const o=this.scene.add.graphics();o.lineStyle(4,16739179,1);for(let i=0;i<8;i++){const n=i/8*Math.PI*2,a=15,r=30;o.beginPath(),o.moveTo(32+Math.cos(n)*a,32+Math.sin(n)*a),o.lineTo(32+Math.cos(n)*r,32+Math.sin(n)*r),o.strokePath()}o.generateTexture("effect_tackle",64,64),o.destroy();const e=this.scene.add.graphics();for(let i=0;i<5;i++)e.fillStyle(4774907,.6-i*.1),e.fillEllipse(30-i*6,16,12-i*2,28-i*4);e.generateTexture("effect_dodge",40,32),e.destroy();const t=this.scene.add.graphics();t.fillStyle(15844367,.5),t.fillCircle(64,64,64),t.fillStyle(16777215,.3),t.fillCircle(64,64,40),t.generateTexture("effect_goal",128,128),t.destroy();const s=this.scene.add.graphics();s.lineStyle(4,3447003,.8),s.strokeCircle(24,24,20),s.lineStyle(2,6139362,.5),s.strokeCircle(24,24,16),s.generateTexture("effect_shield",48,48),s.destroy()}}class N extends p.Scene{constructor(){super({key:"BootScene"});c(this,"loadingBar");c(this,"loadingText");c(this,"debugState");c(this,"watchdogTimer");c(this,"hasTransitioned",!1);c(this,"errorOverlay");this.debugState={stage:"init",progress:0,lastFile:"none",errors:[],startTime:Date.now()}}init(){this.setupGlobalErrorHandlers(),this.hasTransitioned=!1,this.debugState={stage:"init",progress:0,lastFile:"none",errors:[],startTime:Date.now()},console.log("[BootScene] Initializing...")}preload(){try{this.debugState.stage="preload",console.log("[BootScene] Preload started"),this.createLoadingUI(),this.load.on("loaderror",e=>{const t=`LOAD ERROR: ${e.key} - ${e.src||"unknown source"}`;console.error("[BootScene]",t),this.debugState.errors.push(t),this.debugState.lastFile=`ERROR: ${e.key}`}),this.load.on("filecomplete",e=>{this.debugState.lastFile=e,console.log("[BootScene] Loaded:",e)}),this.load.on("progress",e=>{this.debugState.progress=e*.3,this.updateLoadingBar(e*.3)}),this.load.once("complete",()=>{console.log("[BootScene] Loader complete"),this.debugState.stage="loader-complete"}),this.startWatchdog()}catch(e){const t=`Preload error: ${e instanceof Error?e.message:String(e)}`;console.error("[BootScene]",t),this.debugState.errors.push(t),this.showErrorOverlay()}}create(){try{this.debugState.stage="create",console.log("[BootScene] Create started"),this.updateLoadingText("Generating textures..."),this.updateLoadingBar(.4),this.debugState.progress=.4,this.generateTexturesSafe(),this.updateLoadingBar(.7),this.debugState.progress=.7,this.updateLoadingText("Initializing systems..."),this.debugState.stage="systems",this.updateLoadingBar(.9),this.debugState.progress=.9,this.updateLoadingText("Ready!"),setTimeout(()=>{this.completeLoading()},400)}catch(e){const t=`Create error: ${e instanceof Error?e.message:String(e)}`;console.error("[BootScene]",t,e),this.debugState.errors.push(t),this.showErrorOverlay()}}generateTexturesSafe(){try{this.debugState.stage="textures",console.log("[BootScene] Generating textures..."),new _(this).generateAll(),console.log("[BootScene] Textures generated successfully")}catch(e){const t=`Texture generation error: ${e instanceof Error?e.message:String(e)}`;console.error("[BootScene]",t,e),this.debugState.errors.push(t),this.createFallbackTextures()}}createFallbackTextures(){console.log("[BootScene] Creating fallback textures...");try{const e=this.add.graphics();for(let s=0;s<20;s++)e.clear(),e.fillStyle(3447003,1),e.fillCircle(24,24,20),e.generateTexture(`player_${s}`,48,48);["enemy_defender","enemy_mid","enemy_forward","enemy_boss","enemy_orange"].forEach(s=>{e.clear(),e.fillStyle(15158332,1),e.fillCircle(24,24,20),e.generateTexture(s,48,48)}),e.clear(),e.fillStyle(16777215,1),e.fillCircle(10,10,8),e.generateTexture("ball",20,20),e.destroy(),console.log("[BootScene] Fallback textures created")}catch(e){console.error("[BootScene] Failed to create fallback textures:",e)}}completeLoading(){if(this.hasTransitioned){console.log("[BootScene] Already transitioned, skipping");return}this.hasTransitioned=!0,this.debugState.stage="transitioning",console.log("[BootScene] Completing loading, transitioning to MenuScene..."),this.watchdogTimer&&(this.watchdogTimer.destroy(),this.watchdogTimer=void 0);const e=document.getElementById("loading");e&&(e.style.display="none"),this.updateLoadingBar(1),this.debugState.progress=1;try{console.log("[BootScene] Starting MenuScene..."),this.scene.start("MenuScene"),console.log("[BootScene] MenuScene started successfully")}catch(t){const s=`Scene transition error: ${t instanceof Error?t.message:String(t)}`;console.error("[BootScene]",s,t),this.debugState.errors.push(s),this.showErrorOverlay()}}startWatchdog(){const t=setTimeout(()=>{this.hasTransitioned||(console.error("[BootScene] Watchdog triggered! Loading stuck."),this.debugState.errors.push("Loading stuck after 8000ms"),this.showErrorOverlay())},8e3);try{this.watchdogTimer=this.time.delayedCall(8e3,()=>{this.hasTransitioned||(console.error("[BootScene] Phaser watchdog triggered!"),this.debugState.errors.push("Phaser watchdog: Loading stuck"),this.showErrorOverlay())})}catch(s){console.warn("[BootScene] Could not create Phaser watchdog timer:",s)}this.events.once("shutdown",()=>{clearTimeout(t)}),this.events.once("destroy",()=>{clearTimeout(t)})}setupGlobalErrorHandlers(){window.addEventListener("error",e=>{const t=`Runtime error: ${e.message} at ${e.filename}:${e.lineno}`;console.error("[Global Error]",t,e.error),this.debugState.errors.push(t),this.hasTransitioned||this.showErrorOverlay()}),window.addEventListener("unhandledrejection",e=>{const t=`Unhandled Promise rejection: ${e.reason}`;console.error("[Unhandled Rejection]",t),this.debugState.errors.push(t),this.hasTransitioned||this.showErrorOverlay()})}showErrorOverlay(){if(this.errorOverlay)return;console.log("[BootScene] Showing error overlay"),this.errorOverlay=document.createElement("div"),this.errorOverlay.id="error-overlay",this.errorOverlay.style.cssText=`
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(26, 26, 46, 0.98);
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      font-family: Arial, sans-serif;
      padding: 20px;
      box-sizing: border-box;
    `;const e=((Date.now()-this.debugState.startTime)/1e3).toFixed(1);this.errorOverlay.innerHTML=`
      <h1 style="color: #e74c3c; margin-bottom: 20px; font-size: 28px;">‚ö†Ô∏è Loading Error</h1>
      
      <div style="background: #2c3e50; padding: 20px; border-radius: 10px; max-width: 600px; width: 100%; margin-bottom: 20px;">
        <h3 style="color: #f39c12; margin-top: 0;">Debug Info:</h3>
        <table style="width: 100%; color: #bdc3c7; font-size: 14px;">
          <tr><td style="padding: 5px 10px 5px 0;"><strong>Stage:</strong></td><td>${this.debugState.stage}</td></tr>
          <tr><td style="padding: 5px 10px 5px 0;"><strong>Progress:</strong></td><td>${(this.debugState.progress*100).toFixed(0)}%</td></tr>
          <tr><td style="padding: 5px 10px 5px 0;"><strong>Last file:</strong></td><td>${this.debugState.lastFile}</td></tr>
          <tr><td style="padding: 5px 10px 5px 0;"><strong>Elapsed:</strong></td><td>${e}s</td></tr>
        </table>
      </div>
      
      ${this.debugState.errors.length>0?`
        <div style="background: #3d1515; padding: 20px; border-radius: 10px; max-width: 600px; width: 100%; margin-bottom: 20px; border: 1px solid #e74c3c;">
          <h3 style="color: #e74c3c; margin-top: 0;">Errors (${this.debugState.errors.length}):</h3>
          <ul style="margin: 0; padding-left: 20px; max-height: 150px; overflow-y: auto; font-size: 12px; color: #ff9999;">
            ${this.debugState.errors.map(t=>`<li style="margin: 5px 0; word-break: break-word;">${t}</li>`).join("")}
          </ul>
        </div>
      `:""}
      
      <div style="color: #95a5a6; font-size: 14px; text-align: center; margin-bottom: 20px;">
        <p>üìã Open DevTools console (F12) for more details</p>
        <p>Try refreshing the page or clearing browser cache</p>
      </div>
      
      <div style="display: flex; gap: 15px;">
        <button onclick="location.reload()" style="
          background: #3498db;
          color: white;
          border: none;
          padding: 12px 30px;
          font-size: 16px;
          border-radius: 8px;
          cursor: pointer;
        ">üîÑ Refresh Page</button>
        
        <button onclick="document.getElementById('error-overlay').style.display='none'" style="
          background: #7f8c8d;
          color: white;
          border: none;
          padding: 12px 30px;
          font-size: 16px;
          border-radius: 8px;
          cursor: pointer;
        ">‚úï Close</button>
      </div>
    `,document.body.appendChild(this.errorOverlay)}createLoadingUI(){const e=this.cameras.main.centerX,t=this.cameras.main.centerY;this.cameras.main.setBackgroundColor(1710638),this.add.text(e,t-100,"üèë STICK & SHIFT",{fontFamily:"Arial, sans-serif",fontSize:"48px",color:"#f1c40f",fontStyle:"bold"}).setOrigin(.5),this.add.text(e,t-50,"Field Hockey Roguelike",{fontFamily:"Arial, sans-serif",fontSize:"24px",color:"#bdc3c7"}).setOrigin(.5);const n=300,a=20,r=e-n/2,l=t+50,d=this.add.graphics();d.fillStyle(2899536,1),d.fillRoundedRect(r,l,n,a,10),d.lineStyle(2,3447003,.5),d.strokeRoundedRect(r,l,n,a,10),this.loadingBar=this.add.graphics(),this.loadingText=this.add.text(e,t+90,"Loading...",{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#95a5a6"}),this.loadingText.setOrigin(.5),this.updateHtmlLoadingBar(0)}updateLoadingBar(e){if(!this.loadingBar)return;const t=this.cameras.main.centerX,s=this.cameras.main.centerY,i=300,n=20,a=t-i/2,r=s+50;this.loadingBar.clear(),this.loadingBar.fillStyle(2600544,1),this.loadingBar.fillRoundedRect(a+2,r+2,(i-4)*Math.min(e,1),n-4,8),this.updateHtmlLoadingBar(e)}updateLoadingText(e){this.loadingText&&this.loadingText.setText(e),this.debugState.stage=e}updateHtmlLoadingBar(e){const t=document.getElementById("loading-fill");t&&(t.style.width=`${Math.min(e,1)*100}%`)}}class T extends p.GameObjects.Container{constructor(e,t){super(e,t.x,t.y);c(this,"bg");c(this,"bgGlow");c(this,"label");c(this,"isDisabled",!1);c(this,"isHovered",!1);c(this,"isPressed",!1);c(this,"onClick");c(this,"originalScale",1);c(this,"colors");const s=t.width||200,i=t.height||50;this.onClick=t.onClick,this.isDisabled=t.disabled||!1;const n={primary:{normal:3447003,hover:6139362,pressed:2388387,disabled:8359053},secondary:{normal:9807270,hover:12436423,pressed:8359053,disabled:5662067},danger:{normal:15158332,hover:15495267,pressed:12597547,disabled:8359053},success:{normal:2600544,hover:3066993,pressed:1999945,disabled:8359053}};this.colors=n[t.style||"primary"],this.bgGlow=e.add.rectangle(0,3,s+4,i+4,0,.3),this.bgGlow.setOrigin(.5),this.add(this.bgGlow),this.bg=e.add.rectangle(0,0,s,i,this.isDisabled?this.colors.disabled:this.colors.normal),this.bg.setOrigin(.5),this.bg.setStrokeStyle(2,16777215,.3),this.add(this.bg);const a=e.add.rectangle(0,-i/4,s-10,i/3,16777215,.15);a.setOrigin(.5),this.add(a),this.label=e.add.text(0,0,t.text,{fontFamily:"Arial, sans-serif",fontSize:`${t.fontSize||18}px`,color:"#ffffff",fontStyle:"bold"}),this.label.setOrigin(.5),this.add(this.label),this.setSize(s,i),this.setInteractive({useHandCursor:!this.isDisabled}),this.on("pointerover",this.onPointerOver,this),this.on("pointerout",this.onPointerOut,this),this.on("pointerdown",this.onPointerDown,this),this.on("pointerup",this.onPointerUp,this),e.add.existing(this)}onPointerOver(){this.isDisabled||(this.isHovered=!0,this.bg.setFillStyle(this.colors.hover),this.scene.tweens.add({targets:this,scaleX:1.05,scaleY:1.05,duration:100,ease:"Power2"}))}onPointerOut(){this.isDisabled||(this.isHovered=!1,this.isPressed=!1,this.bg.setFillStyle(this.colors.normal),this.scene.tweens.add({targets:this,scaleX:this.originalScale,scaleY:this.originalScale,duration:100,ease:"Power2"}))}onPointerDown(){this.isDisabled||(this.isPressed=!0,this.bg.setFillStyle(this.colors.pressed),this.scene.tweens.add({targets:this,scaleX:.95,scaleY:.95,duration:50,ease:"Power2"}),this.scene.audioSystem&&this.scene.audioSystem.playClick())}onPointerUp(){this.isDisabled||!this.isPressed||(this.isPressed=!1,this.bg.setFillStyle(this.isHovered?this.colors.hover:this.colors.normal),this.scene.tweens.add({targets:this,scaleX:this.isHovered?1.05:this.originalScale,scaleY:this.isHovered?1.05:this.originalScale,duration:100,ease:"Back.easeOut"}),this.onClick&&this.onClick())}setDisabled(e){return this.isDisabled=e,this.bg.setFillStyle(e?this.colors.disabled:this.colors.normal),this.setInteractive({useHandCursor:!e}),this.label.setAlpha(e?.5:1),this}setText(e){return this.label.setText(e),this}setCallback(e){return this.onClick=e,this}pulse(){this.scene.tweens.add({targets:this,scaleX:1.1,scaleY:1.1,duration:200,yoyo:!0,repeat:2,ease:"Sine.easeInOut"})}shake(){const e=this.x;this.scene.tweens.add({targets:this,x:e+5,duration:50,yoyo:!0,repeat:3,ease:"Sine.easeInOut",onComplete:()=>{this.x=e}})}}class Re extends p.GameObjects.Container{constructor(e,t,s,i,n,a=40){super(e,t,s);c(this,"bg");c(this,"icon");c(this,"onClick");c(this,"isDisabled",!1);this.onClick=n,this.bg=e.add.circle(0,0,a/2,3447003),this.bg.setStrokeStyle(2,16777215,.3),this.add(this.bg),this.icon=e.add.text(0,0,i,{fontFamily:"Arial, sans-serif",fontSize:`${a*.5}px`}),this.icon.setOrigin(.5),this.add(this.icon),this.setSize(a,a),this.setInteractive({useHandCursor:!0}),this.on("pointerover",()=>{this.isDisabled||(this.bg.setFillStyle(6139362),e.tweens.add({targets:this,scaleX:1.1,scaleY:1.1,duration:100}))}),this.on("pointerout",()=>{this.isDisabled||(this.bg.setFillStyle(3447003),e.tweens.add({targets:this,scaleX:1,scaleY:1,duration:100}))}),this.on("pointerdown",()=>{!this.isDisabled&&this.onClick&&(e.tweens.add({targets:this,scaleX:.9,scaleY:.9,duration:50,yoyo:!0}),this.onClick())}),e.add.existing(this)}setDisabled(e){return this.isDisabled=e,this.bg.setFillStyle(e?8359053:3447003),this.icon.setAlpha(e?.5:1),this}}const z="stick_and_shift_save",D=1,B={version:D,gems:0,unlockedCharacters:["alex","maya"],completedChallenges:[],metaUpgradeLevels:{},stats:{totalRuns:0,totalMomentsWon:0,totalMomentsLost:0,totalGoals:0,totalReboundGoals:0,totalTackles:0,totalSteals:0,totalPasses:0,totalAssists:0,totalDodges:0,totalBossWins:0,totalGemsEarned:0,cleanSheets:0,perfectMoments:0,hasSeenTutorial:0,aimAssistStrength:50,uniqueCharactersPlayed:[],uniqueBossesDefeated:[]},settings:{musicVolume:.5,sfxVolume:.7,screenShake:!0,showDamageNumbers:!0}},M=class M{constructor(){c(this,"data");this.data=this.load()}static getInstance(){return M.instance||(M.instance=new M),M.instance}load(){try{const o=localStorage.getItem(z);if(o){const e=JSON.parse(o);return e.version<D?this.migrate(e):this.mergeWithDefaults(e)}}catch(o){console.warn("Failed to load save data, using defaults:",o)}return{...B}}migrate(o){return console.log(`Migrating save from version ${o.version} to ${D}`),this.mergeWithDefaults({...o,version:D})}mergeWithDefaults(o){return{...B,...o,stats:{...B.stats,...o.stats||{}},settings:{...B.settings,...o.settings||{}}}}save(){try{localStorage.setItem(z,JSON.stringify(this.data))}catch(o){console.error("Failed to save data:",o)}}getGems(){return this.data.gems}addGems(o){this.data.gems+=o,this.data.stats.totalGemsEarned+=o,this.save()}spendGems(o){return this.data.gems>=o?(this.data.gems-=o,this.save(),!0):!1}getUnlockedCharacters(){return[...this.data.unlockedCharacters]}isCharacterUnlocked(o){return this.data.unlockedCharacters.includes(o)}unlockCharacter(o){this.data.unlockedCharacters.includes(o)||(this.data.unlockedCharacters.push(o),this.save())}getCompletedChallenges(){return[...this.data.completedChallenges]}isChallengeCompleted(o){return this.data.completedChallenges.includes(o)}completeChallenge(o){this.data.completedChallenges.includes(o)||(this.data.completedChallenges.push(o),this.save())}getMetaUpgradeLevel(o){return this.data.metaUpgradeLevels[o]||0}setMetaUpgradeLevel(o,e){this.data.metaUpgradeLevels[o]=e,this.save()}getStats(){return{...this.data.stats}}getStat(o){return this.data.stats[o]}setStat(o,e){typeof this.data.stats[o]=="number"&&(this.data.stats[o]=e,this.save())}incrementStat(o,e=1){typeof this.data.stats[o]=="number"&&(this.data.stats[o]+=e,this.save())}addUniqueToStat(o,e){this.data.stats[o].includes(e)||(this.data.stats[o].push(e),this.save())}getSettings(){return{...this.data.settings}}updateSettings(o){this.data.settings={...this.data.settings,...o},this.save()}getLastPlayedCharacter(){return this.data.lastPlayedCharacter}setLastPlayedCharacter(o){this.data.lastPlayedCharacter=o,this.save()}reset(){this.data={...B},this.save()}exportSave(){return JSON.stringify(this.data)}importSave(o){try{const e=JSON.parse(o);return this.data=this.mergeWithDefaults(e),this.save(),!0}catch{return!1}}};c(M,"instance");let b=M;class R{constructor(o){c(this,"scene");c(this,"musicVolume",.5);c(this,"sfxVolume",.7);c(this,"audioContext");this.scene=o;const e=b.getInstance().getSettings();this.musicVolume=e.musicVolume,this.sfxVolume=e.sfxVolume;try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)}catch{console.warn("Web Audio API not supported")}}playTone(o,e,t="sine",s=1){if(!(!this.audioContext||this.sfxVolume===0))try{const i=this.audioContext.createOscillator(),n=this.audioContext.createGain();i.type=t,i.frequency.setValueAtTime(o,this.audioContext.currentTime),n.gain.setValueAtTime(s*this.sfxVolume*.3,this.audioContext.currentTime),n.gain.exponentialRampToValueAtTime(.001,this.audioContext.currentTime+e),i.connect(n),n.connect(this.audioContext.destination),i.start(),i.stop(this.audioContext.currentTime+e)}catch{}}playChord(o,e,t="sine"){o.forEach(s=>this.playTone(s,e,t,.5))}playNoise(o,e=.5){if(!(!this.audioContext||this.sfxVolume===0))try{const t=this.audioContext.sampleRate*o,s=this.audioContext.createBuffer(1,t,this.audioContext.sampleRate),i=s.getChannelData(0);for(let r=0;r<t;r++)i[r]=(Math.random()*2-1)*Math.exp(-r/(t*.3));const n=this.audioContext.createBufferSource(),a=this.audioContext.createGain();n.buffer=s,a.gain.setValueAtTime(e*this.sfxVolume*.3,this.audioContext.currentTime),n.connect(a),a.connect(this.audioContext.destination),n.start()}catch{}}playClick(){this.playTone(800,.05,"square")}playHover(){this.playTone(600,.03,"sine",.3)}playShoot(){this.playTone(200,.15,"sawtooth"),this.playNoise(.1,.4)}playPass(){this.playTone(400,.1,"triangle")}playTackle(){this.playNoise(.15,.6),this.playTone(150,.1,"square")}playSteal(){this.playTone(500,.08,"square"),this.playTone(700,.08,"square")}playDodge(){this.playTone(600,.1,"sine"),this.playTone(800,.08,"sine")}playGoal(){this.playChord([523.25,659.25,783.99],.3),setTimeout(()=>this.playChord([587.33,739.99,880],.3),200),setTimeout(()=>this.playChord([659.25,830.61,987.77],.5),400)}playConcede(){this.playChord([220,261.63,311.13],.5)}playUpgrade(){this.playTone(440,.1,"sine"),setTimeout(()=>this.playTone(554.37,.1,"sine"),100),setTimeout(()=>this.playTone(659.25,.15,"sine"),200)}playPowerUp(){for(let o=0;o<5;o++)setTimeout(()=>this.playTone(400+o*100,.08,"sine"),o*50)}playError(){this.playTone(200,.1,"square"),setTimeout(()=>this.playTone(150,.15,"square"),100)}playSuccess(){this.playTone(523.25,.1,"sine"),setTimeout(()=>this.playTone(659.25,.15,"sine"),100)}playTimer(){this.playTone(880,.05,"sine")}playBossAppear(){this.playTone(100,.3,"sawtooth"),this.playNoise(.2,.5)}playMomentStart(){this.playTone(440,.1,"sine"),setTimeout(()=>this.playTone(440,.1,"sine"),150),setTimeout(()=>this.playTone(660,.2,"sine"),300)}playMomentEnd(){this.playChord([392,493.88,587.33],.4)}playWhistle(){this.playTone(1e3,.2,"sine"),setTimeout(()=>this.playTone(800,.3,"sine"),200)}setMusicVolume(o){this.musicVolume=p.Math.Clamp(o,0,1),b.getInstance().updateSettings({musicVolume:this.musicVolume})}setSfxVolume(o){this.sfxVolume=p.Math.Clamp(o,0,1),b.getInstance().updateSettings({sfxVolume:this.sfxVolume})}getMusicVolume(){return this.musicVolume}getSfxVolume(){return this.sfxVolume}resume(){this.audioContext&&this.audioContext.state==="suspended"&&this.audioContext.resume()}}const G=[{id:"firstWin",name:"First Blood",description:"Win your first moment",requirement:{type:"momentWins",count:1},reward:{gems:25},tier:1,icon:"üéØ"},{id:"scorer",name:"Goal Getter",description:"Score 10 total goals",requirement:{type:"goals",count:10},reward:{gems:50},tier:1,icon:"‚öΩ"},{id:"tackler",name:"Ball Winner",description:"Make 20 successful tackles",requirement:{type:"tackles",count:20},reward:{gems:50},tier:1,icon:"‚öîÔ∏è"},{id:"passer",name:"Playmaker",description:"Complete 50 passes",requirement:{type:"passes",count:50},reward:{gems:50},tier:1,icon:"üìê"},{id:"runner",name:"Marathon Runner",description:"Complete 5 runs",requirement:{type:"totalRuns",count:5},reward:{gems:75},tier:1,icon:"üèÉ"},{id:"firstBoss",name:"Boss Slayer",description:"Win your first boss moment",requirement:{type:"bossWins",count:1},reward:{gems:100},tier:1,icon:"üëπ"},{id:"dodger",name:"Untouchable",description:"Perform 30 dodges",requirement:{type:"dodges",count:30},reward:{gems:50},tier:1,icon:"üí®"},{id:"helper",name:"Team Player",description:"Get 10 assists",requirement:{type:"assists",count:10},reward:{gems:50},tier:1,icon:"ü§ù"},{id:"momentStreak",name:"Hot Streak",description:"Win 3 moments without conceding",requirement:{type:"cleanSheets",count:3},reward:{gems:150,unlockCharacter:"bruno"},tier:2,icon:"üî•"},{id:"reboundKing",name:"Rebound King",description:"Score 5 rebound goals",requirement:{type:"reboundGoals",count:5},reward:{gems:150},tier:2,icon:"üîÑ"},{id:"perfectMoment",name:"Perfect Moment",description:"Win a moment with 3+ goal difference",requirement:{type:"perfectMoments",count:1},reward:{gems:100},tier:2,icon:"‚ú®"},{id:"bossMaster",name:"Boss Master",description:"Win 5 boss moments",requirement:{type:"bossWins",count:5},reward:{gems:200,unlockCharacter:"kofi"},tier:2,icon:"üëë"},{id:"pressBuild",name:"Press Gang",description:"Win a Boss Moment with 3+ Press upgrades",requirement:{type:"synergyBuild",count:1,condition:"press"},reward:{gems:200,unlockCharacter:"sarah"},tier:2,icon:"üèÉ"},{id:"dragFlickBuild",name:"Flick Master",description:"Win a Boss Moment with 3+ Drag Flick upgrades",requirement:{type:"synergyBuild",count:1,condition:"dragFlick"},reward:{gems:200,unlockCharacter:"priya"},tier:2,icon:"üèë"},{id:"stealMaster",name:"Steal Master",description:"Get 50 steals",requirement:{type:"steals",count:50},reward:{gems:150},tier:2,icon:"ü•∑"},{id:"hundredGoals",name:"Century",description:"Score 100 total goals",requirement:{type:"goals",count:100},reward:{gems:250,unlockCharacter:"olivia"},tier:2,icon:"üíØ"},{id:"triangleBuild",name:"Triangle Master",description:"Win a run with 5+ Triangle Passing upgrades",requirement:{type:"synergyBuild",count:1,condition:"trianglePassing"},reward:{gems:300,unlockCharacter:"lin"},tier:3,icon:"üî∫"},{id:"speedsterBuild",name:"Speed Demon",description:"Win a run with 5+ Speedster upgrades",requirement:{type:"synergyBuild",count:1,condition:"speedster"},reward:{gems:300,unlockCharacter:"raj"},tier:3,icon:"‚ö°"},{id:"vampireBuild",name:"Bloodthirst",description:"Win a run with 4+ Vampire upgrades",requirement:{type:"synergyBuild",count:1,condition:"vampire"},reward:{gems:350,unlockCharacter:"zara"},tier:3,icon:"üßõ"},{id:"chaosBuild",name:"Chaos Lord",description:"Win a run with 4+ Chaos upgrades",requirement:{type:"synergyBuild",count:1,condition:"chaos"},reward:{gems:350,unlockCharacter:"yuki"},tier:3,icon:"üé∞"},{id:"allBosses",name:"Boss Collector",description:"Beat all 4 boss types at least once",requirement:{type:"bossWins",count:4,condition:"unique"},reward:{gems:400,unlockCharacter:"emma"},tier:3,icon:"üèÜ"},{id:"perfectRun",name:"Perfect Run",description:"Complete a run without losing any moment",requirement:{type:"momentWins",count:12,condition:"noloss"},reward:{gems:500,unlockCharacter:"ben"},tier:3,icon:"‚≠ê"},{id:"allCharacters",name:"Full Roster",description:"Play a run with 10 different characters",requirement:{type:"characterRuns",count:10},reward:{gems:300},tier:3,icon:"üë•"},{id:"gemHoarder",name:"Gem Hoarder",description:"Accumulate 5000 total gems earned",requirement:{type:"gemTotal",count:5e3},reward:{gems:500,unlockCharacter:"marcus"},tier:3,icon:"üíé"},{id:"guardianBuild",name:"Fortress",description:"Win a run with 4+ Guardian upgrades",requirement:{type:"synergyBuild",count:1,condition:"guardian"},reward:{gems:350,unlockCharacter:"hans"},tier:3,icon:"üè∞"},{id:"berserkerBuild",name:"Berserker",description:"Win a run with 4+ Berserker upgrades",requirement:{type:"synergyBuild",count:1,condition:"berserker"},reward:{gems:350,unlockCharacter:"diego"},tier:3,icon:"üò§"},{id:"reboundBuild",name:"Rebound Specialist",description:"Win a run with 4+ Rebound upgrades and 10+ rebound goals",requirement:{type:"synergyBuild",count:1,condition:"rebound"},reward:{gems:400,unlockCharacter:"anja"},tier:3,icon:"üîÑ"},{id:"tankBuild",name:"Immovable Object",description:"Win a run with 4+ Tank upgrades",requirement:{type:"synergyBuild",count:1,condition:"tank"},reward:{gems:350},tier:3,icon:"üõ°Ô∏è"},{id:"tricksterBuild",name:"Master Trickster",description:"Win a run with 5+ Trickster upgrades",requirement:{type:"synergyBuild",count:1,condition:"trickster"},reward:{gems:350,unlockCharacter:"james"},tier:3,icon:"üé≠"},{id:"precisionBuild",name:"Surgeon",description:"Win a run with 4+ Precision upgrades",requirement:{type:"synergyBuild",count:1,condition:"precision"},reward:{gems:350,unlockCharacter:"nina"},tier:3,icon:"üéØ"},{id:"pcSpecialist",name:"PC Specialist",description:"Score 20 goals from penalty corners",requirement:{type:"goals",count:20,condition:"pc"},reward:{gems:400,unlockCharacter:"tom"},tier:3,icon:"üèë"}];class K extends p.Scene{constructor(){super({key:"MenuScene"});c(this,"audioSystem");c(this,"gemDisplay")}create(){this.audioSystem=new R(this),this.input.once("pointerdown",()=>{this.audioSystem.resume()}),this.cameras.main.setBackgroundColor(1710638),this.createBackground(),this.createTitle(),this.createMenuButtons(),this.createGemDisplay(),this.cameras.main.fadeIn(300),this.add.text(10,this.cameras.main.height-20,"v1.0.0",{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#7f8c8d"})}createBackground(){const e=this.add.graphics();for(let t=0;t<this.cameras.main.height;t+=40){const s=t%80===0?1976862:1713690;e.fillStyle(s,.3),e.fillRect(0,t,this.cameras.main.width,40)}this.createFloatingElements()}createFloatingElements(){const e=["üèë","‚öΩ","ü•Ö","üèÜ"];for(let t=0;t<8;t++){const s=Math.random()*this.cameras.main.width,i=Math.random()*this.cameras.main.height,n=e[Math.floor(Math.random()*e.length)],a=this.add.text(s,i,n,{fontSize:"32px"});a.setAlpha(.1),this.tweens.add({targets:a,y:i+30,duration:2e3+Math.random()*2e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.tweens.add({targets:a,x:s+(Math.random()-.5)*50,duration:3e3+Math.random()*2e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}}createTitle(){const e=this.cameras.main.centerX,t=this.add.text(e,100,"üèë STICK & SHIFT",{fontFamily:"Arial, sans-serif",fontSize:"56px",color:"#f1c40f",fontStyle:"bold",stroke:"#000000",strokeThickness:4});t.setOrigin(.5),this.tweens.add({targets:t,scaleX:1.02,scaleY:1.02,duration:2e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.add.text(e,160,"Field Hockey Roguelike",{fontFamily:"Arial, sans-serif",fontSize:"24px",color:"#bdc3c7"}).setOrigin(.5)}createMenuButtons(){const e=this.cameras.main.centerX,t=240,s=60;new T(this,{x:e,y:t,width:250,height:55,text:"‚ñ∂ PLAY",fontSize:24,style:"success",onClick:()=>{this.audioSystem.playClick(),this.cameras.main.fadeOut(300),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("CharacterSelectScene")})}}),new T(this,{x:e,y:t+s,width:250,height:50,text:"üõí STORE",fontSize:22,onClick:()=>{this.audioSystem.playClick(),this.cameras.main.fadeOut(300),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("StoreScene")})}});const i=b.getInstance().getCompletedChallenges().length,n=G.length;new T(this,{x:e,y:t+s*2,width:250,height:50,text:`üéØ CHALLENGES (${i}/${n})`,fontSize:18,onClick:()=>{this.audioSystem.playClick(),this.showChallenges()}}),new T(this,{x:e,y:t+s*3,width:250,height:50,text:"üéÆ CONTROLS",fontSize:22,onClick:()=>{this.audioSystem.playClick(),this.showControls()}}),new T(this,{x:e,y:t+s*4,width:250,height:50,text:"‚öôÔ∏è SETTINGS",fontSize:22,style:"secondary",onClick:()=>{this.audioSystem.playClick(),this.showSettings()}})}createGemDisplay(){const e=b.getInstance().getGems();this.gemDisplay=this.add.container(this.cameras.main.width-120,30);const t=this.add.graphics();t.fillStyle(1710638,.9),t.fillRoundedRect(-60,-20,120,40,10),t.lineStyle(2,15844367,.5),t.strokeRoundedRect(-60,-20,120,40,10),this.gemDisplay.add(t);const s=this.add.text(-40,0,"üíé",{fontSize:"20px"});s.setOrigin(.5),this.gemDisplay.add(s);const i=this.add.text(10,0,e.toString(),{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#f1c40f",fontStyle:"bold"});i.setOrigin(.5),this.gemDisplay.add(i)}showChallenges(){const e=this.add.rectangle(this.cameras.main.centerX,this.cameras.main.centerY,this.cameras.main.width,this.cameras.main.height,0,.8);e.setInteractive();const t=this.add.container(this.cameras.main.centerX,this.cameras.main.centerY),s=this.add.graphics();s.fillStyle(1710638,1),s.fillRoundedRect(-300,-250,600,500,20),s.lineStyle(3,15965202,.8),s.strokeRoundedRect(-300,-250,600,500,20),t.add(s);const i=this.add.text(0,-220,"üéØ CHALLENGES",{fontFamily:"Arial, sans-serif",fontSize:"28px",color:"#f39c12",fontStyle:"bold"});i.setOrigin(.5),t.add(i);const n=b.getInstance().getCompletedChallenges();G.slice(0,8).forEach((l,d)=>{const h=n.includes(l.id),f=-150+d*50,m=this.add.text(-270,f,h?"‚úÖ":l.icon,{fontSize:"24px"});t.add(m);const u=this.add.text(-230,f,l.name,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:h?"#27ae60":"#ffffff",fontStyle:h?"normal":"bold"});u.setOrigin(0,.5),t.add(u);const y=this.add.text(-230,f+18,l.description,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#7f8c8d"});y.setOrigin(0,.5),t.add(y);const k=this.add.text(250,f,`üíé ${l.reward.gems}`,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#f1c40f"});k.setOrigin(1,.5),t.add(k)});const r=new T(this,{x:this.cameras.main.centerX,y:this.cameras.main.centerY+220,width:150,height:45,text:"Close",style:"secondary",onClick:()=>{e.destroy(),t.destroy(),r.destroy()}})}showControls(){const e=this.cameras.main.width,t=this.cameras.main.height,s=this.add.rectangle(this.cameras.main.centerX,this.cameras.main.centerY,e,t,0,.8);s.setInteractive();const i=this.add.container(this.cameras.main.centerX,this.cameras.main.centerY),n=this.add.graphics();n.fillStyle(1710638,1),n.fillRoundedRect(-250,-220,500,440,20),n.lineStyle(3,3447003,.8),n.strokeRoundedRect(-250,-220,500,440,20),i.add(n);const a=this.add.text(0,-190,"üéÆ CONTROLS",{fontFamily:"Arial, sans-serif",fontSize:"28px",color:"#3498db",fontStyle:"bold"});a.setOrigin(.5),i.add(a);const r=[{key:"WASD / Arrow Keys",action:"Move your player"},{key:"SPACE / Left Click",action:"Shoot the ball (with possession)"},{key:"E",action:"Pass to nearest teammate"},{key:"Q",action:"Tackle (lunge to steal ball)"},{key:"SHIFT",action:"Dodge / Sidestep with i-frames"},{key:"Mouse",action:"Aim direction"},{key:"ESC / P",action:"Pause the game"},{key:"H",action:"Toggle controls help (in-game)"}],l=-130;r.forEach((f,m)=>{const u=l+m*40,y=this.add.graphics();y.fillStyle(2899536,1),y.fillRoundedRect(-220,u-14,160,28,6),i.add(y);const k=this.add.text(-140,u,f.key,{fontFamily:"monospace",fontSize:"12px",color:"#3498db",fontStyle:"bold"});k.setOrigin(.5),i.add(k);const w=this.add.text(-40,u,f.action,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#ecf0f1"});w.setOrigin(0,.5),i.add(w)});const d=this.add.text(0,160,"üí° TIP: When using keyboard only, shots auto-aim toward the goal!",{fontFamily:"Arial, sans-serif",fontSize:"13px",color:"#f39c12",wordWrap:{width:420},align:"center"});d.setOrigin(.5),i.add(d);const h=new T(this,{x:this.cameras.main.centerX,y:this.cameras.main.centerY+195,width:150,height:45,text:"Got It!",style:"success",onClick:()=>{this.audioSystem.playClick(),s.destroy(),i.destroy(),h.destroy()}})}showSettings(){const e=b.getInstance().getSettings(),t=this.add.rectangle(this.cameras.main.centerX,this.cameras.main.centerY,this.cameras.main.width,this.cameras.main.height,0,.8);t.setInteractive();const s=this.add.container(this.cameras.main.centerX,this.cameras.main.centerY),i=this.add.graphics();i.fillStyle(1710638,1),i.fillRoundedRect(-200,-180,400,360,20),i.lineStyle(3,3447003,.8),i.strokeRoundedRect(-200,-180,400,360,20),s.add(i);const n=this.add.text(0,-150,"‚öôÔ∏è SETTINGS",{fontFamily:"Arial, sans-serif",fontSize:"28px",color:"#3498db",fontStyle:"bold"});n.setOrigin(.5),s.add(n);const a=this.add.text(-150,-80,"Music Volume:",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#ffffff"});s.add(a);const r=this.add.text(120,-80,`${Math.round(e.musicVolume*100)}%`,{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#f1c40f"});s.add(r);const l=this.add.text(-150,-30,"SFX Volume:",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#ffffff"});s.add(l);const d=this.add.text(120,-30,`${Math.round(e.sfxVolume*100)}%`,{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#f1c40f"});s.add(d);const h=this.add.text(-150,20,"Screen Shake:",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#ffffff"});s.add(h);const f=this.add.text(120,20,e.screenShake?"ON":"OFF",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:e.screenShake?"#27ae60":"#e74c3c"});f.setInteractive({useHandCursor:!0}),f.on("pointerdown",()=>{const k=!b.getInstance().getSettings().screenShake;b.getInstance().updateSettings({screenShake:k}),f.setText(k?"ON":"OFF"),f.setColor(k?"#27ae60":"#e74c3c")}),s.add(f);const m=this.add.text(0,80,"CONTROLS",{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#bdc3c7",fontStyle:"bold"});m.setOrigin(.5),s.add(m);const u=this.add.text(0,120,`WASD/Arrows - Move
SPACE - Shoot
E - Pass
Q - Tackle
SHIFT - Dodge`,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#7f8c8d",align:"center"});u.setOrigin(.5),s.add(u);const y=new T(this,{x:this.cameras.main.centerX,y:this.cameras.main.centerY+155,width:150,height:45,text:"Close",style:"secondary",onClick:()=>{t.destroy(),s.destroy(),y.destroy()}})}}const I=[{id:"alex",name:"Alex Chen",role:"midfielder",description:"A balanced all-rounder with no major weaknesses.",stats:{speed:6,stamina:6,control:6,shotPower:6,passPower:6,tackle:6,dodge:5},trait:{name:"Versatile",description:"+5% to all stats",effect:"versatile"},downside:{name:"Jack of All",description:"No stat can exceed 8",effect:"statCap8"},unlockCost:0,color:3447003},{id:"maya",name:"Maya Santos",role:"forward",description:"Lightning fast striker with a killer instinct.",stats:{speed:9,stamina:5,control:5,shotPower:7,passPower:4,tackle:3,dodge:7},trait:{name:"Speed Demon",description:"Sprint costs no stamina",effect:"freeSprintStamina"},downside:{name:"Glass Cannon",description:"Takes 50% longer to recover from tackles",effect:"slowTackleRecovery"},unlockCost:0,color:15158332},{id:"bruno",name:"Bruno Weber",role:"defender",description:"Rock-solid defender who never gives up.",stats:{speed:4,stamina:8,control:5,shotPower:5,passPower:6,tackle:9,dodge:3},trait:{name:"Iron Wall",description:"+30% tackle range",effect:"extendedTackle"},downside:{name:"Heavy Feet",description:"-20% dodge distance",effect:"shortDodge"},unlockCost:100,color:3066993},{id:"priya",name:"Priya Sharma",role:"midfielder",description:"Master of the drag flick and aerial play.",stats:{speed:5,stamina:6,control:8,shotPower:8,passPower:7,tackle:4,dodge:5},trait:{name:"Drag Flick Master",description:"Shots from circles have +40% power",effect:"circleShot"},downside:{name:"Set Piece Only",description:"-15% shot power outside circles",effect:"weakOpenShot"},unlockCost:150,color:10181046},{id:"james",name:"James O'Brien",role:"forward",description:"Tricky winger who loves to dribble.",stats:{speed:7,stamina:5,control:9,shotPower:5,passPower:5,tackle:4,dodge:8},trait:{name:"Silky Skills",description:"Double dodge i-frames",effect:"extendedIframes"},downside:{name:"Show-off",description:"Passes have 10% chance to bobble",effect:"passError"},unlockCost:200,color:15965202},{id:"lin",name:"Lin Xiaoming",role:"midfielder",description:"Vision and passing genius.",stats:{speed:5,stamina:6,control:7,shotPower:4,passPower:10,tackle:5,dodge:5},trait:{name:"Quarterback",description:"Passes auto-target teammates",effect:"autoTargetPass"},downside:{name:"Weak Shot",description:"-25% shot power",effect:"weakShot"},unlockCost:250,color:1752220},{id:"sarah",name:"Sarah Mitchell",role:"defender",description:"Aggressive defender with great interceptions.",stats:{speed:6,stamina:7,control:5,shotPower:5,passPower:5,tackle:8,dodge:4},trait:{name:"Interceptor",description:"+50% steal radius when ball is loose",effect:"magnetSteal"},downside:{name:"Reckless",description:"Missed tackles have longer cooldown",effect:"longTackleCd"},unlockCost:175,color:15105570},{id:"kofi",name:"Kofi Asante",role:"forward",description:"Powerful striker with thunderous shots.",stats:{speed:5,stamina:6,control:5,shotPower:10,passPower:5,tackle:4,dodge:4},trait:{name:"Cannon Foot",description:"Shots can knock back goalies",effect:"knockbackShot"},downside:{name:"Slow Windup",description:"Shots take 20% longer to charge",effect:"slowShot"},unlockCost:300,color:9323693},{id:"emma",name:"Emma de Vries",role:"goalkeeper",description:"Exceptional goalkeeper with quick reflexes.",stats:{speed:4,stamina:7,control:6,shotPower:6,passPower:7,tackle:6,dodge:6},trait:{name:"Cat Reflexes",description:"+40% save radius when in goal",effect:"expandedGoal"},downside:{name:"Stay Home",description:"-30% speed outside D",effect:"slowOutsideD"},unlockCost:350,color:15844367},{id:"raj",name:"Raj Patel",role:"midfielder",description:"Tireless runner who never stops pressing.",stats:{speed:7,stamina:10,control:5,shotPower:5,passPower:6,tackle:6,dodge:5},trait:{name:"Engine",description:"Stamina regens 2x faster",effect:"fastStamina"},downside:{name:"Tunnel Vision",description:"-15% tackle success from behind",effect:"weakBackTackle"},unlockCost:200,color:1482885},{id:"olivia",name:"Olivia Hart",role:"forward",description:"Lucky striker who finds the net somehow.",stats:{speed:6,stamina:5,control:5,shotPower:6,passPower:5,tackle:4,dodge:6},trait:{name:"Lucky Star",description:"15% chance for deflected shots to score",effect:"luckyDeflect"},downside:{name:"Inconsistent",description:"Stats vary ¬±15% each moment",effect:"statVariance"},unlockCost:400,color:12597547},{id:"diego",name:"Diego Fernandez",role:"midfielder",description:"Aggressive tackler who wins the ball.",stats:{speed:6,stamina:6,control:4,shotPower:5,passPower:5,tackle:9,dodge:5},trait:{name:"Ball Hunter",description:"Successful tackles give brief speed boost",effect:"tackleSpeed"},downside:{name:"Foul Prone",description:"10% chance tackles give opponent free hit",effect:"foulRisk"},unlockCost:225,color:2600544},{id:"yuki",name:"Yuki Tanaka",role:"forward",description:"Quick thinker with exceptional awareness.",stats:{speed:7,stamina:5,control:7,shotPower:6,passPower:7,tackle:4,dodge:7},trait:{name:"Sixth Sense",description:"See enemy positions on minimap",effect:"minimap"},downside:{name:"Fragile",description:"Stunned 25% longer from tackles",effect:"longStun"},unlockCost:275,color:13849600},{id:"hans",name:"Hans Mueller",role:"defender",description:"Tactical genius who reads the game.",stats:{speed:5,stamina:7,control:6,shotPower:5,passPower:8,tackle:7,dodge:4},trait:{name:"Playmaker",description:"Passes to forwards give them brief buff",effect:"passBuff"},downside:{name:"Slow Turner",description:"-20% rotation speed",effect:"slowTurn"},unlockCost:325,color:2719929},{id:"zara",name:"Zara Mohammed",role:"midfielder",description:"Acrobatic midfielder with flashy moves.",stats:{speed:7,stamina:5,control:6,shotPower:6,passPower:5,tackle:5,dodge:9},trait:{name:"Acrobat",description:"Dodge can be chained twice",effect:"doubleDodge"},downside:{name:"Showboat",description:"Stamina drains faster",effect:"fastStaminaDrain"},unlockCost:450,color:10181046},{id:"marcus",name:"Marcus Johnson",role:"forward",description:"Physical presence in the circle.",stats:{speed:4,stamina:8,control:5,shotPower:8,passPower:4,tackle:7,dodge:3},trait:{name:"Tank",description:"Cannot be knocked back while shooting",effect:"stableShot"},downside:{name:"Sluggish",description:"-25% acceleration",effect:"slowAccel"},unlockCost:350,color:3426654},{id:"anja",name:"Anja Petrov",role:"defender",description:"Long-range specialist from the back.",stats:{speed:5,stamina:6,control:5,shotPower:7,passPower:9,tackle:6,dodge:4},trait:{name:"Long Ball",description:"+50% pass range",effect:"longPass"},downside:{name:"Short Stick",description:"-20% tackle range",effect:"shortTackle"},unlockCost:280,color:15277667},{id:"tom",name:"Tom Williams",role:"midfielder",description:"Penalty corner expert.",stats:{speed:5,stamina:6,control:7,shotPower:8,passPower:7,tackle:5,dodge:5},trait:{name:"PC Specialist",description:"+50% power on penalty corners",effect:"pcPower"},downside:{name:"Set Piece Only",description:"-10% stats in open play",effect:"weakOpenPlay"},unlockCost:375,color:48340},{id:"nina",name:"Nina Johansson",role:"forward",description:"Ice cold finisher under pressure.",stats:{speed:6,stamina:5,control:7,shotPower:7,passPower:5,tackle:4,dodge:6},trait:{name:"Clutch",description:"+30% shot power when behind",effect:"clutchShot"},downside:{name:"Complacent",description:"-15% all stats when leading",effect:"leadDebuff"},unlockCost:425,color:6765239},{id:"ben",name:"Ben O'Connor",role:"goalkeeper",description:"Sweeper keeper who loves to roam.",stats:{speed:7,stamina:6,control:6,shotPower:5,passPower:7,tackle:7,dodge:5},trait:{name:"Sweeper",description:"Full speed anywhere on field",effect:"fullSpeed"},downside:{name:"Wanderer",description:"-25% save rate in goal",effect:"weakInGoal"},unlockCost:500,color:16733986}];function L(g){return I.find(o=>o.id===g)}const q=[{id:"startingSpeed",name:"Quick Start",description:"Start runs with bonus speed",maxLevel:5,costPerLevel:[50,100,150,250,400],effect:{type:"speed",valuePerLevel:[2,4,6,8,10]},icon:"üëü"},{id:"startingControl",name:"Soft Touch",description:"Start runs with bonus control",maxLevel:5,costPerLevel:[50,100,150,250,400],effect:{type:"control",valuePerLevel:[2,4,6,8,10]},icon:"ü§≤"},{id:"startingShotPower",name:"Power Hitter",description:"Start runs with bonus shot power",maxLevel:5,costPerLevel:[50,100,150,250,400],effect:{type:"shotPower",valuePerLevel:[2,4,6,8,10]},icon:"üèë"},{id:"startingTackle",name:"Ball Hunter",description:"Start runs with bonus tackle",maxLevel:5,costPerLevel:[50,100,150,250,400],effect:{type:"tackle",valuePerLevel:[2,4,6,8,10]},icon:"‚öîÔ∏è"},{id:"bonusGems",name:"Gem Finder",description:"Earn bonus gems per run",maxLevel:5,costPerLevel:[100,200,350,500,750],effect:{type:"gemBonus",valuePerLevel:[5,10,15,25,40]},icon:"üíé"},{id:"upgradeChoices",name:"More Options",description:"See extra upgrade choices",maxLevel:2,costPerLevel:[300,600],effect:{type:"extraChoices",valuePerLevel:[1,2]},icon:"üé¥"},{id:"rerollCount",name:"Second Chance",description:"Get rerolls for upgrade drafts",maxLevel:3,costPerLevel:[150,300,500],effect:{type:"rerolls",valuePerLevel:[1,2,3]},icon:"üîÑ"},{id:"healingRate",name:"Quick Recovery",description:"Recover faster between moments",maxLevel:3,costPerLevel:[100,200,400],effect:{type:"recovery",valuePerLevel:[10,20,35]},icon:"üíö"},{id:"startingStamina",name:"Endurance",description:"Start runs with bonus stamina",maxLevel:5,costPerLevel:[50,100,150,250,400],effect:{type:"stamina",valuePerLevel:[2,4,6,8,10]},icon:"üí™"},{id:"rarityBoost",name:"Lucky Rolls",description:"Increased rare upgrade chance",maxLevel:3,costPerLevel:[200,400,700],effect:{type:"rarityBonus",valuePerLevel:[5,10,20]},icon:"üçÄ"},{id:"startingUpgrade",name:"Head Start",description:"Start runs with a random upgrade",maxLevel:2,costPerLevel:[500,1e3],effect:{type:"freeUpgrade",valuePerLevel:[1,2]},icon:"üéÅ"},{id:"teammateBoost",name:"Team Spirit",description:"Teammates are stronger",maxLevel:3,costPerLevel:[150,300,500],effect:{type:"teammateStats",valuePerLevel:[5,10,15]},icon:"ü§ù"}];function J(g,o){return o>=g.maxLevel?1/0:g.costPerLevel[o]}function Q(g,o){return o<=0?0:g.effect.valuePerLevel[Math.min(o,g.maxLevel)-1]}const Z={info:3447003,success:2600544,warning:15965202,error:15158332},ee={info:"‚ÑπÔ∏è",success:"‚úÖ",warning:"‚ö†Ô∏è",error:"‚ùå"};class W{constructor(o){c(this,"scene");c(this,"toasts",[]);c(this,"baseY",100);c(this,"spacing",60);this.scene=o}show(o){const e=new te(this.scene,{...o,y:this.calculateY(),onComplete:()=>this.removeToast(e)});return this.toasts.push(e),e}calculateY(){return this.baseY+this.toasts.length*this.spacing}removeToast(o){const e=this.toasts.indexOf(o);e>-1&&(this.toasts.splice(e,1),this.toasts.forEach((t,s)=>{this.scene.tweens.add({targets:t,y:this.baseY+s*this.spacing,duration:200,ease:"Power2"})}))}info(o,e){return this.show({message:o,type:"info",icon:e})}success(o,e){return this.show({message:o,type:"success",icon:e})}warning(o,e){return this.show({message:o,type:"warning",icon:e})}error(o,e){return this.show({message:o,type:"error",icon:e})}clear(){this.toasts.forEach(o=>o.dismiss()),this.toasts=[]}}class te extends p.GameObjects.Container{constructor(e,t){const s=e.cameras.main.centerX,i=t.y;super(e,s,i);c(this,"onComplete");this.onComplete=t.onComplete;const n=t.type||"info",a=t.duration||3e3,r=Z[n],l=t.icon||ee[n],d=e.add.text(0,0,t.message,{fontSize:"16px"}),h=d.width;d.destroy();const f=Math.max(200,h+80),m=44,u=e.add.graphics();u.fillStyle(1710638,.95),u.fillRoundedRect(-f/2,-m/2,f,m,8),u.lineStyle(2,r,.8),u.strokeRoundedRect(-f/2,-m/2,f,m,8),this.add(u);const y=e.add.graphics();y.fillStyle(r,1),y.fillRoundedRect(-f/2,-m/2,6,m,{tl:8,tr:0,br:0,bl:8}),this.add(y);const k=e.add.text(-f/2+24,0,l,{fontSize:"18px"});k.setOrigin(.5),this.add(k);const w=e.add.text(8,0,t.message,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#ffffff"});w.setOrigin(.5),this.add(w),this.setDepth(500),this.setScrollFactor(0),e.add.existing(this),this.setAlpha(0),this.x=s+200,e.tweens.add({targets:this,x:s,alpha:1,duration:300,ease:"Power2"}),e.time.delayedCall(a,()=>this.dismiss())}dismiss(){this.scene.tweens.add({targets:this,x:this.x+200,alpha:0,duration:200,ease:"Power2",onComplete:()=>{this.onComplete&&this.onComplete(),this.destroy()}})}}class De extends p.GameObjects.Container{constructor(o,e,t,s="üèÜ"){const i=o.cameras.main.centerX,n=150;super(o,i,n);const a=300,r=80,l=o.add.graphics();l.fillStyle(1710638,.95),l.fillRoundedRect(-a/2,-r/2,a,r,12),l.lineStyle(3,15844367,1),l.strokeRoundedRect(-a/2,-r/2,a,r,12),this.add(l);const d=o.add.graphics();d.fillStyle(15844367,.2),d.fillRoundedRect(-a/2-4,-r/2-4,a+8,r+8,14),this.add(d),this.sendToBack(d);const h=o.add.text(-a/2+40,0,s,{fontSize:"36px"});h.setOrigin(.5),this.add(h);const f=o.add.text(10,-12,e,{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#f1c40f",fontStyle:"bold"});f.setOrigin(.5),this.add(f);const m=o.add.text(10,14,t,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#bdc3c7"});m.setOrigin(.5),this.add(m),this.setDepth(510),this.setScrollFactor(0),o.add.existing(this),this.setAlpha(0),this.setScale(.5),this.y=n-50,o.tweens.add({targets:this,y:n,alpha:1,scaleX:1,scaleY:1,duration:500,ease:"Back.easeOut"}),o.tweens.add({targets:d,alpha:.5,duration:500,yoyo:!0,repeat:3}),o.time.delayedCall(4e3,()=>{o.tweens.add({targets:this,y:n-50,alpha:0,duration:300,onComplete:()=>this.destroy()})})}}class se extends p.Scene{constructor(){super({key:"StoreScene"});c(this,"audioSystem");c(this,"toastManager");c(this,"gemText");c(this,"currentTab","characters");c(this,"contentContainer")}create(){this.audioSystem=new R(this),this.toastManager=new W(this),this.cameras.main.setBackgroundColor(1710638),this.createHeader(),this.createTabs(),this.contentContainer=this.add.container(0,0),this.showCharactersTab(),this.cameras.main.fadeIn(300)}createHeader(){new T(this,{x:80,y:40,width:100,height:40,text:"‚Üê Back",fontSize:16,style:"secondary",onClick:()=>{this.audioSystem.playClick(),this.cameras.main.fadeOut(300),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("MenuScene")})}}),this.add.text(this.cameras.main.centerX,40,"üõí STORE",{fontFamily:"Arial, sans-serif",fontSize:"36px",color:"#f1c40f",fontStyle:"bold"}).setOrigin(.5),this.createGemDisplay()}createGemDisplay(){const e=b.getInstance().getGems(),t=this.add.container(this.cameras.main.width-100,40),s=this.add.graphics();s.fillStyle(2899536,.9),s.fillRoundedRect(-60,-20,120,40,10),s.lineStyle(2,15844367,.5),s.strokeRoundedRect(-60,-20,120,40,10),t.add(s);const i=this.add.text(-40,0,"üíé",{fontSize:"20px"});i.setOrigin(.5),t.add(i),this.gemText=this.add.text(10,0,e.toString(),{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#f1c40f",fontStyle:"bold"}),this.gemText.setOrigin(.5),t.add(this.gemText)}updateGemDisplay(){this.gemText&&this.gemText.setText(b.getInstance().getGems().toString())}createTabs(){new T(this,{x:this.cameras.main.centerX-100,y:100,width:150,height:40,text:"Characters",fontSize:16,style:this.currentTab==="characters"?"primary":"secondary",onClick:()=>{this.currentTab="characters",this.showCharactersTab()}}),new T(this,{x:this.cameras.main.centerX+100,y:100,width:150,height:40,text:"Meta Upgrades",fontSize:16,style:this.currentTab==="meta"?"primary":"secondary",onClick:()=>{this.currentTab="meta",this.showMetaTab()}})}showCharactersTab(){var h,f;this.clearContent();const e=b.getInstance().getUnlockedCharacters(),t=I.filter(m=>m.unlockCost>0&&!e.includes(m.id)),s=this.add.text(this.cameras.main.centerX,160,"Unlock New Characters",{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#bdc3c7"});s.setOrigin(.5),(h=this.contentContainer)==null||h.add(s);const i=4,n=180,a=240,r=this.cameras.main.centerX-(Math.min(t.length,i)-1)*(n+20)/2,l=200;t.forEach((m,u)=>{const y=Math.floor(u/i),k=u%i,w=r+k*(n+20),S=l+y*(a+20);this.createCharacterCard(m,w,S,n,a)});const d=this.add.text(this.cameras.main.centerX,this.cameras.main.height-50,`Unlocked: ${e.length} / ${I.length}`,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#7f8c8d"});d.setOrigin(.5),(f=this.contentContainer)==null||f.add(d)}createCharacterCard(e,t,s,i,n){var S;const r=b.getInstance().getGems()>=e.unlockCost,l=this.add.container(t,s);(S=this.contentContainer)==null||S.add(l);const d=this.add.graphics();d.fillStyle(2899536,1),d.fillRoundedRect(-i/2,-20,i,n,12),d.lineStyle(2,r?2600544:8359053,.8),d.strokeRoundedRect(-i/2,-20,i,n,12),l.add(d);const h=this.add.graphics();h.fillStyle(e.color,1),h.fillRoundedRect(-i/2,-20,i,8,{tl:12,tr:12,bl:0,br:0}),l.add(h);const f=this.add.circle(0,40,30,e.color);l.add(f);const m=this.add.text(0,90,e.name,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#ffffff",fontStyle:"bold"});m.setOrigin(.5),l.add(m);const u=this.add.text(0,110,e.role.toUpperCase(),{fontFamily:"Arial, sans-serif",fontSize:"10px",color:"#bdc3c7"});u.setOrigin(.5),l.add(u);const y=this.add.text(0,135,`‚ú® ${e.trait.name}`,{fontFamily:"Arial, sans-serif",fontSize:"11px",color:"#27ae60"});y.setOrigin(.5),l.add(y);const k=this.add.text(0,155,`‚ö†Ô∏è ${e.downside.name}`,{fontFamily:"Arial, sans-serif",fontSize:"11px",color:"#e74c3c"});k.setOrigin(.5),l.add(k);const w=this.add.text(0,185,`üíé ${e.unlockCost}`,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:r?"#f1c40f":"#7f8c8d",fontStyle:"bold"});if(w.setOrigin(.5),l.add(w),r){const x=this.add.zone(0,100,i,n).setInteractive({useHandCursor:!0});l.add(x),x.on("pointerover",()=>{d.clear(),d.fillStyle(3426654,1),d.fillRoundedRect(-i/2,-20,i,n,12),d.lineStyle(3,2600544,1),d.strokeRoundedRect(-i/2,-20,i,n,12)}),x.on("pointerout",()=>{d.clear(),d.fillStyle(2899536,1),d.fillRoundedRect(-i/2,-20,i,n,12),d.lineStyle(2,2600544,.8),d.strokeRoundedRect(-i/2,-20,i,n,12)}),x.on("pointerdown",()=>{this.buyCharacter(e,l)})}}buyCharacter(e,t){const s=b.getInstance();s.spendGems(e.unlockCost)?(s.unlockCharacter(e.id),this.audioSystem.playUpgrade(),this.toastManager.success(`Unlocked ${e.name}!`,"üéâ"),this.tweens.add({targets:t,scaleX:1.1,scaleY:1.1,duration:150,yoyo:!0,onComplete:()=>{this.tweens.add({targets:t,alpha:0,y:t.y-30,duration:300,onComplete:()=>{t.destroy(),this.updateGemDisplay()}})}})):(this.audioSystem.playError(),this.toastManager.error("Not enough gems!"))}showMetaTab(){var i;this.clearContent();const e=this.add.text(this.cameras.main.centerX,160,"Permanent Upgrades",{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#bdc3c7"});e.setOrigin(.5),(i=this.contentContainer)==null||i.add(e);const t=200,s=70;q.slice(0,6).forEach((n,a)=>{const r=t+a*s;this.createMetaUpgradeRow(n,r)})}createMetaUpgradeRow(e,t){var w;const s=b.getInstance(),i=s.getMetaUpgradeLevel(e.id),n=i>=e.maxLevel,a=n?1/0:J(e,i),l=s.getGems()>=a,d=this.add.container(this.cameras.main.centerX,t);(w=this.contentContainer)==null||w.add(d);const h=this.add.graphics();h.fillStyle(2899536,.8),h.fillRoundedRect(-350,-25,700,60,10),d.add(h);const f=this.add.text(-320,0,e.icon,{fontSize:"28px"});f.setOrigin(.5),d.add(f);const m=this.add.text(-260,-10,e.name,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#ffffff",fontStyle:"bold"});d.add(m);const u=this.add.text(-260,10,e.description,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#7f8c8d"});d.add(u);let y="";for(let S=0;S<e.maxLevel;S++)y+=S<i?"‚óè":"‚óã";const k=this.add.text(150,0,y,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#f1c40f"});if(k.setOrigin(.5),d.add(k),!n){const S=Q(e,i+1),x=this.add.text(230,0,`+${S}%`,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#27ae60"});x.setOrigin(.5),d.add(x)}if(n){const S=this.add.text(300,0,"MAXED",{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#7f8c8d"});S.setOrigin(.5),d.add(S)}else new T(this,{x:this.cameras.main.centerX+300,y:t,width:80,height:35,text:`üíé ${a}`,fontSize:14,style:l?"success":"secondary",disabled:!l,onClick:()=>{s.spendGems(a)&&(s.setMetaUpgradeLevel(e.id,i+1),this.audioSystem.playUpgrade(),this.toastManager.success(`${e.name} upgraded!`),this.updateGemDisplay(),this.showMetaTab())}})}clearContent(){var e;(e=this.contentContainer)==null||e.removeAll(!0)}}class ie extends p.Scene{constructor(){super({key:"CharacterSelectScene"});c(this,"audioSystem");c(this,"selectedCharacter");c(this,"characterCards",new Map);c(this,"detailsPanel");c(this,"playButton")}create(){this.audioSystem=new R(this),this.cameras.main.setBackgroundColor(1710638),this.createHeader(),this.createCharacterGrid(),this.createDetailsPanel();const e=b.getInstance().getLastPlayedCharacter(),t=b.getInstance().getUnlockedCharacters();e&&t.includes(e)?this.selectCharacter(L(e)):t.length>0&&this.selectCharacter(L(t[0])),this.cameras.main.fadeIn(300)}createHeader(){new T(this,{x:80,y:40,width:100,height:40,text:"‚Üê Back",fontSize:16,style:"secondary",onClick:()=>{this.audioSystem.playClick(),this.cameras.main.fadeOut(300),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("MenuScene")})}}),this.add.text(this.cameras.main.centerX,40,"SELECT YOUR PLAYER",{fontFamily:"Arial, sans-serif",fontSize:"32px",color:"#f1c40f",fontStyle:"bold"}).setOrigin(.5)}createCharacterGrid(){const e=b.getInstance().getUnlockedCharacters(),t=I,s=5,i=100,n=130,a=80,r=100,l=20,d=20;t.forEach((h,f)=>{const m=e.includes(h.id),u=Math.floor(f/s),y=f%s,k=a+y*(i+l),w=r+u*(n+d),S=this.createCharacterCard(h,k,w,i,n,m);this.characterCards.set(h.id,S)})}createCharacterCard(e,t,s,i,n,a){const r=this.add.container(t,s),l=this.add.graphics();if(l.fillStyle(a?2899536:1710618,1),l.fillRoundedRect(0,0,i,n,10),l.lineStyle(2,a?e.color:4473924,.8),l.strokeRoundedRect(0,0,i,n,10),r.add(l),a){const f=this.add.graphics();f.fillStyle(e.color,1),f.fillRoundedRect(0,0,i,5,{tl:10,tr:10,bl:0,br:0}),r.add(f)}if(a){const f=this.add.circle(i/2,45,25,e.color);r.add(f);const m={forward:"‚ö°",midfielder:"üîÑ",defender:"üõ°Ô∏è",goalkeeper:"üß§"},u=this.add.text(i/2,45,m[e.role]||"‚óè",{fontSize:"18px"});u.setOrigin(.5),r.add(u)}else{const f=this.add.text(i/2,45,"üîí",{fontSize:"24px"});f.setOrigin(.5),r.add(f)}const d=this.add.text(i/2,85,e.name.split(" ")[0],{fontFamily:"Arial, sans-serif",fontSize:"12px",color:a?"#ffffff":"#666666",fontStyle:"bold"});d.setOrigin(.5),r.add(d);const h=this.add.text(i/2,102,e.role.toUpperCase(),{fontFamily:"Arial, sans-serif",fontSize:"9px",color:a?"#bdc3c7":"#444444"});if(h.setOrigin(.5),r.add(h),!a){const f=this.add.text(i/2,118,`üíé ${e.unlockCost}`,{fontFamily:"Arial, sans-serif",fontSize:"10px",color:"#7f8c8d"});f.setOrigin(.5),r.add(f)}if(a){const f=this.add.zone(i/2,n/2,i,n).setInteractive({useHandCursor:!0});r.add(f),f.on("pointerover",()=>{var m;((m=this.selectedCharacter)==null?void 0:m.id)!==e.id&&this.tweens.add({targets:r,scaleX:1.05,scaleY:1.05,duration:100})}),f.on("pointerout",()=>{var m;((m=this.selectedCharacter)==null?void 0:m.id)!==e.id&&this.tweens.add({targets:r,scaleX:1,scaleY:1,duration:100})}),f.on("pointerdown",()=>{this.audioSystem.playClick(),this.selectCharacter(e)})}return r}selectCharacter(e){if(this.selectedCharacter){const s=this.characterCards.get(this.selectedCharacter.id);s&&this.tweens.add({targets:s,scaleX:1,scaleY:1,duration:100})}this.selectedCharacter=e;const t=this.characterCards.get(e.id);t&&this.tweens.add({targets:t,scaleX:1.1,scaleY:1.1,duration:100}),this.updateDetailsPanel(e),this.playButton&&this.playButton.setDisabled(!1)}createDetailsPanel(){this.detailsPanel=this.add.container(650,100);const n=this.add.graphics();n.fillStyle(1710638,.95),n.fillRoundedRect(0,0,350,450,15),n.lineStyle(2,3447003,.5),n.strokeRoundedRect(0,0,350,450,15),this.detailsPanel.add(n);const a=this.add.text(350/2,450/2,"Select a character",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#7f8c8d"});a.setOrigin(.5),a.setName("placeholder"),this.detailsPanel.add(a),this.playButton=new T(this,{x:650+350/2,y:590,width:200,height:50,text:"‚ñ∂ START RUN",fontSize:20,style:"success",disabled:!0,onClick:()=>{this.selectedCharacter&&this.startRun()}})}updateDetailsPanel(e){if(!this.detailsPanel)return;this.detailsPanel.getAll().filter(S=>S.name!=="bg"&&S.type!=="Graphics").forEach(S=>S.destroy());const s=350,i=this.add.text(s/2,30,e.name,{fontFamily:"Arial, sans-serif",fontSize:"24px",color:"#ffffff",fontStyle:"bold"});i.setOrigin(.5),this.detailsPanel.add(i);const n=this.add.text(s/2,55,e.role.toUpperCase(),{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#"+e.color.toString(16).padStart(6,"0")});n.setOrigin(.5),this.detailsPanel.add(n);const a=this.add.text(s/2,85,e.description,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#bdc3c7",align:"center",wordWrap:{width:s-40}});a.setOrigin(.5),this.detailsPanel.add(a);const r=130,l=[{name:"Speed",value:e.stats.speed},{name:"Stamina",value:e.stats.stamina},{name:"Control",value:e.stats.control},{name:"Shot Power",value:e.stats.shotPower},{name:"Pass Power",value:e.stats.passPower},{name:"Tackle",value:e.stats.tackle},{name:"Dodge",value:e.stats.dodge}];l.forEach((S,x)=>{const P=r+x*28,X=this.add.text(20,P,S.name,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#bdc3c7"});this.detailsPanel.add(X);const O=this.add.graphics();O.fillStyle(2899536,1),O.fillRoundedRect(120,P-2,150,16,4),this.detailsPanel.add(O);const A=this.add.graphics(),U=S.value/10*146,V=S.value>=8?2600544:S.value>=5?15965202:15158332;A.fillStyle(V,1),A.fillRoundedRect(122,P,U,12,3),this.detailsPanel.add(A);const F=this.add.text(285,P,S.value.toString(),{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#ffffff"});F.setOrigin(0,0),this.detailsPanel.add(F)});const d=r+l.length*28+20,h=this.add.text(20,d,"‚ú® TRAIT",{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#27ae60",fontStyle:"bold"});this.detailsPanel.add(h);const f=this.add.text(20,d+18,e.trait.name,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#ffffff",fontStyle:"bold"});this.detailsPanel.add(f);const m=this.add.text(20,d+36,e.trait.description,{fontFamily:"Arial, sans-serif",fontSize:"11px",color:"#95a5a6",wordWrap:{width:s-40}});this.detailsPanel.add(m);const u=d+70,y=this.add.text(20,u,"‚ö†Ô∏è DOWNSIDE",{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#e74c3c",fontStyle:"bold"});this.detailsPanel.add(y);const k=this.add.text(20,u+18,e.downside.name,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#ffffff",fontStyle:"bold"});this.detailsPanel.add(k);const w=this.add.text(20,u+36,e.downside.description,{fontFamily:"Arial, sans-serif",fontSize:"11px",color:"#95a5a6",wordWrap:{width:s-40}});this.detailsPanel.add(w)}startRun(){this.selectedCharacter&&(b.getInstance().setLastPlayedCharacter(this.selectedCharacter.id),b.getInstance().addUniqueToStat("uniqueCharactersPlayed",this.selectedCharacter.id),this.audioSystem.playMomentStart(),this.cameras.main.fadeOut(300),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("RunScene",{character:this.selectedCharacter})}))}}class oe extends p.Physics.Arcade.Sprite{constructor(e,t,s,i){super(e,t,s,"player_0");c(this,"character");c(this,"stats");c(this,"hasBall",!1);c(this,"isMoving",!1);c(this,"isStunned",!1);c(this,"isShooting",!1);c(this,"isDodging",!1);c(this,"justReceivedBall",!1);c(this,"recentlyLostBall",!1);c(this,"stamina",100);c(this,"maxStamina",100);c(this,"shootCooldown",0);c(this,"passCooldown",0);c(this,"tackleCooldown",0);c(this,"dodgeCooldown",0);c(this,"SHOOT_COOLDOWN_MS",220);c(this,"PASS_COOLDOWN_MS",250);c(this,"TACKLE_COOLDOWN_MS",700);c(this,"DODGE_COOLDOWN_MS",900);c(this,"targetVelocityX",0);c(this,"targetVelocityY",0);c(this,"acceleration",800);c(this,"friction",.92);c(this,"baseSpeed",200);c(this,"facingAngle",0);c(this,"stickGraphics");c(this,"shotLineGraphics");c(this,"upgradeSystem");c(this,"onShoot");c(this,"onPass");c(this,"onTackle");c(this,"onDodge");c(this,"onShootFailed");this.character=i,this.stats={...i.stats},e.add.existing(this),e.physics.add.existing(this),this.setCollideWorldBounds(!0),this.setCircle(20,4,8),this.setDrag(100),this.setDepth(10);const n=this.getColorIndex(i.color);this.setTexture(`player_${n}`),this.stickGraphics=e.add.graphics(),this.stickGraphics.setDepth(11),this.shotLineGraphics=e.add.graphics(),this.shotLineGraphics.setDepth(9)}getColorIndex(e){const s=[3447003,15158332,3066993,10181046,15965202,1752220,15105570,9323693,15844367,1482885,12597547,2600544,13849600,2719929,9109504,48340,6765239,16733986,3426654,15277667].indexOf(e);return s>=0?s:0}setUpgradeSystem(e){this.upgradeSystem=e}getModifiedStat(e){const t=this.stats[e];return this.upgradeSystem?this.upgradeSystem.getModifiedStat(t,e):t}update(e,t){if(this.updateCooldowns(e),this.isStunned){this.setVelocity(this.body.velocity.x*.9,this.body.velocity.y*.9);return}this.isDodging||(this.processMovement(t,e),this.processActions(t),this.updateVisuals(t),this.regenerateStamina(e))}processMovement(e,t){const s=this.getModifiedStat("speed")*this.baseSpeed/6;this.targetVelocityX=e.moveX*s,this.targetVelocityY=e.moveY*s;const i=this.body.velocity.x,n=this.body.velocity.y;let a=i,r=n;this.targetVelocityX!==0?a+=(this.targetVelocityX-i)*.15:a*=this.friction,this.targetVelocityY!==0?r+=(this.targetVelocityY-n)*.15:r*=this.friction,this.setVelocity(a,r),this.isMoving=e.isMoving,e.isMoving?this.facingAngle=Math.atan2(e.moveY,e.moveX):e.hasMouseMoved&&(this.facingAngle=e.aimAngle)}processActions(e){e.shoot&&this.tryShoot(e.aimAngle),e.pass&&this.hasBall&&this.passCooldown<=0&&this.pass(e.aimAngle),e.tackle&&!this.hasBall&&this.tackleCooldown<=0&&this.tackle(),e.dodge&&this.dodgeCooldown<=0&&this.stamina>=20&&this.dodge(e.moveX||Math.cos(e.aimAngle),e.moveY||Math.sin(e.aimAngle))}tryShoot(e,t=0){if(this.shootCooldown>0)return!1;if(!this.hasBall)return this.onShootFailed&&this.onShootFailed(),!1;const i=this.getModifiedStat("shotPower")*30*(.8+t*.4);return this.shoot(i,e),!0}shoot(e,t){var s;this.isShooting=!0,this.hasBall=!1,this.shootCooldown=this.SHOOT_COOLDOWN_MS,(s=this.upgradeSystem)==null||s.trigger("onShot",{player:this,position:{x:this.x,y:this.y},scene:this.scene}),this.onShoot&&this.onShoot(e,t),this.playStickSwing(t),this.playMuzzleFlash(t),this.scene.tweens.add({targets:this,scaleX:1.15,scaleY:.85,duration:80,yoyo:!0,ease:"Power2",onComplete:()=>{this.isShooting=!1,this.setScale(1)}})}playStickSwing(e){if(!this.stickGraphics)return;const t=e-Math.PI/3,s=e+Math.PI/6,i=35;let n=t;const a=100,r=this.scene.time.now,l=()=>{const d=this.scene.time.now-r,h=Math.min(d/a,1);n=p.Math.Linear(t,s,h),this.stickGraphics.clear(),this.stickGraphics.lineStyle(4,9127187,1),this.stickGraphics.beginPath(),this.stickGraphics.moveTo(this.x,this.y),this.stickGraphics.lineTo(this.x+Math.cos(n)*i,this.y+Math.sin(n)*i),this.stickGraphics.strokePath(),this.stickGraphics.fillStyle(3355443,1),this.stickGraphics.fillCircle(this.x+Math.cos(n)*i,this.y+Math.sin(n)*i,5),h<1?this.scene.time.delayedCall(16,l):this.scene.time.delayedCall(50,()=>{this.stickGraphics.clear()})};l()}playMuzzleFlash(e){if(!this.shotLineGraphics)return;const t=60,s=this.x+Math.cos(e)*t,i=this.y+Math.sin(e)*t;this.shotLineGraphics.clear(),this.shotLineGraphics.lineStyle(6,15844367,.8),this.shotLineGraphics.beginPath(),this.shotLineGraphics.moveTo(this.x+Math.cos(e)*25,this.y+Math.sin(e)*25),this.shotLineGraphics.lineTo(s,i),this.shotLineGraphics.strokePath(),this.shotLineGraphics.fillStyle(16777215,.8),this.shotLineGraphics.fillCircle(s,i,8);const n={alpha:1};this.scene.tweens.add({targets:n,alpha:0,duration:100,onUpdate:()=>{this.shotLineGraphics.setAlpha(n.alpha)},onComplete:()=>{this.shotLineGraphics.clear(),this.shotLineGraphics.setAlpha(1)}})}pass(e){var t;this.hasBall=!1,this.passCooldown=this.PASS_COOLDOWN_MS,(t=this.upgradeSystem)==null||t.trigger("onPass",{player:this,position:{x:this.x,y:this.y},scene:this.scene}),this.onPass&&this.onPass(e),this.scene.tweens.add({targets:this,scaleX:1.05,scaleY:.95,duration:60,yoyo:!0})}tackle(){var i;this.tackleCooldown=this.TACKLE_COOLDOWN_MS,this.stamina-=15,(i=this.upgradeSystem)==null||i.trigger("onTackle",{player:this,position:{x:this.x,y:this.y},scene:this.scene}),this.onTackle&&this.onTackle();const e=50+this.getModifiedStat("tackle")*5,t=Math.cos(this.facingAngle)*e,s=Math.sin(this.facingAngle)*e;this.scene.tweens.add({targets:this,x:this.x+t,y:this.y+s,duration:150,ease:"Power2"})}dodge(e,t){var n;this.isDodging=!0,this.dodgeCooldown=this.DODGE_COOLDOWN_MS,this.stamina-=20;const s=Math.sqrt(e*e+t*t)||1;e/=s,t/=s;const i=80+this.getModifiedStat("dodge")*8;(n=this.upgradeSystem)==null||n.trigger("onDodge",{player:this,position:{x:this.x,y:this.y},scene:this.scene}),this.onDodge&&this.onDodge(),this.scene.tweens.add({targets:this,x:this.x+e*i,y:this.y+t*i,duration:200,ease:"Power2",onComplete:()=>{this.isDodging=!1}}),this.scene.tweens.add({targets:this,alpha:.5,duration:100,yoyo:!0})}updateCooldowns(e){const t=e;this.shootCooldown=Math.max(0,this.shootCooldown-t),this.passCooldown=Math.max(0,this.passCooldown-t),this.tackleCooldown=Math.max(0,this.tackleCooldown-t),this.dodgeCooldown=Math.max(0,this.dodgeCooldown-t)}regenerateStamina(e){if(!this.isMoving){const t=15*(this.getModifiedStat("stamina")/6);this.stamina=Math.min(this.maxStamina,this.stamina+t*(e/1e3))}}updateVisuals(e){const t=this.facingAngle*.1;if(this.rotation=p.Math.Angle.RotateTo(this.rotation,t,.1),this.hasBall&&this.isMoving){const s=Math.sin(this.scene.time.now*.02)*2;this.y+=s*.1}}receiveBall(){var e;this.hasBall=!0,this.justReceivedBall=!0,(e=this.upgradeSystem)==null||e.trigger("onReceive",{player:this,position:{x:this.x,y:this.y},scene:this.scene}),this.scene.time.delayedCall(1e3,()=>{this.justReceivedBall=!1})}loseBall(){this.hasBall=!1,this.recentlyLostBall=!0,this.scene.time.delayedCall(2e3,()=>{this.recentlyLostBall=!1})}applyStun(e){this.isStunned=!0;let t=e;this.upgradeSystem&&(t=this.upgradeSystem.getModifiedStat(e,"stunDuration")),this.scene.time.delayedCall(t,()=>{this.isStunned=!1}),this.scene.tweens.add({targets:this,tint:16711680,duration:100,yoyo:!0,repeat:Math.floor(t/200)})}restoreStamina(e){this.stamina=Math.min(this.maxStamina,this.stamina+e)}addShield(e){const t=this.scene.add.sprite(this.x,this.y,"effect_shield");t.setAlpha(.7),t.setDepth(11);const s=this.scene.time.addEvent({delay:16,callback:()=>{t.setPosition(this.x,this.y)},loop:!0});this.scene.time.delayedCall(e,()=>{s.destroy(),this.scene.tweens.add({targets:t,alpha:0,duration:200,onComplete:()=>t.destroy()})})}getCooldowns(){return{shoot:this.shootCooldown/this.SHOOT_COOLDOWN_MS,pass:this.passCooldown/this.PASS_COOLDOWN_MS,tackle:this.tackleCooldown/this.TACKLE_COOLDOWN_MS,dodge:this.dodgeCooldown/this.DODGE_COOLDOWN_MS}}canShoot(){return this.hasBall&&this.shootCooldown<=0&&!this.isStunned&&!this.isDodging}getBallOffset(){return{x:this.x+Math.cos(this.facingAngle)*25,y:this.y+Math.sin(this.facingAngle)*25}}getFacingAngle(){return this.facingAngle}destroy(e){var t,s;(t=this.stickGraphics)==null||t.destroy(),(s=this.shotLineGraphics)==null||s.destroy(),super.destroy(e)}}class ae extends p.Physics.Arcade.Sprite{constructor(e,t,s){super(e,t,s,"ball");c(this,"owner",null);c(this,"baseSpeed",400);c(this,"friction",.985);c(this,"bounceAmount",.8);c(this,"isLoose",!0);c(this,"isAerial",!1);c(this,"lastOwner",null);c(this,"lastShooter",null);c(this,"isRebound",!1);c(this,"curveAmount",0);c(this,"isBoomerang",!1);c(this,"boomerangOrigin");c(this,"isPredictive",!1);c(this,"speedMultiplier",1);c(this,"magnetTarget");c(this,"trail");c(this,"trailPoints",[]);e.add.existing(this),e.physics.add.existing(this),this.setCircle(8,2,2),this.setBounce(this.bounceAmount),this.setCollideWorldBounds(!0),this.setDrag(50),this.setDepth(15),this.trail=e.add.graphics(),this.trail.setDepth(14)}update(e){this.owner?this.followOwner():this.updatePhysics(e),this.updateTrail(),this.checkRebound(),this.isBoomerang&&this.boomerangOrigin&&this.isLoose&&this.handleBoomerang(),this.magnetTarget&&this.handleMagnet()}followOwner(){var s,i;if(!this.owner)return;const e=((i=(s=this.owner).getBallOffset)==null?void 0:i.call(s))||{x:this.owner.x+25,y:this.owner.y},t=Math.sin(this.scene.time.now*.01)*2;this.setPosition(e.x+t*.5,e.y+t*.3),this.setVelocity(0,0),this.isLoose=!1}updatePhysics(e){const t=this.body.velocity;if(this.setVelocity(t.x*this.friction,t.y*this.friction),this.curveAmount!==0){const s=t.length();if(s>50){const i=-t.y/s,n=t.x/s;this.setVelocity(t.x+i*this.curveAmount*s*.05,t.y+n*this.curveAmount*s*.05),this.curveAmount*=.98}}t.length()<10&&this.setVelocity(0,0)}updateTrail(){this.body.velocity.length()>100&&this.trailPoints.unshift({x:this.x,y:this.y,alpha:1}),this.trailPoints.length>10&&this.trailPoints.pop(),this.trailPoints.forEach((t,s)=>{t.alpha*=.85}),this.trailPoints=this.trailPoints.filter(t=>t.alpha>.05),this.trail.clear(),this.trailPoints.forEach((t,s)=>{const i=6*(1-s/this.trailPoints.length);this.trail.fillStyle(16777215,t.alpha*.5),this.trail.fillCircle(t.x,t.y,i)})}checkRebound(){const e=this.body.velocity;this.lastShooter&&e.length()>50&&(this.isRebound=!0),e.length()<30&&this.scene.time.delayedCall(500,()=>{this.isRebound=!1,this.lastShooter=null})}handleBoomerang(){if(!this.boomerangOrigin)return;if(this.body.velocity.length()<100){const t=this.boomerangOrigin.x-this.x,s=this.boomerangOrigin.y-this.y;Math.sqrt(t*t+s*s)>30?this.setVelocity(t*2,s*2):(this.isBoomerang=!1,this.boomerangOrigin=void 0)}}handleMagnet(){if(!this.magnetTarget)return;const e=this.magnetTarget.x-this.x,t=this.magnetTarget.y-this.y,s=this.body.velocity;this.setVelocity(s.x+e*.02,s.y+t*.02)}shoot(e,t,s){this.owner=null,this.lastOwner=s,this.lastShooter=s,this.isLoose=!0;const i=e*this.speedMultiplier;this.setVelocity(Math.cos(t)*i,Math.sin(t)*i),this.speedMultiplier=1}pass(e,t,s){this.owner=null,this.lastOwner=s,this.isLoose=!0;const i=e*.7*this.speedMultiplier;this.setVelocity(Math.cos(t)*i,Math.sin(t)*i),this.isBoomerang&&(this.boomerangOrigin={x:s.x,y:s.y}),this.speedMultiplier=1}attachTo(e){this.lastOwner=this.owner,this.owner=e,this.isLoose=!1,this.isRebound=!1,this.lastShooter=null,this.curveAmount=0,this.isBoomerang=!1,this.boomerangOrigin=void 0,this.isPredictive=!1,this.magnetTarget=void 0}drop(){this.lastOwner=this.owner,this.owner=null,this.isLoose=!0;const e=Math.random()*Math.PI*2,t=50+Math.random()*50;this.setVelocity(Math.cos(e)*t,Math.sin(e)*t)}resetToCenter(){this.setPosition(600,350),this.setVelocity(0,0),this.owner=null,this.lastOwner=null,this.lastShooter=null,this.isLoose=!0,this.isRebound=!1,this.trailPoints=[],this.trail.clear(),this.curveAmount=0,this.isBoomerang=!1,this.boomerangOrigin=void 0,this.isPredictive=!1,this.magnetTarget=void 0,this.speedMultiplier=1}setCurve(e){this.curveAmount=e}setBoomerang(e){this.isBoomerang=e}setPredictive(e){this.isPredictive=e}setAerial(e){this.isAerial=e,e&&this.scene.tweens.add({targets:this,scaleY:1.5,duration:200,yoyo:!0})}setSpeedMultiplier(e){this.speedMultiplier=e}applyMagnet(e,t,s){this.magnetTarget={x:e,y:t},this.scene.time.delayedCall(100,()=>{this.magnetTarget=void 0})}wasRecentlyShot(){return this.lastShooter!==null&&this.body.velocity.length()>100}getPredictedPosition(e){const t=this.body.velocity;return{x:this.x+t.x*e*.001,y:this.y+t.y*e*.001}}destroy(e){this.trail.destroy(),super.destroy(e)}}class v{constructor(o){c(this,"scene");c(this,"fieldWidth",1200);c(this,"fieldHeight",700);c(this,"goalWidth",120);c(this,"playerTeamState","attack");c(this,"enemyTeamState","defend");c(this,"transitionTimer",0);c(this,"playerTeamChasers",new Set);c(this,"enemyTeamChasers",new Set);c(this,"maxChasers",2);c(this,"lastPassTime",new Map);c(this,"passCooldownMs",800);this.scene=o}updateTeamStates(o,e,t,s,i){const n=this.isTeamHasBall(o,e,t),a=this.isEnemyHasBall(o,s);this.transitionTimer>0?(this.transitionTimer-=i,this.transitionTimer<=0&&(this.playerTeamState==="transition"&&(this.playerTeamState=n?"attack":"defend"),this.enemyTeamState==="transition"&&(this.enemyTeamState=a?"attack":"defend"))):n&&this.playerTeamState==="defend"?(this.playerTeamState="transition",this.enemyTeamState="transition",this.transitionTimer=1200):a&&this.enemyTeamState==="defend"&&(this.playerTeamState="transition",this.enemyTeamState="transition",this.transitionTimer=1200),this.playerTeamChasers.clear(),this.enemyTeamChasers.clear()}getTeammateDecision(o,e,t,s,i,n,a=0){const r=o.aiConfig,l=this.calculateSeparation(o,[t,...s],80);let d;return n?d=this.getOffensiveDecision(o,e,t,s,i,r):e.owner===null?d=this.getLooseBallDecision(o,e,t,s,i,r,!0,a):this.isTeamHasBall(e,t,s)?d=this.getSupportDecision(o,e,t,s,i,r,a):d=this.getDefensiveDecision(o,e,t,s,i,r,a),d.action==="move"&&d.targetX!==void 0&&d.targetY!==void 0&&(d.targetX+=l.x,d.targetY+=l.y),d.avoidance=l,d}getEnemyDecision(o,e,t,s,i,n,a=0){const r=o.aiConfig,l=this.calculateSeparation(o,i,80);let d;return n?d=this.getEnemyOffensiveDecision(o,e,t,s,i,r):e.owner===null?d=this.getLooseBallDecision(o,e,t,s,i,r,!1,a):this.isEnemyHasBall(e,i)?d=this.getEnemySupportDecision(o,e,i,r,a):d=this.getEnemyDefensiveDecision(o,e,t,s,r,a),d.action==="move"&&d.targetX!==void 0&&d.targetY!==void 0&&(d.targetX+=l.x,d.targetY+=l.y),d.avoidance=l,d}calculateSeparation(o,e,t){let s=0,i=0,n=0;for(const a of e){if(a===o||!a.x||!a.y)continue;const r=o.x-a.x,l=o.y-a.y,d=Math.sqrt(r*r+l*l);if(d<t&&d>0){const h=(t-d)/t;s+=r/d*h*30,i+=l/d*h*30,n++}}return n>0&&(s/=n,i/=n),{x:s,y:i}}canChaseLooseBall(o,e){const t=e?this.playerTeamChasers:this.enemyTeamChasers;return t.size<this.maxChasers?(t.add(o),!0):t.has(o)}getOffensiveDecision(o,e,t,s,i,n){const a=this.fieldWidth,r=this.fieldHeight/2,l=p.Math.Distance.Between(o.x,o.y,a,r);if(l<180&&n.skill>.4&&i.filter(u=>p.Math.Distance.Between(o.x,o.y,u.x,u.y)<80&&u.x>o.x).length===0)return{action:"shoot",targetX:a,targetY:r,priority:10};const d=i.filter(m=>p.Math.Distance.Between(o.x,o.y,m.x,m.y)<80),h=!this.isOnPassCooldown(o);if(d.length>0&&h){const m=this.findBestPassTarget(o,t,s,i);if(m)return this.setPassCooldown(o),{action:"pass",targetEntity:m,priority:8}}if(l<250&&h){const m=Math.atan2(r-o.y,a-o.x);if(Math.abs(m)>Math.PI/4){const y=this.findBestPassTarget(o,t,s,i);if(y)return this.setPassCooldown(o),{action:"pass",targetEntity:y,priority:7}}}const f=this.getOffensivePosition(o,n.role,a,r);return{action:"move",targetX:f.x,targetY:f.y,priority:5}}getLooseBallDecision(o,e,t,s,i,n,a,r){var k,w,S;const l=p.Math.Distance.Between(o.x,o.y,e.x,e.y);let d;switch(n.role){case"forward":d=350;break;case"midfielder":d=300;break;case"defender":d=200;break;default:d=250}const f=(a?[t,...s]:i).map(x=>({entity:x,dist:p.Math.Distance.Between(x.x,x.y,e.x,e.y)}));f.sort((x,P)=>x.dist-P.dist);const m=((k=f[0])==null?void 0:k.entity)===o,u=((w=f[1])==null?void 0:w.entity)===o;if((m||u)&&l<d&&this.canChaseLooseBall(o,a)){const x=((S=e.getPredictedPosition)==null?void 0:S.call(e,300))||{x:e.x,y:e.y};return{action:"move",targetX:x.x,targetY:x.y,priority:9}}const y=this.getFormationPosition(o,n.role,r,a,e);return{action:"move",targetX:y.x,targetY:y.y,priority:3}}getSupportDecision(o,e,t,s,i,n,a){const r=e.owner||t,l=this.getPassingLanePosition(o,r,n.role,!0,i),d=p.Math.Distance.Between(o.x,o.y,r.x,r.y),h=!this.isInCoveringShadow(o,r,i);return d>80&&d<200&&h&&o.x>r.x,{action:"move",targetX:l.x,targetY:l.y,priority:6}}getDefensiveDecision(o,e,t,s,i,n,a){var y,k;const r=e.owner;if(!r)return this.getLooseBallDecision(o,e,t,s,i,n,!0,a);const l=p.Math.Distance.Between(o.x,o.y,r.x,r.y),h=[t,...s].map(w=>({entity:w,dist:p.Math.Distance.Between(w.x,w.y,r.x,r.y)}));h.sort((w,S)=>w.dist-S.dist);const f=((y=h[0])==null?void 0:y.entity)===o,m=((k=h[1])==null?void 0:k.entity)===o;if(f)return l<45&&n.aggressiveness>.4?{action:"tackle",targetEntity:r,priority:10}:{action:"move",targetX:r.x,targetY:r.y,priority:8};if(m){const w=this.getCoverPassingLane(o,r,i);return{action:"move",targetX:w.x,targetY:w.y,priority:7}}if(n.role==="defender"||n.role==="sweeper"){const w=this.getLastManPosition(o,r);return{action:"move",targetX:w.x,targetY:w.y,priority:6}}const u=this.getFormationPosition(o,n.role,a,!0,e);return{action:"move",targetX:u.x,targetY:u.y,priority:5}}getEnemyOffensiveDecision(o,e,t,s,i,n){const r=this.fieldHeight/2;if(p.Math.Distance.Between(o.x,o.y,0,r)<200+n.skill*50&&([t,...s].filter(u=>p.Math.Distance.Between(o.x,o.y,u.x,u.y)<80&&u.x<o.x).length===0||n.skill>.7))return{action:"shoot",targetX:0,targetY:r,priority:10};const d=[t,...s].filter(m=>p.Math.Distance.Between(o.x,o.y,m.x,m.y)<80),h=!this.isOnPassCooldown(o);if(d.length>0&&h&&i.length>1){const m=this.findBestEnemyPassTarget(o,i,[t,...s]);if(m)return this.setPassCooldown(o),{action:"pass",targetEntity:m,priority:8}}const f=this.getEnemyOffensivePosition(o,n.role);return{action:"move",targetX:f.x,targetY:f.y,priority:5}}getEnemySupportDecision(o,e,t,s,i){const n=e.owner,a=this.getPassingLanePosition(o,n,s.role,!1,[]);return{action:"move",targetX:a.x,targetY:a.y,priority:6}}getEnemyDefensiveDecision(o,e,t,s,i,n){const a=e.owner;if(!a)return{action:"wait",priority:1};const r=p.Math.Distance.Between(o.x,o.y,a.x,a.y);if(r<100+i.aggressiveness*80)return r<45?{action:"tackle",targetEntity:a,priority:10}:{action:"move",targetX:a.x,targetY:a.y,priority:8};const l=this.getFormationPosition(o,i.role,n,!1,e);return{action:"move",targetX:l.x,targetY:l.y,priority:4}}isTeamHasBall(o,e,t){return o.owner?o.owner===e||t.includes(o.owner):!1}isEnemyHasBall(o,e){return o.owner?e.includes(o.owner):!1}isOnPassCooldown(o){const e=this.lastPassTime.get(o);return e?this.scene.time.now-e<this.passCooldownMs:!1}setPassCooldown(o){this.lastPassTime.set(o,this.scene.time.now)}isInCoveringShadow(o,e,t){const s=o.x-e.x,i=o.y-e.y,n=Math.sqrt(s*s+i*i);for(const a of t){const r=a.x-e.x,l=a.y-e.y,d=Math.sqrt(r*r+l*l);if(d<n&&d>20&&(s*r+i*l)/(n*d)>.85)return!0}return!1}findBestPassTarget(o,e,t,s){const i=[e,...t].filter(r=>r!==o&&!r.hasBall);let n=null,a=-1/0;for(const r of i){const l=p.Math.Distance.Between(o.x,o.y,r.x,r.y);if(l<60||l>400)continue;const d=this.fieldWidth-r.x;let h=50;r.x>o.x&&(h+=25),h+=(1-d/this.fieldWidth)*20,h-=Math.abs(l-150)*.1,this.isInCoveringShadow(r,o,s)&&(h-=40);const u=s.filter(y=>p.Math.Distance.Between(r.x,r.y,y.x,y.y)<50);h-=u.length*15,h>a&&(a=h,n=r)}return a>30?n:null}findBestEnemyPassTarget(o,e,t){const s=e.filter(a=>a!==o&&!a.hasBall);let i=null,n=-1/0;for(const a of s){const r=p.Math.Distance.Between(o.x,o.y,a.x,a.y);if(r<60||r>400)continue;const l=a.x;let d=50;a.x<o.x&&(d+=25),d+=(1-l/this.fieldWidth)*20,this.isInCoveringShadow(a,o,t)&&(d-=40),d>n&&(n=d,i=a)}return n>30?i:null}getFormationPosition(o,e,t,s,i){const n=(i==null?void 0:i.x)||this.fieldWidth/2;let a,r;if(s)switch(e){case"goalkeeper":case"sweeper":a=80,r=this.fieldHeight/2;break;case"defender":a=Math.min(n-100,250),r=this.fieldHeight/2+(t%2===0?-100:100);break;case"midfielder":a=n-50,r=this.fieldHeight/2+(t%2===0?-150:150);break;case"forward":a=Math.min(n+100,this.fieldWidth-200),r=this.fieldHeight/2;break;default:a=this.fieldWidth*.4,r=this.fieldHeight/2}else switch(e){case"goalkeeper":case"sweeper":a=this.fieldWidth-80,r=this.fieldHeight/2;break;case"defender":a=Math.max(n+100,this.fieldWidth-250),r=this.fieldHeight/2+(t%2===0?-100:100);break;case"midfielder":a=n+50,r=this.fieldHeight/2+(t%2===0?-150:150);break;case"forward":a=Math.max(n-100,200),r=this.fieldHeight/2;break;default:a=this.fieldWidth*.6,r=this.fieldHeight/2}return a=p.Math.Clamp(a,60,this.fieldWidth-60),r=p.Math.Clamp(r,60,this.fieldHeight-60),{x:a,y:r}}getHomePosition(o,e,t){return this.getFormationPosition(o,e,0,!t,null)}getOffensivePosition(o,e,t,s){const i=t-o.x,n=s-o.y,a=Math.sqrt(i*i+n*n)||1,r=4;return{x:o.x+i/a*r+(Math.random()-.5)*2,y:o.y+n/a*r+(Math.random()-.5)*2}}getEnemyOffensivePosition(o,e){const s=this.fieldHeight/2;return this.getOffensivePosition(o,e,0,s)}getPassingLanePosition(o,e,t,s,i){if(!e)return this.getFormationPosition(o,t,0,s,null);s&&this.fieldWidth;const n=s?120:-120,a=o.y>this.fieldHeight/2?-100:100;let r=e.x+n,l=e.y+a;return r=p.Math.Clamp(r,80,this.fieldWidth-80),l=p.Math.Clamp(l,80,this.fieldHeight-80),{x:r,y:l}}getCoverPassingLane(o,e,t){const s=t.filter(n=>n.x<e.x);if(s.length===0)return{x:e.x-100,y:this.fieldHeight/2};const i=s.reduce((n,a)=>{const r=p.Math.Distance.Between(e.x,e.y,a.x,a.y);return r<n.dist?{entity:a,dist:r}:n},{entity:s[0],dist:1/0});return{x:(e.x+i.entity.x)/2,y:(e.y+i.entity.y)/2}}getLastManPosition(o,e){const t=this.fieldHeight/2,s=Math.max(50,Math.min(e.x-80,150)),i=t+(e.y-t)*.3;return{x:p.Math.Clamp(s,40,200),y:p.Math.Clamp(i,250,450)}}static createDefenderConfig(o=.5){return{role:"defender",aggressiveness:.4+o*.3,skill:.4+o*.4,speed:.85+o*.1,reactionTime:400-o*200}}static createMidfielderConfig(o=.5){return{role:"midfielder",aggressiveness:.5+o*.3,skill:.5+o*.3,speed:.9+o*.1,reactionTime:350-o*150}}static createForwardConfig(o=.5){return{role:"forward",aggressiveness:.6+o*.3,skill:.6+o*.3,speed:.95+o*.1,reactionTime:300-o*150}}static createSweeperConfig(o=.5){return{role:"sweeper",aggressiveness:.3+o*.2,skill:.5+o*.3,speed:.8+o*.1,reactionTime:300-o*100}}static createBossConfig(o){switch(o){case"pressMachine":return{role:"midfielder",aggressiveness:.95,skill:.7,speed:1.1,reactionTime:150};case"starForward":return{role:"forward",aggressiveness:.8,skill:.95,speed:1.2,reactionTime:100};default:return v.createForwardConfig(.8)}}}class ne extends p.Physics.Arcade.Sprite{constructor(e,t,s,i,n=0){super(e,t,s,`player_${n}`);c(this,"aiConfig");c(this,"aiSystem");c(this,"currentDecision");c(this,"decisionTimer",0);c(this,"hasBall",!1);c(this,"isStunned",!1);c(this,"speed",180);c(this,"tackleRange",40);c(this,"passRange",300);c(this,"facingAngle",0);c(this,"player");c(this,"teammates",[]);c(this,"enemies",[]);c(this,"ball");c(this,"onShoot");c(this,"onPass");c(this,"onTackle");switch(i){case"defender":this.aiConfig=v.createDefenderConfig(.5);break;case"forward":this.aiConfig=v.createForwardConfig(.5);break;default:this.aiConfig=v.createMidfielderConfig(.5)}this.aiSystem=new v(e),e.add.existing(this),e.physics.add.existing(this),this.setCircle(20,4,8),this.setCollideWorldBounds(!0),this.setDepth(9),this.speed=180*this.aiConfig.speed}update(e){if(this.isStunned){this.setVelocity(this.body.velocity.x*.9,this.body.velocity.y*.9);return}this.decisionTimer-=e,this.decisionTimer<=0&&(this.makeDecision(),this.decisionTimer=this.aiConfig.reactionTime),this.executeDecision(e),this.updateVisuals()}makeDecision(){!this.ball||!this.player||(this.currentDecision=this.aiSystem.getTeammateDecision(this,this.ball,this.player,this.teammates,this.enemies,this.hasBall))}executeDecision(e){if(!this.currentDecision)return;const t=this.currentDecision;switch(t.action){case"move":this.moveToward(t.targetX,t.targetY,e);break;case"shoot":this.hasBall&&this.shoot(t.targetX,t.targetY);break;case"pass":this.hasBall&&t.targetEntity&&this.pass(t.targetEntity);break;case"tackle":!this.hasBall&&t.targetEntity&&this.tackle(t.targetEntity);break;case"wait":this.setVelocity(0,0);break}}moveToward(e,t,s){const i=e-this.x,n=t-this.y,a=Math.sqrt(i*i+n*n);if(a>5){const r=this.speed;this.setVelocity(i/a*r,n/a*r),this.facingAngle=Math.atan2(n,i)}else this.setVelocity(0,0)}shoot(e,t){if(!this.hasBall)return;const s=Math.atan2(t-this.y,e-this.x),i=250+this.aiConfig.skill*100;this.hasBall=!1,this.onShoot&&this.onShoot(i,s)}pass(e){if(!this.hasBall||!e)return;const t=Math.atan2(e.y-this.y,e.x-this.x);this.hasBall=!1,this.onPass&&this.onPass(t,e)}tackle(e){if(!e)return;p.Math.Distance.Between(this.x,this.y,e.x,e.y)<this.tackleRange+20?this.onTackle&&this.onTackle(e):this.moveToward(e.x,e.y,16)}updateVisuals(){this.rotation=this.facingAngle*.1}receiveBall(){this.hasBall=!0}loseBall(){this.hasBall=!1}applyStun(e){this.isStunned=!0,this.scene.time.delayedCall(e,()=>{this.isStunned=!1}),this.scene.tweens.add({targets:this,tint:16711680,duration:100,yoyo:!0,repeat:Math.floor(e/200)})}applyDebuff(e,t){if(e==="slow"){const s=this.speed;this.speed*=.5,this.scene.time.delayedCall(t,()=>{this.speed=s})}}drainStamina(e){const t=this.speed;this.speed*=.8,this.scene.time.delayedCall(500,()=>{this.speed=t})}getBallOffset(){return{x:this.x+Math.cos(this.facingAngle)*25,y:this.y+Math.sin(this.facingAngle)*25}}getFacingAngle(){return this.facingAngle}setReferences(e,t,s,i){this.player=e,this.teammates=t.filter(n=>n!==this),this.enemies=s,this.ball=i}}class re extends p.Physics.Arcade.Sprite{constructor(e,t,s,i,n="normal",a=.5){let r="enemy_mid";switch(i){case"defender":r="enemy_defender";break;case"forward":r="enemy_forward";break}n==="boss"?r="enemy_boss":n==="orange"&&(r="enemy_orange");super(e,t,s,r);c(this,"aiConfig");c(this,"aiSystem");c(this,"currentDecision");c(this,"decisionTimer",0);c(this,"enemyType");c(this,"role");c(this,"hasBall",!1);c(this,"isStunned",!1);c(this,"speed",160);c(this,"tackleRange",40);c(this,"shotPower",280);c(this,"facingAngle",Math.PI);c(this,"player");c(this,"playerTeammates",[]);c(this,"enemyTeammates",[]);c(this,"ball");c(this,"onShoot");c(this,"onPass");c(this,"onTackle");if(this.enemyType=n,this.role=i,n==="boss")this.aiConfig=v.createBossConfig("starForward");else switch(i){case"defender":this.aiConfig=v.createDefenderConfig(a);break;case"forward":this.aiConfig=v.createForwardConfig(a);break;default:this.aiConfig=v.createMidfielderConfig(a)}this.aiSystem=new v(e),e.add.existing(this),e.physics.add.existing(this);const l=n==="boss"?24:20;this.setCircle(l,4,n==="boss"?4:8),this.setCollideWorldBounds(!0),this.setDepth(9),this.speed=160*this.aiConfig.speed,this.shotPower=250+this.aiConfig.skill*100,n==="boss"&&(this.speed*=1.2,this.shotPower*=1.3,this.tackleRange*=1.2),n==="orange"&&(this.speed*=.8)}update(e){if(this.isStunned){this.setVelocity(this.body.velocity.x*.9,this.body.velocity.y*.9);return}this.decisionTimer-=e,this.decisionTimer<=0&&(this.makeDecision(),this.decisionTimer=this.aiConfig.reactionTime),this.executeDecision(e),this.updateVisuals()}makeDecision(){!this.ball||!this.player||(this.currentDecision=this.aiSystem.getEnemyDecision(this,this.ball,this.player,this.playerTeammates,this.enemyTeammates,this.hasBall))}executeDecision(e){if(!this.currentDecision)return;const t=this.currentDecision;switch(t.action){case"move":this.moveToward(t.targetX,t.targetY,e);break;case"shoot":this.hasBall&&this.shoot(t.targetX,t.targetY);break;case"pass":this.hasBall&&t.targetEntity&&this.pass(t.targetEntity);break;case"tackle":!this.hasBall&&t.targetEntity&&this.tackle(t.targetEntity);break;case"wait":this.setVelocity(0,0);break}}moveToward(e,t,s){const i=e-this.x,n=t-this.y,a=Math.sqrt(i*i+n*n);a>5?(this.setVelocity(i/a*this.speed,n/a*this.speed),this.facingAngle=Math.atan2(n,i)):this.setVelocity(0,0)}shoot(e,t){if(!this.hasBall)return;const s=Math.atan2(t-this.y,e-this.x),i=(1-this.aiConfig.skill)*.3,n=s+(Math.random()-.5)*i;this.hasBall=!1,this.onShoot&&this.onShoot(this.shotPower,n)}pass(e){if(!this.hasBall||!e)return;const t=Math.atan2(e.y-this.y,e.x-this.x);this.hasBall=!1,this.onPass&&this.onPass(t,e)}tackle(e){if(!e)return;p.Math.Distance.Between(this.x,this.y,e.x,e.y)<this.tackleRange+20?this.onTackle&&this.onTackle(e):this.moveToward(e.x,e.y,16)}updateVisuals(){if(this.rotation=this.facingAngle*.1,this.enemyType==="boss"){const e=1+Math.sin(this.scene.time.now*.005)*.05;this.setScale(e)}}receiveBall(){this.hasBall=!0}loseBall(){this.hasBall=!1}applyStun(e){const t=this.enemyType==="boss"?e*.5:e,s=this.enemyType==="orange"?t*.3:t;this.isStunned=!0,this.scene.time.delayedCall(s,()=>{this.isStunned=!1}),this.scene.tweens.add({targets:this,tint:16776960,duration:100,yoyo:!0,repeat:Math.floor(s/200)})}applyDebuff(e,t){if(e==="slow"){const s=this.speed;this.speed*=.6,this.scene.time.delayedCall(t,()=>{this.speed=s}),this.setTint(3447003),this.scene.time.delayedCall(t,()=>{this.clearTint()})}}drainStamina(e){const t=this.speed;this.speed*=.7,this.scene.time.delayedCall(800,()=>{this.speed=t})}getBallOffset(){return{x:this.x+Math.cos(this.facingAngle)*25,y:this.y+Math.sin(this.facingAngle)*25}}getFacingAngle(){return this.facingAngle}setReferences(e,t,s,i){this.player=e,this.playerTeammates=t,this.enemyTeammates=s.filter(n=>n!==this),this.ball=i}bossAbility(){if(this.enemyType!=="boss")return;const e=this.speed;this.speed*=1.5,this.scene.time.delayedCall(1e3,()=>{this.speed=e}),this.scene.tweens.add({targets:this,alpha:.5,duration:100,yoyo:!0,repeat:4})}}class ce{constructor(o){c(this,"scene");c(this,"cursors");c(this,"wasd");c(this,"actionKeys");c(this,"shootChargeStart",0);c(this,"lastMouseX",0);c(this,"lastMouseY",0);c(this,"hasMouseMoved",!1);c(this,"wasMouseDown",!1);c(this,"aimAssistStrength",.5);this.scene=o,this.setupKeyboard(),this.setupMouseTracking()}setupKeyboard(){this.scene.input.keyboard&&(this.cursors=this.scene.input.keyboard.createCursorKeys(),this.wasd={W:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.W),A:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.A),S:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.S),D:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.D)},this.actionKeys={space:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.SPACE),shift:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.SHIFT),e:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.E),q:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.Q),escape:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.ESC),enter:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.ENTER),p:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.P),h:this.scene.input.keyboard.addKey(p.Input.Keyboard.KeyCodes.H)})}setupMouseTracking(){this.scene.input.on("pointermove",o=>{(Math.abs(o.x-this.lastMouseX)>5||Math.abs(o.y-this.lastMouseY)>5)&&(this.hasMouseMoved=!0,this.lastMouseX=o.x,this.lastMouseY=o.y)})}getState(o=0,e=0){const t={moveX:0,moveY:0,isMoving:!1,shoot:!1,shootHeld:!1,shootReleased:!1,pass:!1,tackle:!1,dodge:!1,aimAngle:0,aimX:0,aimY:0,mouseDown:!1,mouseJustDown:!1,hasMouseMoved:this.hasMouseMoved,pause:!1,confirm:!1,cancel:!1,showHelp:!1};if(this.cursors&&(this.cursors.left.isDown&&(t.moveX-=1),this.cursors.right.isDown&&(t.moveX+=1),this.cursors.up.isDown&&(t.moveY-=1),this.cursors.down.isDown&&(t.moveY+=1)),this.wasd&&(this.wasd.A.isDown&&(t.moveX-=1),this.wasd.D.isDown&&(t.moveX+=1),this.wasd.W.isDown&&(t.moveY-=1),this.wasd.S.isDown&&(t.moveY+=1)),t.moveX!==0&&t.moveY!==0){const n=Math.sqrt(t.moveX*t.moveX+t.moveY*t.moveY);t.moveX/=n,t.moveY/=n}if(t.isMoving=t.moveX!==0||t.moveY!==0,this.actionKeys){const n=this.actionKeys.space.isDown;t.shoot=p.Input.Keyboard.JustDown(this.actionKeys.space),t.shootHeld=n,t.shootReleased=p.Input.Keyboard.JustUp(this.actionKeys.space),t.shoot&&(this.shootChargeStart=this.scene.time.now),t.dodge=p.Input.Keyboard.JustDown(this.actionKeys.shift),t.pass=p.Input.Keyboard.JustDown(this.actionKeys.e),t.tackle=p.Input.Keyboard.JustDown(this.actionKeys.q),t.pause=p.Input.Keyboard.JustDown(this.actionKeys.escape)||p.Input.Keyboard.JustDown(this.actionKeys.p),t.confirm=p.Input.Keyboard.JustDown(this.actionKeys.enter),t.cancel=p.Input.Keyboard.JustDown(this.actionKeys.escape),t.showHelp=p.Input.Keyboard.JustDown(this.actionKeys.h)}const s=this.scene.input.activePointer,i=this.scene.cameras.main.getWorldPoint(s.x,s.y);return t.aimX=i.x,t.aimY=i.y,t.mouseDown=s.isDown,t.mouseJustDown=s.isDown&&!this.wasMouseDown,this.wasMouseDown=s.isDown,this.hasMouseMoved?t.aimAngle=p.Math.Angle.Between(o,e,i.x,i.y):t.isMoving?t.aimAngle=Math.atan2(t.moveY,t.moveX):t.aimAngle=0,t.mouseJustDown&&!this.isOverUI(s.x,s.y)&&(t.shoot=!0,this.shootChargeStart===0&&(this.shootChargeStart=this.scene.time.now)),t}isOverUI(o,e){return e<130||e>this.scene.cameras.main.height-100}getAimWithAssist(o,e,t,s){const i=this.scene.input.activePointer,n=this.scene.cameras.main.getWorldPoint(i.x,i.y),a=p.Math.Angle.Between(o,e,n.x,n.y),r=p.Math.Angle.Between(o,e,t,s);if(!this.hasMouseMoved||this.aimAssistStrength===0)return r;const l=p.Math.Angle.Wrap(r-a);return Math.abs(l)<Math.PI/3?a+l*this.aimAssistStrength*.3:a}getShootChargeTime(){var o;return(o=this.actionKeys)!=null&&o.space.isDown||this.scene.input.activePointer.isDown?this.scene.time.now-this.shootChargeStart:0}getShootChargePct(){return Math.min(this.getShootChargeTime()/1e3,1)}resetCharge(){this.shootChargeStart=0}setAimAssistStrength(o){this.aimAssistStrength=p.Math.Clamp(o,0,1)}getAimAssistStrength(){return this.aimAssistStrength}isKeyDown(o){var t;const e=(t=this.scene.input.keyboard)==null?void 0:t.addKey(o);return(e==null?void 0:e.isDown)||!1}disable(){this.scene.input.keyboard&&(this.scene.input.keyboard.enabled=!1)}enable(){this.scene.input.keyboard&&(this.scene.input.keyboard.enabled=!0)}destroy(){}}class le extends p.Events.EventEmitter{constructor(e){super();c(this,"scene");c(this,"ownedUpgrades",[]);c(this,"effects",new Map);c(this,"statModifiers",new Map);c(this,"tempModifiers",new Map);c(this,"synergyBonuses",new Map);c(this,"stacks",new Map);c(this,"cooldowns",new Map);c(this,"oneTimeUsed",new Set);this.scene=e,this.initializeHooks()}initializeHooks(){["onShot","onPass","onTackle","onSteal","onGoal","onReceive","onDodge","onTick","onMomentStart","onMomentEnd","onDamage","onHit","passive"].forEach(t=>this.effects.set(t,[]))}addUpgrade(e){this.ownedUpgrades.push(e),e.modifiers.forEach(t=>{const s=this.statModifiers.get(t.stat)||0,i=(t.isPercent,t.value);this.statModifiers.set(t.stat,s+i)}),e.hooks.forEach(t=>{var i;const s=this.createEffect(e,t);s&&((i=this.effects.get(t))==null||i.push(s))}),e.synergies.forEach(t=>{const s=(this.synergyBonuses.get(t)||0)+1;this.synergyBonuses.set(t,s)}),this.emit("upgradeAdded",e)}createEffect(e,t){const s=e.effectId,i={speedBoost10:()=>{},openSpaceSpeed:a=>{a.player&&this.isInOpenSpace(a)&&this.addTempModifier("speed",10,100)},pressSpeed:a=>{a.player&&!a.player.hasBall&&this.addTempModifier("speed",5,100)},dodgeSpeedBurst:a=>{this.addTempModifier("speed",15,2e3)},circleShot:a=>{a.position&&this.isInCircle(a.position)&&this.addTempModifier("shotPower",30,500)},reboundShotPower:a=>{this.addTempModifier("shotPower",20,500)},stationaryShotBoost:a=>{a.player&&!a.player.isMoving&&this.addTempModifier("shotPower",50,500)},chargeShot:a=>{},curvingShot:a=>{var r;(r=a.ball)==null||r.setCurve(.3)},splitShot:a=>{this.emit("createProjectile",{...a,power:.5})},trianglePassBoost:a=>{this.checkTriangleFormation(a)&&this.addTempModifier("passPower",25,500)},fastPass:a=>{var r;(r=a.ball)==null||r.setSpeedMultiplier(1.3)},boomerangPass:a=>{var r;(r=a.ball)==null||r.setBoomerang(!0)},predictivePass:a=>{var r;(r=a.ball)==null||r.setPredictive(!0)},oneTouchPass:a=>{var r;(r=a.player)!=null&&r.justReceivedBall&&this.addTempModifier("passPower",30,1e3)},lobPass:a=>{var r;(r=a.ball)==null||r.setAerial(!0)},extendedTackle:()=>{},pressTackleRange:a=>{var r;(r=a.player)!=null&&r.hasBall||this.addTempModifier("tackleRange",20,500)},counterPressTackle:a=>{var r;(r=a.player)!=null&&r.recentlyLostBall&&this.addTempModifier("tackle",40,2e3)},tackleReset:()=>{this.cooldowns.delete("tackle")},persistentTackle:a=>{if(a.target)this.stacks.set("persistentTackle",0);else{const r=(this.stacks.get("persistentTackle")||0)+2;this.stacks.set("persistentTackle",r),this.addTempModifier("tackle",r,1e4)}},tackleSlow:a=>{var r;(r=a.target)==null||r.applyDebuff("slow",2e3)},magnetSteal:()=>{},tackleStaminaRestore:a=>{var r;(r=a.player)==null||r.restoreStamina(20)},stealDodgeReset:()=>{this.cooldowns.delete("dodge")},tackleSpeed:a=>{this.addTempModifier("speed",20,2e3)},stealStamina:a=>{var r,l;(r=a.target)==null||r.drainStamina(15),(l=a.player)==null||l.restoreStamina(15)},extendedIframes:()=>{},dodgeDecoy:a=>{this.emit("createDecoy",a)},dodgeShield:a=>{var r;(r=a.player)==null||r.addShield(500)},slowMo:a=>{this.scene.time.timeScale=.5,this.scene.time.delayedCall(500,()=>{this.scene.time.timeScale=1})},goalSpeedStack:()=>{const a=Math.min((this.stacks.get("goalSpeed")||0)+1,3);this.stacks.set("goalSpeed",a),this.addTempModifier("speed",a*5,6e4)},goalFullRestore:a=>{var r;(r=a.player)==null||r.restoreStamina(100),this.cooldowns.clear()},reducedStun10:()=>{},stunCap:a=>{var r;(r=a.player)==null||r.setMaxStunDuration(500)},losingBuff:a=>{this.addTempModifier("all",30,100)},autoBlock:()=>{this.oneTimeUsed.has("autoBlock")||(this.emit("autoBlockGoal"),this.oneTimeUsed.add("autoBlock"))},knockbackImmune:()=>{},ballMagnet:a=>{var r;if(a.ball&&!((r=a.player)!=null&&r.hasBall)){const l=p.Math.Distance.Between(a.player.x,a.player.y,a.ball.x,a.ball.y);l<100&&l>20&&a.ball.applyMagnet(a.player.x,a.player.y,.02)}},iceTurfEffect:a=>{this.emit("iceTurfActive")},speedTrail:a=>{var r;(r=a.player)!=null&&r.isMoving&&this.emit("createSpeedTrail",a.position)},warmUpBuff:a=>{},coolDownBuff:a=>{},teammateBuff:a=>{const r=this.countNearbyTeammates(a);this.addTempModifier("all",r*5,100)},teamPress:a=>{var r;(r=a.player)!=null&&r.isPressing&&this.emit("teammatesPress")},randomEffects:()=>{},lowStaminaSpeed:a=>{var r;((r=a.player)==null?void 0:r.stamina)<30&&this.addTempModifier("attackSpeed",100,100)},avatarMode:a=>{this.addTempModifier("all",100,100)},halfTimeStamina:()=>{},carrySpeed:()=>{},guaranteedGoal:()=>{this.oneTimeUsed.has("guaranteedGoal")||this.emit("guaranteedGoal")},receiveeControl:()=>{},homeHalfSpeed:a=>{a.position&&a.position.x<600&&this.addTempModifier("speed",8,100)},unlimitedStamina:()=>{},timeRewind:()=>{this.oneTimeUsed.has("timeRewind")||(this.emit("timeRewind"),this.oneTimeUsed.add("timeRewind"))},goldenBoost:()=>{},default:()=>{}},n=i[s]||i.default;return{upgradeId:e.id,hook:t,callback:n}}trigger(e,t){(this.effects.get(e)||[]).forEach(i=>{try{i.callback(t)}catch(n){console.warn(`Error in upgrade effect ${i.upgradeId}:`,n)}})}getModifiedStat(e,t){let s=this.statModifiers.get(t)||0;const i=this.tempModifiers.get(t)||[],n=this.scene.time.now;return i.forEach(a=>{a.expiresAt>n&&(s+=a.value)}),this.tempModifiers.set(t,i.filter(a=>a.expiresAt>n)),e*(1+s/100)}getAllModifiers(){const e={};return this.statModifiers.forEach((t,s)=>{e[s]=t}),e}addTempModifier(e,t,s){const i=this.tempModifiers.get(e)||[];i.push({value:t,expiresAt:this.scene.time.now+s}),this.tempModifiers.set(e,i)}isOnCooldown(e){const t=this.cooldowns.get(e);return t!==void 0&&t>this.scene.time.now}setCooldown(e,t){const s=this.statModifiers.get("cooldowns")||0,i=t*(1+s/100);this.cooldowns.set(e,this.scene.time.now+i)}getSynergyCount(e){return this.synergyBonuses.get(e)||0}isSynergyActive(e){return this.getSynergyCount(e)>=3}getActiveSynergies(){const e=[];return this.synergyBonuses.forEach((t,s)=>{t>=3&&e.push(s)}),e}getOwnedUpgradeIds(){return this.ownedUpgrades.map(e=>e.id)}getOwnedUpgrades(){return[...this.ownedUpgrades]}hasUpgrade(e){return this.ownedUpgrades.some(t=>t.id===e)}isInOpenSpace(e){return!0}isInCircle(e){return e.x<150||e.x>1050}checkTriangleFormation(e){return!0}countNearbyTeammates(e){return 1}reset(){this.ownedUpgrades=[],this.effects.forEach(e=>e.length=0),this.statModifiers.clear(),this.tempModifiers.clear(),this.synergyBonuses.clear(),this.stacks.clear(),this.cooldowns.clear(),this.oneTimeUsed.clear()}resetMoment(){this.oneTimeUsed.delete("autoBlock"),this.oneTimeUsed.delete("guaranteedGoal")}}const C={wetTurf:{id:"wetTurf",name:"Wet Turf",description:"Slippery surface, reduced control",effect:"reducedControl"},pressIntense:{id:"pressIntense",name:"Intense Press",description:"Enemies press aggressively",effect:"aggressiveAI"},pcExpert:{id:"pcExpert",name:"PC Experts",description:"Enemy has deadly penalty corners",effect:"strongPC"},starPlayer:{id:"starPlayer",name:"Star Player",description:"One elite enemy with enhanced abilities",effect:"eliteEnemy"},shortTime:{id:"shortTime",name:"Short Time",description:"Less time to complete objective",effect:"reducedTime"},extraGoals:{id:"extraGoals",name:"High Score",description:"Need more goals to win",effect:"extraGoals"},outnumbered:{id:"outnumbered",name:"Outnumbered",description:"Face more enemies",effect:"moreEnemies"},noSaves:{id:"noSaves",name:"No Goalie",description:"Play without a goalkeeper",effect:"noGoalie"}},H=[{id:"scoreOne",name:"Quick Goal",description:"Score 1 goal to win",objective:"score",duration:45,targetScore:1,isBoss:!1,difficulty:1,teamSize:{player:4,enemy:3},modifiers:[]},{id:"scoreTwo",name:"Double Trouble",description:"Score 2 goals to win",objective:"multiGoal",duration:60,targetScore:2,isBoss:!1,difficulty:2,teamSize:{player:4,enemy:4},modifiers:[]},{id:"defendLead",name:"Hold the Line",description:"Defend your 1-goal lead for 40s",objective:"defend",duration:40,defendScore:1,isBoss:!1,difficulty:2,teamSize:{player:4,enemy:4},modifiers:[]},{id:"survival2v3",name:"Survival Mode",description:"Don't concede in a 2v3 for 30s",objective:"survive",duration:30,isBoss:!1,difficulty:3,teamSize:{player:2,enemy:3},modifiers:[C.outnumbered]},{id:"penaltyCornerBasic",name:"Penalty Corner",description:"Score from 3 penalty corner attempts",objective:"penaltyCorner",duration:45,targetScore:1,isBoss:!1,difficulty:2,teamSize:{player:5,enemy:5},modifiers:[]},{id:"turnoverChallenge",name:"Win It Back",description:"Steal the ball within 20s",objective:"turnover",duration:20,isBoss:!1,difficulty:2,teamSize:{player:3,enemy:3},modifiers:[]},{id:"reboundGoal",name:"Rebound Hunter",description:"Score a rebound goal",objective:"reboundGoal",duration:50,targetScore:1,isBoss:!1,difficulty:3,teamSize:{player:4,enemy:4},modifiers:[]},{id:"assistGoal",name:"Team Play",description:"Score a goal from an assist",objective:"assist",duration:45,targetScore:1,isBoss:!1,difficulty:2,teamSize:{player:4,enemy:3},modifiers:[]},{id:"quickScore",name:"Speed Run",description:"Score 1 goal in 30s",objective:"score",duration:30,targetScore:1,isBoss:!1,difficulty:3,teamSize:{player:4,enemy:4},modifiers:[C.shortTime]},{id:"wetDefend",name:"Rainy Defense",description:"Defend a lead on wet turf",objective:"defend",duration:35,defendScore:1,isBoss:!1,difficulty:3,teamSize:{player:4,enemy:4},modifiers:[C.wetTurf]},{id:"threeGoals",name:"Hat Trick",description:"Score 3 goals to win",objective:"multiGoal",duration:75,targetScore:3,isBoss:!1,difficulty:4,teamSize:{player:4,enemy:5},modifiers:[C.extraGoals]},{id:"noGoalieSurvive",name:"Open Goal",description:"Survive 25s without a goalie",objective:"survive",duration:25,isBoss:!1,difficulty:4,teamSize:{player:3,enemy:4},modifiers:[C.noSaves]},{id:"giveAndGo",name:"Give and Go",description:"Pass, receive, then score in one play",objective:"giveAndGo",duration:50,targetScore:1,isBoss:!1,difficulty:3,teamSize:{player:4,enemy:3},modifiers:[]},{id:"holdPossession",name:"Keep Ball",description:"Hold possession for 25 seconds total",objective:"possession",duration:50,isBoss:!1,difficulty:3,teamSize:{player:4,enemy:4},modifiers:[]},{id:"pressWin",name:"Press Win",description:"Force 2 turnovers in 40 seconds",objective:"pressWin",duration:40,isBoss:!1,difficulty:3,teamSize:{player:4,enemy:3},modifiers:[C.pressIntense]},{id:"protectInjector",name:"Protect the Injector",description:"Survive intense pressure for 35s",objective:"survive",duration:35,isBoss:!1,difficulty:4,teamSize:{player:3,enemy:5},modifiers:[C.pressIntense,C.outnumbered]},{id:"pcBattle",name:"PC Battle",description:"Win the penalty corner duel (score first in 3 PCs)",objective:"pcBattle",duration:60,targetScore:1,isBoss:!1,difficulty:3,teamSize:{player:5,enemy:5},modifiers:[]},{id:"bossPressMachine",name:"The Press Machine",description:"Face a team that never stops pressing",objective:"score",duration:60,targetScore:2,isBoss:!0,bossType:"pressMachine",difficulty:4,teamSize:{player:4,enemy:5},modifiers:[C.pressIntense]},{id:"bossPCMonster",name:"PC Monster Team",description:"Survive vs elite penalty corner specialists",objective:"defend",duration:50,defendScore:2,isBoss:!0,bossType:"pcMonster",difficulty:4,teamSize:{player:5,enemy:5},modifiers:[C.pcExpert]},{id:"bossStarForward",name:"Star Forward",description:"Stop the elite striker with dodge and killer shot",objective:"survive",duration:45,isBoss:!0,bossType:"starForward",difficulty:5,teamSize:{player:4,enemy:4},modifiers:[C.starPlayer]},{id:"bossRainGame",name:"Rain Game",description:"Score 2 goals on wet, slippery turf",objective:"multiGoal",duration:70,targetScore:2,isBoss:!0,bossType:"rainGame",difficulty:4,teamSize:{player:4,enemy:4},modifiers:[C.wetTurf]}];function de(){return H.filter(g=>!g.isBoss)}function he(){return H.filter(g=>g.isBoss)}function me(g=10){const o=de(),e=he(),t=[];for(let s=0;s<g;s++)if((s+1)%3===0&&e.length>0){const i=Math.floor(Math.random()*e.length);t.push(e[i])}else{const i=Math.min(1+Math.floor(s/2),4),n=o.filter(a=>a.difficulty<=i+1&&a.difficulty>=i-1);if(n.length>0){const a=Math.floor(Math.random()*n.length);t.push(n[a])}else t.push(o[Math.floor(Math.random()*o.length)])}return t}class fe extends p.Events.EventEmitter{constructor(e){super();c(this,"scene");c(this,"moments",[]);c(this,"currentMomentIndex",0);c(this,"currentState");c(this,"timer");c(this,"tickTimer");c(this,"runStats",{momentsWon:0,momentsLost:0,goalsScored:0,goalsConceded:0,reboundGoals:0,cleanSheets:0,bossesBeaten:0});this.scene=e}startRun(e=10){this.moments=me(e),this.currentMomentIndex=0,this.runStats={momentsWon:0,momentsLost:0,goalsScored:0,goalsConceded:0,reboundGoals:0,cleanSheets:0,bossesBeaten:0},this.emit("runStarted",{totalMoments:this.moments.length})}getCurrentMoment(){return this.moments[this.currentMomentIndex]}getCurrentState(){return this.currentState}startMoment(){const e=this.getCurrentMoment();if(!e)return;let t=0,s=0,i=1;switch(e.objective){case"score":i=e.targetScore||1;break;case"multiGoal":i=e.targetScore||2;break;case"defend":t=e.defendScore||1,i=0;break;case"survive":i=0;break;case"penaltyCorner":i=e.targetScore||1;break;case"turnover":i=1;break;case"reboundGoal":i=1;break;case"assist":i=1;break}this.currentState={definition:e,timeRemaining:e.duration,playerScore:t,enemyScore:s,isComplete:!1,isWon:!1,objectiveProgress:0,objectiveTarget:i},this.startTimer(),this.emit("momentStarted",{moment:e,momentNumber:this.currentMomentIndex+1,totalMoments:this.moments.length,state:this.currentState}),e.modifiers.forEach(n=>{this.emit("modifierApplied",n)})}startTimer(){this.timer=this.scene.time.addEvent({delay:1e3,callback:()=>this.tick(),loop:!0}),this.tickTimer=this.scene.time.addEvent({delay:100,callback:()=>this.emit("gameTick"),loop:!0})}tick(){!this.currentState||this.currentState.isComplete||(this.currentState.timeRemaining--,this.emit("timerTick",{remaining:this.currentState.timeRemaining,total:this.currentState.definition.duration}),this.currentState.timeRemaining<=0&&this.checkCompletion(),this.currentState.timeRemaining<=10&&this.currentState.timeRemaining>0&&this.emit("timerWarning",this.currentState.timeRemaining))}playerScored(e=!1,t=!1){if(!(!this.currentState||this.currentState.isComplete)){switch(this.currentState.playerScore++,this.runStats.goalsScored++,e&&this.runStats.reboundGoals++,this.currentState.definition.objective){case"score":case"multiGoal":this.currentState.objectiveProgress++;break;case"reboundGoal":e&&this.currentState.objectiveProgress++;break;case"assist":t&&this.currentState.objectiveProgress++;break;case"penaltyCorner":this.currentState.objectiveProgress++;break}this.emit("playerScored",{score:this.currentState.playerScore,isRebound:e,isFromAssist:t}),this.checkCompletion()}}enemyScored(){!this.currentState||this.currentState.isComplete||(this.currentState.enemyScore++,this.runStats.goalsConceded++,this.emit("enemyScored",{score:this.currentState.enemyScore}),this.checkCompletion())}playerStole(){!this.currentState||this.currentState.isComplete||(this.currentState.definition.objective==="turnover"&&(this.currentState.objectiveProgress++,this.checkCompletion()),this.emit("playerStole"))}checkCompletion(){if(!this.currentState||this.currentState.isComplete)return;const e=this.currentState,t=e.definition;let s=!1,i=!1;switch(t.objective){case"score":case"multiGoal":case"penaltyCorner":case"reboundGoal":case"assist":e.objectiveProgress>=e.objectiveTarget&&(s=!0,i=!0),e.timeRemaining<=0&&(s=!0,i=e.objectiveProgress>=e.objectiveTarget);break;case"defend":e.enemyScore>=e.playerScore&&(s=!0,i=!1),e.timeRemaining<=0&&(s=!0,i=e.playerScore>e.enemyScore);break;case"survive":e.enemyScore>0&&(s=!0,i=!1),e.timeRemaining<=0&&(s=!0,i=e.enemyScore===0);break;case"turnover":e.objectiveProgress>=e.objectiveTarget&&(s=!0,i=!0),e.timeRemaining<=0&&(s=!0,i=!1);break}s&&this.completeMoment(i)}completeMoment(e){var t,s;this.currentState&&(this.currentState.isComplete=!0,this.currentState.isWon=e,(t=this.timer)==null||t.destroy(),(s=this.tickTimer)==null||s.destroy(),e?(this.runStats.momentsWon++,this.currentState.enemyScore===0&&this.runStats.cleanSheets++,this.currentState.definition.isBoss&&(this.runStats.bossesBeaten++,b.getInstance().addUniqueToStat("uniqueBossesDefeated",this.currentState.definition.bossType||"unknown"))):this.runStats.momentsLost++,this.emit("momentComplete",{isWon:e,state:this.currentState,momentNumber:this.currentMomentIndex+1,isBoss:this.currentState.definition.isBoss}))}nextMoment(){return this.currentMomentIndex++,this.currentMomentIndex>=this.moments.length?(this.endRun(),!1):!0}endRun(){const t=this.runStats.momentsWon*15,s=this.runStats.bossesBeaten*50,i=this.runStats.cleanSheets*10,n=this.runStats.goalsScored*5,a=50+t+s+i+n,l=b.getInstance().getMetaUpgradeLevel("bonusGems")*5,d=Math.floor(a*(1+l/100)),h=b.getInstance();h.incrementStat("totalRuns"),h.incrementStat("totalMomentsWon",this.runStats.momentsWon),h.incrementStat("totalMomentsLost",this.runStats.momentsLost),h.incrementStat("totalGoals",this.runStats.goalsScored),h.incrementStat("totalBossWins",this.runStats.bossesBeaten),h.incrementStat("cleanSheets",this.runStats.cleanSheets),h.incrementStat("totalReboundGoals",this.runStats.reboundGoals),h.addGems(d),this.emit("runComplete",{stats:this.runStats,reward:d,breakdown:{base:50,momentWins:t,bosses:s,cleanSheets:i,goals:n,bonus:d-a}})}getProgress(){return{current:this.currentMomentIndex+1,total:this.moments.length,percentComplete:(this.currentMomentIndex+1)/this.moments.length*100}}getRunStats(){return{...this.runStats}}isBossMoment(){var e;return((e=this.getCurrentMoment())==null?void 0:e.isBoss)||!1}getActiveModifiers(){var e;return((e=this.getCurrentMoment())==null?void 0:e.modifiers)||[]}destroy(){var e,t;(e=this.timer)==null||e.destroy(),(t=this.tickTimer)==null||t.destroy()}}class pe{constructor(o){c(this,"scene");c(this,"container");c(this,"timerText");c(this,"timerBg");c(this,"scoreText");c(this,"objectiveText");c(this,"momentText");c(this,"possessionIndicator");c(this,"possessionText");c(this,"cooldownContainer");c(this,"cooldownIcons",new Map);c(this,"upgradeContainer");c(this,"radarContainer");c(this,"radarBg");c(this,"radarDots",new Map);c(this,"radarScale",.12);c(this,"radarWidth",140);c(this,"radarHeight",80);c(this,"helpButton");c(this,"controlsOverlay");c(this,"controlsVisible",!1);c(this,"pauseOverlay");this.scene=o,this.container=o.add.container(0,0),this.container.setScrollFactor(0),this.container.setDepth(100)}createGameHUD(){const o=this.scene.cameras.main.width,e=this.scene.cameras.main.height;this.timerBg=this.scene.add.graphics(),this.timerBg.fillStyle(1710638,.8),this.timerBg.fillRoundedRect(o/2-60,10,120,50,10),this.timerBg.lineStyle(2,3447003,.8),this.timerBg.strokeRoundedRect(o/2-60,10,120,50,10),this.container.add(this.timerBg),this.timerText=this.scene.add.text(o/2,35,"0:00",{fontFamily:"Arial, sans-serif",fontSize:"28px",color:"#ffffff",fontStyle:"bold"}),this.timerText.setOrigin(.5),this.container.add(this.timerText),this.scoreText=this.scene.add.text(o/2,70,"0 - 0",{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#ecf0f1"}),this.scoreText.setOrigin(.5),this.container.add(this.scoreText),this.objectiveText=this.scene.add.text(o/2,100,"",{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#f1c40f",align:"center"}),this.objectiveText.setOrigin(.5),this.container.add(this.objectiveText),this.momentText=this.scene.add.text(20,20,"Moment 1/10",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#bdc3c7"}),this.container.add(this.momentText),this.possessionIndicator=this.scene.add.graphics(),this.container.add(this.possessionIndicator),this.possessionText=this.scene.add.text(o-20,20,"POSSESSION",{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#bdc3c7"}),this.possessionText.setOrigin(1,0),this.container.add(this.possessionText),this.cooldownContainer=this.scene.add.container(o/2,e-60),this.cooldownContainer.setScrollFactor(0),this.container.add(this.cooldownContainer),this.createCooldownIcons(),this.upgradeContainer=this.scene.add.container(20,150),this.upgradeContainer.setScrollFactor(0),this.container.add(this.upgradeContainer),this.createMiniRadar(),this.createHelpButton(),this.createControlsOverlay()}createCooldownIcons(){if(!this.cooldownContainer)return;const o=[{key:"shoot",label:"SPACE/Click",icon:"üèë"},{key:"pass",label:"E",icon:"üìê"},{key:"tackle",label:"Q",icon:"‚öîÔ∏è"},{key:"dodge",label:"SHIFT",icon:"üí®"}],e=70,t=-((o.length-1)*e)/2;o.forEach((s,i)=>{const n=t+i*e,a=this.scene.add.circle(n,0,25,2899536);a.setStrokeStyle(2,3447003),this.cooldownContainer.add(a);const r=this.scene.add.graphics();this.cooldownContainer.add(r);const l=this.scene.add.text(n,-5,s.icon,{fontSize:"20px"});l.setOrigin(.5),this.cooldownContainer.add(l);const d=this.scene.add.text(n,20,s.label,{fontFamily:"Arial, sans-serif",fontSize:"9px",color:"#bdc3c7"});d.setOrigin(.5),this.cooldownContainer.add(d),this.cooldownIcons.set(s.key,{bg:a,overlay:r,label:d})})}createMiniRadar(){const o=this.scene.cameras.main.width,e=this.scene.cameras.main.height;this.radarContainer=this.scene.add.container(o-this.radarWidth-15,e-this.radarHeight-100),this.radarContainer.setScrollFactor(0),this.container.add(this.radarContainer),this.radarBg=this.scene.add.graphics(),this.radarBg.fillStyle(1710638,.7),this.radarBg.fillRoundedRect(0,0,this.radarWidth,this.radarHeight,5),this.radarBg.lineStyle(1,3447003,.6),this.radarBg.strokeRoundedRect(0,0,this.radarWidth,this.radarHeight,5),this.radarBg.lineStyle(1,6710886,.4),this.radarBg.beginPath(),this.radarBg.moveTo(this.radarWidth/2,0),this.radarBg.lineTo(this.radarWidth/2,this.radarHeight),this.radarBg.strokePath(),this.radarBg.strokeCircle(this.radarWidth/2,this.radarHeight/2,8),this.radarContainer.add(this.radarBg);const t=this.scene.add.text(this.radarWidth/2,-8,"RADAR",{fontFamily:"Arial, sans-serif",fontSize:"9px",color:"#666666"});t.setOrigin(.5),this.radarContainer.add(t)}updateRadar(o,e,t,s){if(!this.radarContainer)return;this.radarDots.forEach(r=>r.destroy()),this.radarDots.clear();const i=1200,n=700,a=(r,l)=>({x:r/i*this.radarWidth,y:l/n*this.radarHeight});if(s){const r=a(s.x,s.y),l=this.scene.add.circle(r.x,r.y,3,16777215);this.radarContainer.add(l),this.radarDots.set("ball",l)}if(o){const r=a(o.x,o.y),l=this.scene.add.circle(r.x,r.y,4,2600544);this.radarContainer.add(l),this.radarDots.set("player",l)}e.forEach((r,l)=>{const d=a(r.x,r.y),h=this.scene.add.circle(d.x,d.y,3,3066993);this.radarContainer.add(h),this.radarDots.set(`teammate_${l}`,h)}),t.forEach((r,l)=>{const d=a(r.x,r.y),h=this.scene.add.circle(d.x,d.y,3,15158332);this.radarContainer.add(h),this.radarDots.set(`enemy_${l}`,h)})}createHelpButton(){const o=this.scene.cameras.main.width;this.helpButton=this.scene.add.container(o-30,60),this.helpButton.setScrollFactor(0),this.container.add(this.helpButton);const e=this.scene.add.circle(0,0,15,2899536);e.setStrokeStyle(2,3447003),e.setInteractive({useHandCursor:!0}),this.helpButton.add(e);const t=this.scene.add.text(0,0,"?",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#ffffff",fontStyle:"bold"});t.setOrigin(.5),this.helpButton.add(t),e.on("pointerdown",()=>{this.toggleControlsOverlay()}),e.on("pointerover",()=>{e.setFillStyle(3447003),this.scene.tweens.add({targets:this.helpButton,scaleX:1.1,scaleY:1.1,duration:100})}),e.on("pointerout",()=>{e.setFillStyle(2899536),this.scene.tweens.add({targets:this.helpButton,scaleX:1,scaleY:1,duration:100})})}createControlsOverlay(){const o=this.scene.cameras.main.width,e=this.scene.cameras.main.height;this.controlsOverlay=this.scene.add.container(0,0),this.controlsOverlay.setScrollFactor(0),this.controlsOverlay.setDepth(200),this.controlsOverlay.setVisible(!1);const t=this.scene.add.rectangle(o/2,e/2,o,e,0,.7);t.setInteractive(),t.on("pointerdown",()=>this.hideControlsOverlay()),this.controlsOverlay.add(t);const s=450,i=380,n=this.scene.add.graphics();n.fillStyle(1710638,.95),n.fillRoundedRect(o/2-s/2,e/2-i/2,s,i,15),n.lineStyle(3,3447003,1),n.strokeRoundedRect(o/2-s/2,e/2-i/2,s,i,15),this.controlsOverlay.add(n);const a=this.scene.add.text(o/2,e/2-i/2+30,"üéÆ CONTROLS",{fontFamily:"Arial, sans-serif",fontSize:"24px",color:"#ffffff",fontStyle:"bold"});a.setOrigin(.5),this.controlsOverlay.add(a);const r=[{key:"WASD / Arrows",action:"Move"},{key:"SPACE / Left Click",action:"Shoot (with ball) / Tackle intent"},{key:"E",action:"Pass to teammate"},{key:"Q",action:"Tackle (lunge to steal ball)"},{key:"SHIFT",action:"Dodge / Sidestep"},{key:"Mouse",action:"Aim direction"},{key:"ESC / P",action:"Pause game"},{key:"H",action:"Toggle this help"}],l=e/2-i/2+80;r.forEach((m,u)=>{const y=l+u*32,k=this.scene.add.graphics();k.fillStyle(2899536,1),k.fillRoundedRect(o/2-200,y-10,140,26,5),this.controlsOverlay.add(k);const w=this.scene.add.text(o/2-130,y,m.key,{fontFamily:"monospace",fontSize:"12px",color:"#3498db",fontStyle:"bold"});w.setOrigin(.5),this.controlsOverlay.add(w);const S=this.scene.add.text(o/2+30,y,m.action,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#ecf0f1"});S.setOrigin(0,.5),this.controlsOverlay.add(S)});const d=e/2+i/2-60,h=this.scene.add.text(o/2,d,"üí° TIP: Aim toward goal for auto-aim assist when using keyboard only",{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#f39c12",wordWrap:{width:s-40},align:"center"});h.setOrigin(.5),this.controlsOverlay.add(h);const f=this.scene.add.text(o/2,e/2+i/2-25,"[ Click anywhere to close ]",{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#7f8c8d"});f.setOrigin(.5),this.controlsOverlay.add(f)}toggleControlsOverlay(){this.controlsVisible?this.hideControlsOverlay():this.showControlsOverlay()}showControlsOverlay(){this.controlsOverlay&&(this.controlsOverlay.setVisible(!0),this.controlsVisible=!0,this.controlsOverlay.setAlpha(0),this.scene.tweens.add({targets:this.controlsOverlay,alpha:1,duration:200}))}hideControlsOverlay(){this.controlsOverlay&&this.scene.tweens.add({targets:this.controlsOverlay,alpha:0,duration:150,onComplete:()=>{this.controlsOverlay.setVisible(!1),this.controlsVisible=!1}})}isControlsVisible(){return this.controlsVisible}showFirstRunTutorial(o){const e=this.scene.cameras.main.width,t=this.scene.cameras.main.height,s=this.scene.add.container(0,0);s.setScrollFactor(0),s.setDepth(250);const i=this.scene.add.rectangle(e/2,t/2,e,t,0,.8);s.add(i);const n=500,a=350,r=this.scene.add.graphics();r.fillStyle(1710638,.95),r.fillRoundedRect(e/2-n/2,t/2-a/2,n,a,15),r.lineStyle(3,15965202,1),r.strokeRoundedRect(e/2-n/2,t/2-a/2,n,a,15),s.add(r);const l=this.scene.add.text(e/2,t/2-140,"üèë WELCOME TO STICK & SHIFT!",{fontFamily:"Arial, sans-serif",fontSize:"22px",color:"#f39c12",fontStyle:"bold"});l.setOrigin(.5),s.add(l);const d=this.scene.add.text(e/2,t/2-50,`QUICK CONTROLS:

‚¨ÜÔ∏è‚¨áÔ∏è‚¨ÖÔ∏è‚û°Ô∏è  WASD / Arrows = Move
üèë  SPACE / Click = Shoot
üìê  E = Pass
‚öîÔ∏è  Q = Tackle
üí®  SHIFT = Dodge`,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#ecf0f1",align:"center",lineSpacing:6});d.setOrigin(.5),s.add(d);const h=this.scene.add.graphics();h.fillStyle(2600544,1),h.fillRoundedRect(e/2-80,t/2+100,160,45,10),s.add(h);const f=this.scene.add.text(e/2,t/2+122,"LET'S GO!",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#ffffff",fontStyle:"bold"});f.setOrigin(.5),s.add(f);const m=this.scene.add.rectangle(e/2,t/2+122,160,45,0,0);m.setInteractive({useHandCursor:!0}),s.add(m),m.on("pointerdown",()=>{this.scene.tweens.add({targets:s,alpha:0,duration:200,onComplete:()=>{s.destroy(),o()}})}),m.on("pointerover",()=>{h.clear(),h.fillStyle(3066993,1),h.fillRoundedRect(e/2-80,t/2+100,160,45,10)}),m.on("pointerout",()=>{h.clear(),h.fillStyle(2600544,1),h.fillRoundedRect(e/2-80,t/2+100,160,45,10)}),this.scene.time.delayedCall(6e3,()=>{s.active&&this.scene.tweens.add({targets:s,alpha:0,duration:300,onComplete:()=>{s.active&&(s.destroy(),o())}})})}showMomentRecap(o,e){const t=this.scene.cameras.main.width,s=this.scene.cameras.main.height,i=this.scene.add.container(0,0);i.setScrollFactor(0),i.setDepth(180);const n=this.scene.add.rectangle(t/2,s/2,t,s,0,.6);i.add(n);const a=350,r=280,l=this.scene.add.graphics();l.fillStyle(1710638,.95),l.fillRoundedRect(t/2-a/2,s/2-r/2,a,r,12),l.lineStyle(2,3447003,1),l.strokeRoundedRect(t/2-a/2,s/2-r/2,a,r,12),i.add(l);const d=this.scene.add.text(t/2,s/2-r/2+25,"üìä MOMENT RECAP",{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#3498db",fontStyle:"bold"});d.setOrigin(.5),i.add(d);const h=[{label:"Goals",value:`${o.goalsScored} - ${o.goalsConceded}`},{label:"Shots",value:`${o.shotsOnTarget}/${o.shotsTaken}`},{label:"Passes",value:`${o.passesCompleted}/${o.passesAttempted}`},{label:"Tackles",value:`${o.tacklesWon} won`},{label:"Possession",value:`${Math.round(o.possessionTime/o.totalTime*100)}%`}],f=s/2-r/2+65;h.forEach((k,w)=>{const S=f+w*32,x=this.scene.add.text(t/2-100,S,k.label,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#bdc3c7"});i.add(x);const P=this.scene.add.text(t/2+100,S,k.value,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#ffffff",fontStyle:"bold"});P.setOrigin(1,0),i.add(P)});const m=this.scene.add.graphics();m.fillStyle(3447003,1),m.fillRoundedRect(t/2-70,s/2+r/2-55,140,40,8),i.add(m);const u=this.scene.add.text(t/2,s/2+r/2-35,"CONTINUE",{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#ffffff",fontStyle:"bold"});u.setOrigin(.5),i.add(u);const y=this.scene.add.rectangle(t/2,s/2+r/2-35,140,40,0,0);y.setInteractive({useHandCursor:!0}),i.add(y),y.on("pointerdown",()=>{i.destroy(),e()}),y.on("pointerover",()=>{m.clear(),m.fillStyle(2719929,1),m.fillRoundedRect(t/2-70,s/2+r/2-55,140,40,8)}),y.on("pointerout",()=>{m.clear(),m.fillStyle(3447003,1),m.fillRoundedRect(t/2-70,s/2+r/2-55,140,40,8)}),i.setAlpha(0),this.scene.tweens.add({targets:i,alpha:1,duration:300})}updateTimer(o,e){if(!this.timerText||!this.timerBg)return;const t=Math.floor(o/60),s=o%60;this.timerText.setText(`${t}:${s.toString().padStart(2,"0")}`),o<=10?(this.timerText.setColor("#e74c3c"),o>0&&this.scene.tweens.add({targets:this.timerText,scaleX:1.2,scaleY:1.2,duration:100,yoyo:!0})):o<=30?this.timerText.setColor("#f39c12"):this.timerText.setColor("#ffffff")}updateScore(o,e){this.scoreText&&(this.scoreText.setText(`${o} - ${e}`),this.scene.tweens.add({targets:this.scoreText,scaleX:1.3,scaleY:1.3,duration:150,yoyo:!0}))}updateObjective(o){this.objectiveText&&this.objectiveText.setText(o)}updateMomentCounter(o,e,t=!1){if(!this.momentText)return;const s=t?"‚ö†Ô∏è BOSS - ":"";this.momentText.setText(`${s}Moment ${o}/${e}`),t?this.momentText.setColor("#e74c3c"):this.momentText.setColor("#bdc3c7")}updatePossession(o){if(!this.possessionIndicator||!this.possessionText)return;const e=this.scene.cameras.main.width;this.possessionIndicator.clear(),this.possessionIndicator.fillStyle(o?2600544:15158332,1),this.possessionIndicator.fillCircle(e-40,45,10),this.possessionText.setText(o?"YOUR BALL":"ENEMY BALL"),this.possessionText.setColor(o?"#27ae60":"#e74c3c")}updateCooldown(o,e){const t=this.cooldownIcons.get(o);if(!t)return;const{bg:s,overlay:i}=t;i.clear(),e>0&&e<1&&(i.fillStyle(0,.7),i.slice(s.x,s.y,25,p.Math.DegToRad(-90),p.Math.DegToRad(-90+360*(1-e)),!0),i.fillPath()),e===0?(s.setFillStyle(2899536),s.setStrokeStyle(2,3447003)):(s.setFillStyle(1710618),s.setStrokeStyle(2,8359053))}updateFromMomentState(o,e,t){this.updateTimer(o.timeRemaining,o.definition.duration),this.updateScore(o.playerScore,o.enemyScore),this.updateMomentCounter(e,t,o.definition.isBoss);let s="";switch(o.definition.objective){case"score":s=`Score ${o.objectiveTarget} goal${o.objectiveTarget>1?"s":""} (${o.objectiveProgress}/${o.objectiveTarget})`;break;case"multiGoal":s=`Score ${o.objectiveTarget} goals (${o.objectiveProgress}/${o.objectiveTarget})`;break;case"defend":s="Defend your lead!";break;case"survive":s="Don't concede!";break;case"penaltyCorner":s=`Score from penalty corner (${o.objectiveProgress}/${o.objectiveTarget})`;break;case"turnover":s="Win the ball back!";break;case"reboundGoal":s=`Score a rebound goal (${o.objectiveProgress}/${o.objectiveTarget})`;break;case"assist":s=`Score from an assist (${o.objectiveProgress}/${o.objectiveTarget})`;break;case"giveAndGo":s=`Give-and-go goal (${o.objectiveProgress}/${o.objectiveTarget})`;break;case"possession":s=`Hold possession: ${Math.round(o.objectiveProgress)}s / ${o.objectiveTarget}s`;break;case"pressWin":s=`Force turnovers (${o.objectiveProgress}/${o.objectiveTarget})`;break}this.updateObjective(s)}addUpgradeIcon(o,e){if(!this.upgradeContainer)return;const s=this.upgradeContainer.length*35,i=this.scene.add.circle(15,s,15,1710638,.8);i.setStrokeStyle(1,3447003),this.upgradeContainer.add(i);const n=this.scene.add.text(15,s,o,{fontSize:"16px"});n.setOrigin(.5),this.upgradeContainer.add(n),i.setInteractive(),i.on("pointerover",()=>{})}showGoalNotification(o){const e=o?"‚öΩ GOAL!":"üòû CONCEDED",t=o?"#27ae60":"#e74c3c",s=this.scene.add.text(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY,e,{fontFamily:"Arial, sans-serif",fontSize:"64px",color:t,fontStyle:"bold",stroke:"#000000",strokeThickness:6});s.setOrigin(.5),s.setScrollFactor(0),s.setDepth(150),s.setScale(0),this.scene.tweens.add({targets:s,scaleX:1,scaleY:1,duration:300,ease:"Back.easeOut",onComplete:()=>{this.scene.tweens.add({targets:s,alpha:0,y:s.y-50,duration:500,delay:500,onComplete:()=>s.destroy()})}})}showNoPossessionFeedback(){const o=this.scene.add.text(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY+100,"No ball!",{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#e74c3c",stroke:"#000000",strokeThickness:3});o.setOrigin(.5),o.setScrollFactor(0),o.setDepth(120),this.scene.tweens.add({targets:o,alpha:0,y:o.y-30,duration:600,onComplete:()=>o.destroy()})}showMomentComplete(o){const e=this.scene.add.rectangle(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY,this.scene.cameras.main.width,this.scene.cameras.main.height,o?2600544:15158332,.3);e.setScrollFactor(0),e.setDepth(140);const t=this.scene.add.text(this.scene.cameras.main.centerX,this.scene.cameras.main.centerY,o?"‚úì MOMENT WON!":"‚úó MOMENT LOST",{fontFamily:"Arial, sans-serif",fontSize:"48px",color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:4});t.setOrigin(.5),t.setScrollFactor(0),t.setDepth(141),t.setScale(0),this.scene.tweens.add({targets:t,scaleX:1,scaleY:1,duration:400,ease:"Back.easeOut"}),this.scene.time.delayedCall(1500,()=>{this.scene.tweens.add({targets:[e,t],alpha:0,duration:300,onComplete:()=>{e.destroy(),t.destroy()}})})}destroy(){var o;this.container.destroy(),this.cooldownIcons.clear(),this.radarDots.clear(),(o=this.controlsOverlay)==null||o.destroy()}}class ue{constructor(o){c(this,"scene");c(this,"emitters",new Map);this.scene=o}init(){this.createSprintEmitter(),this.createDustEmitter(),this.createConfettiEmitter(),this.createStarEmitter(),this.createBurstEmitter()}createSprintEmitter(){const o=this.scene.add.particles(0,0,"particle_sprint",{speed:{min:20,max:50},scale:{start:.5,end:0},alpha:{start:.6,end:0},lifespan:300,blendMode:"ADD",frequency:-1});o.setDepth(5),this.emitters.set("sprint",o)}createDustEmitter(){const o=this.scene.add.particles(0,0,"particle_dust",{speed:{min:30,max:80},angle:{min:-150,max:-30},scale:{start:.8,end:.2},alpha:{start:.7,end:0},lifespan:400,gravityY:100,frequency:-1});o.setDepth(4),this.emitters.set("dust",o)}createConfettiEmitter(){for(let o=0;o<6;o++){const e=this.scene.add.particles(0,0,`confetti_${o}`,{speed:{min:100,max:300},angle:{min:-120,max:-60},scale:{start:1.5,end:.5},alpha:{start:1,end:.5},rotate:{min:0,max:360},lifespan:2e3,gravityY:200,frequency:-1});e.setDepth(100),this.emitters.set(`confetti_${o}`,e)}}createStarEmitter(){const o=this.scene.add.particles(0,0,"particle_star",{speed:{min:50,max:150},scale:{start:.8,end:0},alpha:{start:1,end:0},rotate:{min:0,max:360},lifespan:600,frequency:-1});o.setDepth(50),this.emitters.set("star",o)}createBurstEmitter(){const o=this.scene.add.particles(0,0,"particle_burst",{speed:{min:100,max:200},scale:{start:.5,end:0},alpha:{start:1,end:0},lifespan:300,blendMode:"ADD",frequency:-1});o.setDepth(50),this.emitters.set("burst",o)}emitSprint(o,e,t,s){const i=this.emitters.get("sprint");i&&(i.setPosition(o,e),i.setParticleSpeed(-t*.3,-s*.3),i.emitParticle(1))}emitDust(o,e,t=5){const s=this.emitters.get("dust");s&&(s.setPosition(o,e),s.emitParticle(t))}emitConfetti(o,e,t=50){const s=Math.ceil(t/6);for(let i=0;i<6;i++){const n=this.emitters.get(`confetti_${i}`);n&&(n.setPosition(o,e),n.emitParticle(s))}}emitStars(o,e,t=8){const s=this.emitters.get("star");s&&(s.setPosition(o,e),s.emitParticle(t))}emitBurst(o,e,t=6){const s=this.emitters.get("burst");s&&(s.setPosition(o,e),s.emitParticle(t))}goalCelebration(o,e){[0,100,200].forEach((i,n)=>{this.scene.time.delayedCall(i,()=>{this.emitConfetti(o+(n-1)*50,e,30),this.emitStars(o,e,5)})}),this.emitBurst(o,e,10),this.scene.cameras.main.shake(200,.01);const s=this.scene.add.image(o,e,"effect_goal");s.setAlpha(.8),s.setScale(.5),s.setDepth(90),s.setBlendMode(p.BlendModes.ADD),this.scene.tweens.add({targets:s,scale:3,alpha:0,duration:500,ease:"Power2",onComplete:()=>s.destroy()})}tackleImpact(o,e){this.emitDust(o,e,8),this.emitBurst(o,e,4);const t=this.scene.add.image(o,e,"effect_tackle");t.setAlpha(.8),t.setScale(.5),t.setDepth(45),this.scene.tweens.add({targets:t,scale:1.5,alpha:0,rotation:Math.PI/4,duration:300,ease:"Power2",onComplete:()=>t.destroy()}),this.scene.cameras.main.shake(100,.005)}dodgeEffect(o,e,t){const s=this.scene.add.image(o,e,"effect_dodge");s.setAlpha(.7),s.setRotation(t),s.setDepth(44),this.scene.tweens.add({targets:s,alpha:0,scale:1.5,duration:250,ease:"Power2",onComplete:()=>s.destroy()})}powerUpEffect(o,e){this.emitStars(o,e,12);const t=this.scene.add.graphics();t.lineStyle(4,15844367,1),t.strokeCircle(0,0,10),t.setPosition(o,e),t.setDepth(50),this.scene.tweens.add({targets:t,scaleX:3,scaleY:3,alpha:0,duration:400,ease:"Power2",onComplete:()=>t.destroy()})}destroy(){this.emitters.forEach(o=>o.destroy()),this.emitters.clear()}}class ge extends p.GameObjects.Ellipse{constructor(e,t,s,i="speed"){let n=16777215,a=16,r=8;switch(i){case"speed":n=3447003,a=20,r=10;break;case"dodge":n=4774907,a=24,r=12;break;case"power":n=15844367,a=18,r=8;break}super(e,t,s,a,r,n,.6);c(this,"age",0);c(this,"maxAge");c(this,"fadeSpeed");this.maxAge=300,this.fadeSpeed=1/this.maxAge,e.add.existing(this),this.setDepth(5)}update(e){this.age+=e;const t=1-this.age/this.maxAge;return this.setAlpha(t*.6),this.setScale(t),this.age>=this.maxAge?(this.destroy(),!1):!0}}class ye{constructor(o){c(this,"scene");c(this,"trails",[]);c(this,"lastSpawnTime",0);c(this,"spawnInterval",30);this.scene=o}spawn(o,e,t="speed"){const s=this.scene.time.now;if(s-this.lastSpawnTime<this.spawnInterval)return;this.lastSpawnTime=s;const i=new ge(this.scene,o,e,t);this.trails.push(i)}update(o){this.trails=this.trails.filter(e=>e.update(o))}clear(){this.trails.forEach(o=>o.destroy()),this.trails=[]}setSpawnInterval(o){this.spawnInterval=o}}class Ie extends p.GameObjects.Zone{constructor(e,t,s){super(e,t,s,60,40);c(this,"visual");c(this,"lifespan",3e3);c(this,"age",0);e.add.existing(this),e.physics.add.existing(this,!0),this.visual=e.add.ellipse(t,s,60,40,3447003,.3),this.visual.setStrokeStyle(2,6139362,.5),this.visual.setDepth(3)}update(e){this.age+=e;const t=1+Math.sin(this.age*.01)*.1;if(this.visual.setScale(t),this.age>this.lifespan*.7){const s=(this.lifespan-this.age)/(this.lifespan*.3);this.visual.setAlpha(s*.3)}return this.age>=this.lifespan?(this.visual.destroy(),this.destroy(),!1):!0}applyBoost(e){}}const E={common:10395294,uncommon:5025616,rare:2201331,epic:10233776,legendary:16750592},Se={common:50,uncommon:30,rare:15,epic:4,legendary:1},Y={dragFlick:"Drag Flick",press:"Press",trianglePassing:"Triangle Passing",rebound:"Rebound",trickster:"Trickster",tank:"Tank",speedster:"Speedster",vampire:"Vampire",chaos:"Chaos",precision:"Precision",guardian:"Guardian",berserker:"Berserker",counterPress:"Counter-Press",possession:"Possession",sweeper:"Sweeper-Keeper",weather:"Weather Master",poacher:"Poacher",aerial:"Aerial Threat"},ke={dragFlick:16739179,press:16697943,trianglePassing:4774907,rebound:16752627,trickster:53971,tank:5727604,speedster:5546239,vampire:9109504,chaos:10181046,precision:1092740,guardian:15965202,berserker:15158332,counterPress:16742005,possession:7649791,sweeper:6516338,weather:8514796,poacher:16632686,aerial:10656766},we=[{id:"quickFeet",name:"Quick Feet",description:"+10% movement speed",rarity:"common",synergies:["speedster"],hooks:["passive"],modifiers:[{stat:"speed",value:10,isPercent:!0}],effectId:"speedBoost10",icon:"üëü",maxStacks:3},{id:"strongStick",name:"Strong Stick",description:"+15% shot power",rarity:"common",synergies:["dragFlick"],hooks:["passive"],modifiers:[{stat:"shotPower",value:15,isPercent:!0}],effectId:"shotPowerBoost15",icon:"üèë",maxStacks:3},{id:"softHands",name:"Soft Hands",description:"+15% ball control",rarity:"common",synergies:["trickster"],hooks:["passive"],modifiers:[{stat:"control",value:15,isPercent:!0}],effectId:"controlBoost15",icon:"ü§≤",maxStacks:3},{id:"tackleTraining",name:"Tackle Training",description:"+15% tackle success",rarity:"common",synergies:["press"],hooks:["passive"],modifiers:[{stat:"tackle",value:15,isPercent:!0}],effectId:"tackleBoost15",icon:"‚öîÔ∏è",maxStacks:3},{id:"passingDrills",name:"Passing Drills",description:"+15% pass accuracy",rarity:"common",synergies:["trianglePassing"],hooks:["passive"],modifiers:[{stat:"passPower",value:15,isPercent:!0}],effectId:"passBoost15",icon:"üìê",maxStacks:3},{id:"staminaPack",name:"Stamina Pack",description:"+20% max stamina",rarity:"common",synergies:["speedster"],hooks:["passive"],modifiers:[{stat:"stamina",value:20,isPercent:!0}],effectId:"staminaBoost20",icon:"üí™",maxStacks:3},{id:"nimbleDodge",name:"Nimble Dodge",description:"+10% dodge distance",rarity:"common",synergies:["trickster"],hooks:["passive"],modifiers:[{stat:"dodge",value:10,isPercent:!0}],effectId:"dodgeBoost10",icon:"üí®",maxStacks:3},{id:"turfGrip",name:"Turf Grip",description:"+8% speed on your half",rarity:"common",synergies:["guardian"],hooks:["onTick"],modifiers:[],effectId:"homeHalfSpeed",icon:"üå±"},{id:"warmUp",name:"Warm Up",description:"+10% all stats for first 10s of moment",rarity:"common",synergies:["press"],hooks:["onMomentStart","onTick"],modifiers:[],effectId:"warmUpBuff",icon:"üî•"},{id:"coolDown",name:"Cool Down",description:"+10% all stats in last 10s of moment",rarity:"common",synergies:["precision"],hooks:["onTick"],modifiers:[],effectId:"coolDownBuff",icon:"‚ùÑÔ∏è"},{id:"reboundReady",name:"Rebound Ready",description:"+20% shot power on rebound attempts",rarity:"common",synergies:["rebound"],hooks:["onShot"],modifiers:[],effectId:"reboundShotPower",icon:"üîÑ"},{id:"pressTrigger",name:"Press Trigger",description:"+5% speed when enemy has ball",rarity:"common",synergies:["press"],hooks:["onTick"],modifiers:[],effectId:"pressSpeed",icon:"üéØ",maxStacks:3},{id:"thickSkin",name:"Thick Skin",description:"-10% stun duration from tackles",rarity:"common",synergies:["tank"],hooks:["onDamage"],modifiers:[],effectId:"reducedStun10",icon:"üõ°Ô∏è",maxStacks:3},{id:"quickRecovery",name:"Quick Recovery",description:"-15% skill cooldowns",rarity:"common",synergies:["speedster"],hooks:["passive"],modifiers:[{stat:"cooldowns",value:-15,isPercent:!0}],effectId:"reducedCooldowns",icon:"‚è±Ô∏è",maxStacks:2},{id:"firstTouch",name:"First Touch",description:"+20% control when receiving passes",rarity:"common",synergies:["trianglePassing"],hooks:["onReceive"],modifiers:[],effectId:"receiveControl",icon:"‚úã"},{id:"hardHitter",name:"Hard Hitter",description:"Shots cause brief slowdown on goalie",rarity:"common",synergies:["dragFlick"],hooks:["onShot"],modifiers:[],effectId:"goalieSlowdown",icon:"üí•"},{id:"spaceFinder",name:"Space Finder",description:"+10% speed when no enemies nearby",rarity:"common",synergies:["speedster"],hooks:["onTick"],modifiers:[],effectId:"openSpaceSpeed",icon:"üåå"},{id:"teamPlayer",name:"Team Player",description:"+5% all stats per nearby teammate",rarity:"common",synergies:["trianglePassing"],hooks:["onTick"],modifiers:[],effectId:"teammateBuff",icon:"ü§ù",maxStacks:2},{id:"adrenaline",name:"Adrenaline",description:"+15% speed for 2s after dodge",rarity:"common",synergies:["trickster"],hooks:["onDodge"],modifiers:[],effectId:"dodgeSpeedBurst",icon:"‚ö°"},{id:"persistence",name:"Persistence",description:"+2% tackle success per failed tackle (resets on success)",rarity:"common",synergies:["press"],hooks:["onTackle"],modifiers:[],effectId:"persistentTackle",icon:"üîÅ"},{id:"magnetBall",name:"Magnet Ball",description:"Ball slightly curves toward you when nearby",rarity:"uncommon",synergies:["chaos","trickster"],hooks:["onTick"],modifiers:[],effectId:"ballMagnet",icon:"üß≤"},{id:"trailBlazer",name:"Trail Blazer",description:"Leave speed-boost trail for teammates",rarity:"uncommon",synergies:["speedster","trianglePassing"],hooks:["onTick"],modifiers:[],effectId:"speedTrail",icon:"üåü"},{id:"triangleFormation",name:"Triangle Formation",description:"+25% pass power in triangles with teammates",rarity:"uncommon",synergies:["trianglePassing"],hooks:["onPass"],modifiers:[],effectId:"trianglePassBoost",icon:"üî∫"},{id:"circleSpecialist",name:"Circle Specialist",description:"+30% shot power inside the D",rarity:"uncommon",synergies:["dragFlick","precision"],hooks:["onShot"],modifiers:[],effectId:"circleShotBoost",icon:"‚≠ï"},{id:"pressureCooker",name:"Pressure Cooker",description:"+20% tackle range when pressing",rarity:"uncommon",synergies:["press"],hooks:["onTackle"],modifiers:[],effectId:"pressTackleRange",icon:"üç≥"},{id:"secondWind",name:"Second Wind",description:"Full stamina restore at half-time of moment",rarity:"uncommon",synergies:["speedster"],hooks:["onTick"],modifiers:[],effectId:"halfTimeStamina",icon:"üå¨Ô∏è"},{id:"reboundHunter",name:"Rebound Hunter",description:"+50% speed toward loose balls after shots",rarity:"uncommon",synergies:["rebound"],hooks:["onShot"],modifiers:[],effectId:"reboundSpeed",icon:"üéØ"},{id:"ironWill",name:"Iron Will",description:"Cannot be stunned for longer than 0.5s",rarity:"uncommon",synergies:["tank","berserker"],hooks:["onDamage"],modifiers:[],effectId:"stunCap",icon:"üèîÔ∏è"},{id:"quickPass",name:"Quick Pass",description:"Passes travel 30% faster",rarity:"uncommon",synergies:["trianglePassing","speedster"],hooks:["onPass"],modifiers:[],effectId:"fastPass",icon:"üí®"},{id:"curveShot",name:"Curve Shot",description:"Shots curve slightly toward goal",rarity:"uncommon",synergies:["trickster","precision"],hooks:["onShot"],modifiers:[],effectId:"curvingShot",icon:"üåÄ"},{id:"vampireTackle",name:"Vampire Tackle",description:"Successful tackles restore stamina",rarity:"uncommon",synergies:["vampire","press"],hooks:["onSteal"],modifiers:[],effectId:"tackleStaminaRestore",icon:"üßõ"},{id:"lastStand",name:"Last Stand",description:"+30% all stats when conceding",rarity:"uncommon",synergies:["guardian","berserker"],hooks:["onTick"],modifiers:[],effectId:"losingBuff",icon:"üõ°Ô∏è"},{id:"momentumShift",name:"Momentum Shift",description:"+5% speed per goal scored (stacks to 3)",rarity:"uncommon",synergies:["speedster"],hooks:["onGoal"],modifiers:[],effectId:"goalSpeedStack",icon:"üìà"},{id:"slickMoves",name:"Slick Moves",description:"Dodge resets on successful steal",rarity:"uncommon",synergies:["trickster","press"],hooks:["onSteal"],modifiers:[],effectId:"stealDodgeReset",icon:"üé≠"},{id:"powerShot",name:"Power Shot",description:"Hold shoot for up to 50% more power",rarity:"uncommon",synergies:["dragFlick","precision"],hooks:["onShot"],modifiers:[],effectId:"chargeShot",icon:"üîã"},{id:"counterPress",name:"Counter Press",description:"+40% tackle success within 2s of losing ball",rarity:"uncommon",synergies:["press"],hooks:["onTackle"],modifiers:[],effectId:"counterPressTackle",icon:"‚Ü©Ô∏è"},{id:"composure",name:"Composure",description:"+20% shot accuracy when unmarked",rarity:"uncommon",synergies:["precision"],hooks:["onShot"],modifiers:[],effectId:"unmarkedShotBoost",icon:"üòå"},{id:"leadingPass",name:"Leading Pass",description:"Passes predict teammate movement",rarity:"uncommon",synergies:["trianglePassing","precision"],hooks:["onPass"],modifiers:[],effectId:"predictivePass",icon:"üéØ"},{id:"deflector",name:"Deflector",description:"+20% chance to deflect enemy shots when nearby",rarity:"uncommon",synergies:["guardian","rebound"],hooks:["onTick"],modifiers:[],effectId:"shotDeflection",icon:"ü™É"},{id:"burstSpeed",name:"Burst Speed",description:"+50% acceleration after receiving ball",rarity:"uncommon",synergies:["speedster","trianglePassing"],hooks:["onReceive"],modifiers:[],effectId:"receiveAccel",icon:"üöÄ"},{id:"boomerangPass",name:"Boomerang Pass",description:"Missed passes return to you",rarity:"rare",synergies:["chaos","trianglePassing"],hooks:["onPass"],modifiers:[],effectId:"boomerangPass",icon:"ü™É"},{id:"iceTurf",name:"Ice Turf",description:"Enemies slip occasionally; you slide faster",rarity:"rare",synergies:["chaos","speedster"],hooks:["onTick"],modifiers:[],effectId:"iceTurfEffect",icon:"üßä"},{id:"luckyDeflection",name:"Lucky Deflection",description:"15% chance blocked shots redirect to goal",rarity:"rare",synergies:["chaos","rebound"],hooks:["onShot"],modifiers:[],effectId:"luckyDeflect",icon:"üçÄ"},{id:"dragFlickMaster",name:"Drag Flick Master",description:"Shots from stationary are 50% faster",rarity:"rare",synergies:["dragFlick"],hooks:["onShot"],modifiers:[],effectId:"stationaryShotBoost",icon:"üèë"},{id:"pressGang",name:"Press Gang",description:"Teammates copy your press direction",rarity:"rare",synergies:["press","trianglePassing"],hooks:["onTick"],modifiers:[],effectId:"coordPress",icon:"üë•"},{id:"doubleDeflection",name:"Double Deflection",description:"Rebounds deal +100% damage and move faster",rarity:"rare",synergies:["rebound"],hooks:["onShot"],modifiers:[],effectId:"superRebound",icon:"üí´"},{id:"phantomDodge",name:"Phantom Dodge",description:"Leave decoy on dodge that distracts enemies",rarity:"rare",synergies:["trickster"],hooks:["onDodge"],modifiers:[],effectId:"dodgeDecoy",icon:"üëª"},{id:"vampireGoal",name:"Vampire Goal",description:"Goals restore full stamina and reduce cooldowns",rarity:"rare",synergies:["vampire"],hooks:["onGoal"],modifiers:[],effectId:"goalFullRestore",icon:"ü©∏"},{id:"berserkerMode",name:"Berserker Mode",description:"+5% damage per hit taken (max 50%)",rarity:"rare",synergies:["berserker","tank"],hooks:["onDamage"],modifiers:[],effectId:"damageStacking",icon:"üò§"},{id:"precisionStrike",name:"Precision Strike",description:"Perfect timing shots ignore goalie",rarity:"rare",synergies:["precision","dragFlick"],hooks:["onShot"],modifiers:[],effectId:"perfectShot",icon:"üéØ"},{id:"guardianAngel",name:"Guardian Angel",description:"Once per moment, auto-block a certain goal",rarity:"rare",synergies:["guardian"],hooks:["onTick"],modifiers:[],effectId:"autoBlock",icon:"üëº"},{id:"chainTackle",name:"Chain Tackle",description:"Successful tackles reset tackle cooldown",rarity:"rare",synergies:["press","berserker"],hooks:["onSteal"],modifiers:[],effectId:"tackleReset",icon:"‚õìÔ∏è"},{id:"oneTouch",name:"One Touch",description:"Instant pass after receive is 30% faster",rarity:"rare",synergies:["trianglePassing","speedster"],hooks:["onReceive","onPass"],modifiers:[],effectId:"oneTouchPass",icon:"‚òùÔ∏è"},{id:"aerialThreat",name:"Aerial Threat",description:"Can lob passes over defenders",rarity:"rare",synergies:["trianglePassing","trickster"],hooks:["onPass"],modifiers:[],effectId:"lobPass",icon:"üéà"},{id:"reverseHit",name:"Reverse Hit",description:"Can shoot backward with 80% power",rarity:"rare",synergies:["trickster","dragFlick"],hooks:["onShot"],modifiers:[],effectId:"backShot",icon:"‚Ü™Ô∏è"},{id:"staminaVampire",name:"Stamina Vampire",description:"Drain enemy stamina on tackles",rarity:"rare",synergies:["vampire","press"],hooks:["onSteal"],modifiers:[],effectId:"stealStamina",icon:"ü¶á"},{id:"momentumCarry",name:"Momentum Carry",description:"Keep 50% of speed bonuses between moments",rarity:"rare",synergies:["speedster"],hooks:["onMomentEnd"],modifiers:[],effectId:"carrySpeed",icon:"üì¶"},{id:"shieldDodge",name:"Shield Dodge",description:"Dodge creates brief damage immunity shield",rarity:"rare",synergies:["tank","trickster"],hooks:["onDodge"],modifiers:[],effectId:"dodgeShield",icon:"üõ°Ô∏è"},{id:"reboundMaster",name:"Rebound Master",description:"+40% control on loose balls",rarity:"rare",synergies:["rebound"],hooks:["onReceive"],modifiers:[],effectId:"looseBallControl",icon:"üé±"},{id:"pressurePoint",name:"Pressure Point",description:"Tackles slow enemy for 2s",rarity:"rare",synergies:["press","tank"],hooks:["onSteal"],modifiers:[],effectId:"tackleSlow",icon:"üìç"},{id:"multiball",name:"Multiball",description:"Shots split into 2 balls (second is weaker)",rarity:"epic",synergies:["chaos","rebound"],hooks:["onShot"],modifiers:[],effectId:"splitShot",icon:"üé±"},{id:"timeDilation",name:"Time Dilation",description:"Slow time briefly after perfect dodge",rarity:"epic",synergies:["trickster","precision"],hooks:["onDodge"],modifiers:[],effectId:"slowMo",icon:"‚è∞"},{id:"triangleMastery",name:"Triangle Mastery",description:"Passes in triangle formation auto-complete",rarity:"epic",synergies:["trianglePassing"],hooks:["onPass"],modifiers:[],effectId:"autoTriangle",icon:"üìê"},{id:"pressMachine",name:"Press Machine",description:"Teammates auto-press when you press",rarity:"epic",synergies:["press"],hooks:["onTick"],modifiers:[],effectId:"teamPress",icon:"ü§ñ"},{id:"unstoppable",name:"Unstoppable",description:"Cannot be tackled while shooting",rarity:"epic",synergies:["tank","dragFlick"],hooks:["onShot"],modifiers:[],effectId:"shootImmunity",icon:"ü¶è"},{id:"vampireLord",name:"Vampire Lord",description:"All attacks heal you",rarity:"epic",synergies:["vampire"],hooks:["onHit"],modifiers:[],effectId:"attackLifesteal",icon:"üßõ‚Äç‚ôÇÔ∏è"},{id:"chaosField",name:"Chaos Field",description:"Random effects trigger every 5s",rarity:"epic",synergies:["chaos"],hooks:["onTick"],modifiers:[],effectId:"randomEffects",icon:"üé∞"},{id:"perfectRebound",name:"Perfect Rebound",description:"Rebounds always go toward goal",rarity:"epic",synergies:["rebound","precision"],hooks:["onShot"],modifiers:[],effectId:"guidedRebound",icon:"üéØ"},{id:"berserkerRage",name:"Berserker Rage",description:"+100% attack speed at low stamina",rarity:"epic",synergies:["berserker"],hooks:["onTick"],modifiers:[],effectId:"lowStaminaSpeed",icon:"üî•"},{id:"guardianWall",name:"Guardian Wall",description:"Create barrier behind you that blocks shots",rarity:"epic",synergies:["guardian"],hooks:["onTick"],modifiers:[],effectId:"shotBarrier",icon:"üß±"},{id:"dragFlickKing",name:"Drag Flick King",description:"PC shots are unblockable",rarity:"epic",synergies:["dragFlick"],hooks:["onShot"],modifiers:[],effectId:"unblockablePC",icon:"üëë"},{id:"speedDemon",name:"Speed Demon",description:"+50% speed but -30% control",rarity:"epic",synergies:["speedster"],hooks:["passive"],modifiers:[{stat:"speed",value:50,isPercent:!0},{stat:"control",value:-30,isPercent:!0}],effectId:"speedControl",icon:"üëπ"},{id:"tricksterKing",name:"Trickster King",description:"Triple dodge charges",rarity:"epic",synergies:["trickster"],hooks:["passive"],modifiers:[],effectId:"tripleDodge",icon:"üÉè"},{id:"tankMode",name:"Tank Mode",description:"Immune to knockback, +50% stun resist",rarity:"epic",synergies:["tank"],hooks:["passive"],modifiers:[],effectId:"knockbackImmune",icon:"üõ°Ô∏è"},{id:"passNetwork",name:"Pass Network",description:"Passes chain automatically between teammates",rarity:"epic",synergies:["trianglePassing","precision"],hooks:["onPass"],modifiers:[],effectId:"chainPass",icon:"üîó"},{id:"avatarState",name:"Avatar State",description:"+100% all stats when behind by 2+ goals",rarity:"legendary",synergies:["berserker","tank"],hooks:["onTick"],modifiers:[],effectId:"avatarMode",icon:"üåü"},{id:"perfectGame",name:"Perfect Game",description:"First shot each moment is guaranteed goal",rarity:"legendary",synergies:["precision","dragFlick"],hooks:["onMomentStart","onShot"],modifiers:[],effectId:"guaranteedGoal",icon:"‚ú®"},{id:"timeLoop",name:"Time Loop",description:"Once per run: rewind 10s after conceding",rarity:"legendary",synergies:["chaos","guardian"],hooks:["onTick"],modifiers:[],effectId:"timeRewind",icon:"‚è™"},{id:"infiniteStamina",name:"Infinite Stamina",description:"Stamina never depletes",rarity:"legendary",synergies:["speedster","vampire"],hooks:["passive"],modifiers:[],effectId:"unlimitedStamina",icon:"‚ôæÔ∏è"},{id:"goldenStick",name:"Golden Stick",description:"All stats +25%, gain extra upgrade choice",rarity:"legendary",synergies:[],hooks:["passive"],modifiers:[{stat:"speed",value:25,isPercent:!0},{stat:"stamina",value:25,isPercent:!0},{stat:"control",value:25,isPercent:!0},{stat:"shotPower",value:25,isPercent:!0},{stat:"passPower",value:25,isPercent:!0},{stat:"tackle",value:25,isPercent:!0},{stat:"dodge",value:25,isPercent:!0}],effectId:"goldenBoost",icon:"üèÜ"},{id:"instantReaction",name:"Instant Reaction",description:"+50% speed for 1.5s after losing ball",rarity:"uncommon",synergies:["counterPress","speedster"],hooks:["onTick"],modifiers:[],effectId:"lostBallSpeedBurst",icon:"‚ö°"},{id:"packHunter",name:"Pack Hunter",description:"+15% tackle success per nearby teammate",rarity:"uncommon",synergies:["counterPress","press"],hooks:["onTackle"],modifiers:[],effectId:"packTackleBoost",icon:"üê∫"},{id:"turnoverArtist",name:"Turnover Artist",description:"Steals restore 30% stamina",rarity:"rare",synergies:["counterPress","vampire"],hooks:["onSteal"],modifiers:[],effectId:"stealStaminaRestore",icon:"üé≠"},{id:"gegenpressing",name:"Gegenpressing",description:"Team auto-presses for 3s after turnover",rarity:"epic",synergies:["counterPress","press"],hooks:["onSteal"],modifiers:[],effectId:"teamCounterPress",icon:"üîÑ"},{id:"calmControl",name:"Calm Control",description:"+20% control when stationary",rarity:"common",synergies:["possession"],hooks:["onTick"],modifiers:[],effectId:"stationaryControl",icon:"üßò",maxStacks:2},{id:"patientPlay",name:"Patient Play",description:"+5% all stats per 5s of possession",rarity:"uncommon",synergies:["possession","trianglePassing"],hooks:["onTick"],modifiers:[],effectId:"possessionStacking",icon:"‚è≥"},{id:"keepBall",name:"Keep Ball",description:"Passes have 20% chance to reset cooldowns",rarity:"uncommon",synergies:["possession","trianglePassing"],hooks:["onPass"],modifiers:[],effectId:"passCooldownReset",icon:"üîÅ"},{id:"tikaTaka",name:"Tika-Taka",description:"Back-to-back passes increase speed by 10% each",rarity:"rare",synergies:["possession","speedster"],hooks:["onPass","onReceive"],modifiers:[],effectId:"passingMomentum",icon:"‚öΩ"},{id:"metronome",name:"Metronome",description:"Perfect pass timing gives +50% pass power",rarity:"rare",synergies:["possession","precision"],hooks:["onPass"],modifiers:[],effectId:"timedPassBonus",icon:"üéµ"},{id:"possessionMaster",name:"Possession Master",description:"Cannot be tackled while ball is bobbing",rarity:"epic",synergies:["possession","tank"],hooks:["passive"],modifiers:[],effectId:"bobbleImmunity",icon:"üëë"},{id:"lastLine",name:"Last Line",description:"+30% tackle range when furthest back",rarity:"uncommon",synergies:["sweeper","guardian"],hooks:["onTackle"],modifiers:[],effectId:"lastManTackleRange",icon:"üß±"},{id:"clearancePower",name:"Clearance Power",description:"+50% pass power in own half",rarity:"common",synergies:["sweeper"],hooks:["onPass"],modifiers:[],effectId:"ownHalfPassPower",icon:"ü¶µ",maxStacks:2},{id:"interceptor",name:"Interceptor",description:"25% chance to auto-intercept nearby passes",rarity:"rare",synergies:["sweeper","guardian"],hooks:["onTick"],modifiers:[],effectId:"autoIntercept",icon:"üñêÔ∏è"},{id:"rushOut",name:"Rush Out",description:"+80% speed when ball in your D-circle",rarity:"rare",synergies:["sweeper","speedster"],hooks:["onTick"],modifiers:[],effectId:"dCircleRush",icon:"üèÉ"},{id:"sweeperKeeper",name:"Sweeper Keeper",description:"Auto-block one shot per moment when near goal",rarity:"epic",synergies:["sweeper","guardian"],hooks:["onTick"],modifiers:[],effectId:"autoBlockShot",icon:"üß§"},{id:"rainDancer",name:"Rain Dancer",description:"No control penalty on wet turf",rarity:"uncommon",synergies:["weather","trickster"],hooks:["passive"],modifiers:[],effectId:"wetTurfImmune",icon:"üåßÔ∏è"},{id:"iceSkater",name:"Ice Skater",description:"+20% speed on slippery surfaces",rarity:"uncommon",synergies:["weather","speedster"],hooks:["onTick"],modifiers:[],effectId:"slipSpeedBoost",icon:"‚õ∏Ô∏è"},{id:"mudRunner",name:"Mud Runner",description:"Enemies slip 30% more often near you",rarity:"rare",synergies:["weather","chaos"],hooks:["onTick"],modifiers:[],effectId:"enemySlipAura",icon:"ü¶∂"},{id:"stormChaser",name:"Storm Chaser",description:"+15% all stats during weather modifiers",rarity:"rare",synergies:["weather"],hooks:["onMomentStart","onTick"],modifiers:[],effectId:"weatherStatsBoost",icon:"‚õàÔ∏è"},{id:"weatherMaster",name:"Weather Master",description:"Create slippery zone around you that affects enemies",rarity:"epic",synergies:["weather","chaos"],hooks:["onTick"],modifiers:[],effectId:"slipZoneAura",icon:"üåÄ"},{id:"boxPresence",name:"Box Presence",description:"+20% shot power inside enemy D",rarity:"common",synergies:["poacher","dragFlick"],hooks:["onShot"],modifiers:[],effectId:"enemyDShotPower",icon:"üì¶",maxStacks:2},{id:"goalPoacher",name:"Goal Poacher",description:"+40% speed toward loose balls in enemy D",rarity:"uncommon",synergies:["poacher","rebound"],hooks:["onTick"],modifiers:[],effectId:"poacherSpeed",icon:"ü¶Ö"},{id:"tapIn",name:"Tap In Specialist",description:"Shots at close range are 30% faster",rarity:"uncommon",synergies:["poacher","precision"],hooks:["onShot"],modifiers:[],effectId:"closeRangeShotBoost",icon:"üëÜ"},{id:"secondBall",name:"Second Ball",description:"+60% chance to reach rebounds first",rarity:"rare",synergies:["poacher","rebound"],hooks:["onShot"],modifiers:[],effectId:"reboundPriority",icon:"2Ô∏è‚É£"},{id:"finisher",name:"Clinical Finisher",description:"Goals from inside D restore all cooldowns",rarity:"rare",synergies:["poacher","precision"],hooks:["onGoal"],modifiers:[],effectId:"dGoalCooldownReset",icon:"üéØ"},{id:"poachingInstinct",name:"Poaching Instinct",description:"Teleport to rebound position after teammate shots",rarity:"epic",synergies:["poacher","chaos"],hooks:["onTick"],modifiers:[],effectId:"reboundTeleport",icon:"‚ú®"},{id:"chipPass",name:"Chip Pass",description:"Passes can go over one defender",rarity:"uncommon",synergies:["aerial","trianglePassing"],hooks:["onPass"],modifiers:[],effectId:"chipPassDefender",icon:"üéà"},{id:"loftedShot",name:"Lofted Shot",description:"Hold shoot for aerial shot that dips at goal",rarity:"rare",synergies:["aerial","dragFlick"],hooks:["onShot"],modifiers:[],effectId:"dippingShot",icon:"üåà"},{id:"volleyMaster",name:"Volley Master",description:"+40% power on first-touch shots from aerials",rarity:"rare",synergies:["aerial","precision"],hooks:["onReceive","onShot"],modifiers:[],effectId:"volleyPowerBoost",icon:"ü¶∂"},{id:"aerialDominance",name:"Aerial Dominance",description:"Always win aerial balls",rarity:"epic",synergies:["aerial","tank"],hooks:["passive"],modifiers:[],effectId:"winAerials",icon:"üèÜ"},{id:"pcSpecialist",name:"PC Specialist",description:"+30% shot power from penalty corners",rarity:"uncommon",synergies:["dragFlick"],hooks:["onShot"],modifiers:[],effectId:"pcShotPower",icon:"üéØ"},{id:"lowFlick",name:"Low Flick",description:"Shots from stationary go under blockers",rarity:"rare",synergies:["dragFlick","precision"],hooks:["onShot"],modifiers:[],effectId:"lowShotPenetration",icon:"‚¨áÔ∏è"},{id:"windUp",name:"Wind Up",description:"Standing still charges shot power (max +50%)",rarity:"rare",synergies:["dragFlick","precision"],hooks:["onTick","onShot"],modifiers:[],effectId:"stationaryCharge",icon:"üåÄ"},{id:"topCorner",name:"Top Corner",description:"20% of shots become unsaveable",rarity:"epic",synergies:["dragFlick","precision"],hooks:["onShot"],modifiers:[],effectId:"unsaveableShot",icon:"üìê"},{id:"highLine",name:"High Line",description:"Team pushes higher, +10% team speed",rarity:"uncommon",synergies:["press"],hooks:["onTick"],modifiers:[],effectId:"highLineSpeed",icon:"‚¨ÜÔ∏è"},{id:"trapSetter",name:"Trap Setter",description:"Enemies near sideline lose 15% speed",rarity:"rare",synergies:["press","guardian"],hooks:["onTick"],modifiers:[],effectId:"sidelineTrap",icon:"üï∏Ô∏è"},{id:"relentless",name:"Relentless",description:"No stamina cost when pressing",rarity:"rare",synergies:["press","speedster"],hooks:["onTick"],modifiers:[],effectId:"freePressing",icon:"‚ôæÔ∏è"},{id:"suffocate",name:"Suffocate",description:"Enemies with ball lose 5% control per second",rarity:"epic",synergies:["press"],hooks:["onTick"],modifiers:[],effectId:"pressureControlDrain",icon:"üò§"},{id:"fakeShot",name:"Fake Shot",description:"Dodge creates fake shot animation",rarity:"uncommon",synergies:["trickster"],hooks:["onDodge"],modifiers:[],effectId:"dodgeFakeShot",icon:"üé≠"},{id:"nutmeg",name:"Nutmeg Master",description:"15% chance to phase through tackles",rarity:"rare",synergies:["trickster","tank"],hooks:["passive"],modifiers:[],effectId:"tacklePhase",icon:"ü•ú"},{id:"stepOver",name:"Step Over",description:"Dodge confuses nearby enemies for 1s",rarity:"rare",synergies:["trickster"],hooks:["onDodge"],modifiers:[],effectId:"dodgeConfuse",icon:"üí´"},{id:"elastico",name:"Elastico",description:"Double-tap dodge for quick direction change",rarity:"epic",synergies:["trickster","speedster"],hooks:["onDodge"],modifiers:[],effectId:"doubleDodge",icon:"üîÄ"},{id:"deflectionKing",name:"Deflection King",description:"Blocked shots gain +30% power",rarity:"uncommon",synergies:["rebound"],hooks:["onShot"],modifiers:[],effectId:"blockedShotPowerGain",icon:"üëë"},{id:"anticipation",name:"Anticipation",description:"See shot trajectory before it happens",rarity:"rare",synergies:["rebound","guardian"],hooks:["onTick"],modifiers:[],effectId:"shotPrediction",icon:"üëÅÔ∏è"},{id:"ricochets",name:"Ricochets",description:"Shots bounce off players toward goal",rarity:"epic",synergies:["rebound","chaos"],hooks:["onShot"],modifiers:[],effectId:"playerBounceToGoal",icon:"üîÑ"},{id:"goalkeeper",name:"Goalkeeper",description:"+40% tackle success in own D",rarity:"uncommon",synergies:["guardian","sweeper"],hooks:["onTackle"],modifiers:[],effectId:"ownDTackleBoost",icon:"üß§"},{id:"shotBlocker",name:"Shot Blocker",description:"+30% body size when blocking shots",rarity:"rare",synergies:["guardian","tank"],hooks:["onTick"],modifiers:[],effectId:"enlargeForBlock",icon:"üöß"},{id:"clearanceBot",name:"Clearance Bot",description:"Auto-clear balls in your D toward enemy half",rarity:"rare",synergies:["guardian","sweeper"],hooks:["onReceive"],modifiers:[],effectId:"autoClearance",icon:"ü§ñ"},{id:"afterburner",name:"Afterburner",description:"+30% speed after 2s of sprinting",rarity:"uncommon",synergies:["speedster"],hooks:["onTick"],modifiers:[],effectId:"sprintRampUp",icon:"üî•"},{id:"quickBreak",name:"Quick Break",description:"+50% speed for 3s after steals",rarity:"rare",synergies:["speedster","counterPress"],hooks:["onSteal"],modifiers:[],effectId:"stealSpeedBurst",icon:"üí®"},{id:"breakaway",name:"Breakaway",description:"+25% speed when no enemies ahead",rarity:"rare",synergies:["speedster","poacher"],hooks:["onTick"],modifiers:[],effectId:"openFieldSpeed",icon:"üèÉ‚Äç‚ôÇÔ∏è"},{id:"speedDemonMk2",name:"Speed Demon Mk2",description:"Max speed increases by 5% per moment",rarity:"epic",synergies:["speedster"],hooks:["onMomentEnd"],modifiers:[],effectId:"stackingSpeed",icon:"üöÄ"},{id:"immovable",name:"Immovable",description:"-50% knockback from all sources",rarity:"uncommon",synergies:["tank"],hooks:["onDamage"],modifiers:[],effectId:"reducedKnockback",icon:"üóø"},{id:"brickWall",name:"Brick Wall",description:"Enemies bounce off you when you have ball",rarity:"rare",synergies:["tank","possession"],hooks:["onDamage"],modifiers:[],effectId:"tacklerBounce",icon:"üß±"},{id:"bullRush",name:"Bull Rush",description:"Sprint through tackles with 30% chance",rarity:"rare",synergies:["tank","speedster"],hooks:["passive"],modifiers:[],effectId:"sprintThroughTackle",icon:"üêÇ"},{id:"juggernaut",name:"Juggernaut",description:"Immune to stuns while moving",rarity:"epic",synergies:["tank","berserker"],hooks:["passive"],modifiers:[],effectId:"movingStunImmune",icon:"ü¶è"},{id:"lifeSteal",name:"Life Steal",description:"Tackles restore 10% stamina",rarity:"common",synergies:["vampire","press"],hooks:["onTackle"],modifiers:[],effectId:"tackleStaminaGain",icon:"ü©∏",maxStacks:2},{id:"drainTouch",name:"Drain Touch",description:"Contact with enemies drains their stamina",rarity:"rare",synergies:["vampire","tank"],hooks:["onTick"],modifiers:[],effectId:"contactStaminaDrain",icon:"‚úã"},{id:"soulSiphon",name:"Soul Siphon",description:"Goals heal 50% of missing stamina",rarity:"rare",synergies:["vampire"],hooks:["onGoal"],modifiers:[],effectId:"goalStaminaHeal",icon:"üëª"},{id:"bloodlust",name:"Bloodlust",description:"Each steal increases speed by 10% (stacks 5x)",rarity:"epic",synergies:["vampire","berserker"],hooks:["onSteal"],modifiers:[],effectId:"stealSpeedStacking",icon:"ü©∏"},{id:"rageBuildup",name:"Rage Buildup",description:"+3% power per tackle taken (max 30%)",rarity:"uncommon",synergies:["berserker"],hooks:["onDamage"],modifiers:[],effectId:"damagePowerStack",icon:"üò†"},{id:"frenzy",name:"Frenzy",description:"+20% attack speed when below 30% stamina",rarity:"rare",synergies:["berserker","speedster"],hooks:["onTick"],modifiers:[],effectId:"lowStaminaAttackSpeed",icon:"üî¥"},{id:"desperateShot",name:"Desperate Shot",description:"+50% shot power when losing",rarity:"rare",synergies:["berserker","dragFlick"],hooks:["onShot"],modifiers:[],effectId:"losingShotPower",icon:"üò§"},{id:"unhinged",name:"Unhinged",description:"Random stat boosts every 5s",rarity:"epic",synergies:["berserker","chaos"],hooks:["onTick"],modifiers:[],effectId:"randomStatBoosts",icon:"üÉè"},{id:"ballMagnetPlus",name:"Ball Magnet+",description:"Stronger ball attraction effect",rarity:"rare",synergies:["chaos","trickster"],hooks:["onTick"],modifiers:[],effectId:"strongBallMagnet",icon:"üß≤"},{id:"teleportBall",name:"Teleport Ball",description:"10% chance passes teleport to target",rarity:"rare",synergies:["chaos","trianglePassing"],hooks:["onPass"],modifiers:[],effectId:"instantPass",icon:"‚ú®"},{id:"mirrorImage",name:"Mirror Image",description:"Create decoy that confuses AI",rarity:"epic",synergies:["chaos","trickster"],hooks:["onDodge"],modifiers:[],effectId:"createDecoy",icon:"üë•"},{id:"perfectPass",name:"Perfect Pass",description:"Passes that hit targets exactly give +10% speed",rarity:"uncommon",synergies:["precision","trianglePassing"],hooks:["onPass"],modifiers:[],effectId:"accuratePassBonus",icon:"üéØ"},{id:"sniper",name:"Sniper",description:"+25% shot accuracy from distance",rarity:"rare",synergies:["precision","dragFlick"],hooks:["onShot"],modifiers:[],effectId:"longRangeShotAccuracy",icon:"üî≠"},{id:"clutchPlayer",name:"Clutch Player",description:"+30% all stats in final 15s",rarity:"rare",synergies:["precision"],hooks:["onTick"],modifiers:[],effectId:"finalSecondsBoost",icon:"‚è∞"},{id:"sureShot",name:"Sure Shot",description:"First shot after receiving is guaranteed on target",rarity:"epic",synergies:["precision","poacher"],hooks:["onReceive","onShot"],modifiers:[],effectId:"firstTouchOnTarget",icon:"üíØ"}];function be(g,o,e){const t={...Se};o>=3&&(t.rare+=5,t.epic+=2),o>=6&&(t.rare+=10,t.epic+=5,t.legendary+=1),o>=9&&(t.epic+=5,t.legendary+=2);const s=we.filter(r=>{const l=e.filter(h=>h===r.id).length,d=r.maxStacks||1;return l<d});if(s.length===0)return[];const i=Object.values(t).reduce((r,l)=>r+l,0),n=[],a=new Set;for(;n.length<g&&a.size<s.length;){const r=Math.random()*i;let l=0,d="common";for(const[f,m]of Object.entries(t))if(l+=m,r<=l){d=f;break}const h=s.filter(f=>f.rarity===d&&!a.has(f.id));if(h.length>0){const f=h[Math.floor(Math.random()*h.length)];n.push(f),a.add(f.id)}else{const f=s.filter(m=>!a.has(m.id));if(f.length>0){const m=f[Math.floor(Math.random()*f.length)];n.push(m),a.add(m.id)}}}return n}class xe extends p.GameObjects.Container{constructor(e,t){super(e,0,0);c(this,"overlay");c(this,"cards",[]);c(this,"currentUpgrades",[]);c(this,"config");c(this,"rerollsRemaining");c(this,"rerollButton");c(this,"skipButton");this.config=t,this.rerollsRemaining=t.rerolls,this.overlay=e.add.rectangle(e.cameras.main.centerX,e.cameras.main.centerY,e.cameras.main.width,e.cameras.main.height,0,.85),this.overlay.setDepth(200),this.add(this.overlay);const s=e.add.text(e.cameras.main.centerX,80,"‚ö° CHOOSE YOUR UPGRADE ‚ö°",{fontFamily:"Arial, sans-serif",fontSize:"36px",color:"#f1c40f",fontStyle:"bold"});s.setOrigin(.5),s.setDepth(201),this.add(s);const i=e.add.text(e.cameras.main.centerX,120,`Moment ${t.momentNumber} Complete!`,{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#bdc3c7"});i.setOrigin(.5),i.setDepth(201),this.add(i),this.generateUpgrades(),this.rerollsRemaining>0&&(this.rerollButton=new T(e,{x:e.cameras.main.centerX-100,y:e.cameras.main.height-80,width:150,height:40,text:`üîÑ Reroll (${this.rerollsRemaining})`,fontSize:16,style:"secondary",onClick:()=>this.reroll()}),this.rerollButton.setDepth(201),this.add(this.rerollButton)),t.onSkip&&(this.skipButton=new T(e,{x:e.cameras.main.centerX+100,y:e.cameras.main.height-80,width:150,height:40,text:"Skip",fontSize:16,style:"danger",onClick:()=>{this.hide(),t.onSkip()}}),this.skipButton.setDepth(201),this.add(this.skipButton)),this.setDepth(200),e.add.existing(this),this.show()}generateUpgrades(){const e=3+this.config.extraChoices;this.currentUpgrades=be(e,this.config.momentNumber,this.config.ownedUpgradeIds),this.displayCards()}displayCards(){this.cards.forEach(n=>n.destroy()),this.cards=[];const e=180,t=30,s=this.currentUpgrades.length*e+(this.currentUpgrades.length-1)*t,i=this.scene.cameras.main.centerX-s/2+e/2;this.currentUpgrades.forEach((n,a)=>{const r=new Te(this.scene,i+a*(e+t),this.scene.cameras.main.centerY,n,()=>this.selectUpgrade(n));r.setDepth(202),this.cards.push(r),this.add(r),r.setAlpha(0),r.setScale(.5),this.scene.tweens.add({targets:r,alpha:1,scaleX:1,scaleY:1,duration:300,delay:a*100,ease:"Back.easeOut"})})}reroll(){this.rerollsRemaining<=0||(this.rerollsRemaining--,this.cards.forEach((e,t)=>{this.scene.tweens.add({targets:e,alpha:0,y:e.y-50,duration:200,delay:t*50,onComplete:()=>{t===this.cards.length-1&&this.generateUpgrades()}})}),this.rerollButton&&(this.rerollsRemaining>0?this.rerollButton.setText(`üîÑ Reroll (${this.rerollsRemaining})`):(this.rerollButton.setDisabled(!0),this.rerollButton.setText("No Rerolls"))))}selectUpgrade(e){this.cards.forEach(t=>{t.upgrade.id===e.id?this.scene.tweens.add({targets:t,scaleX:1.2,scaleY:1.2,duration:200,ease:"Back.easeOut"}):this.scene.tweens.add({targets:t,alpha:.3,duration:200})}),this.scene.time.delayedCall(500,()=>{this.hide(),this.config.onSelect(e)})}show(){this.overlay.setAlpha(0),this.scene.tweens.add({targets:this.overlay,alpha:.85,duration:300})}hide(){this.scene.tweens.add({targets:this,alpha:0,duration:200,onComplete:()=>this.destroy()})}}class Te extends p.GameObjects.Container{constructor(e,t,s,i,n){super(e,t,s);c(this,"upgrade");c(this,"bg");c(this,"glowTween");this.upgrade=i;const a=170,r=260,l=E[i.rarity],d=e.add.graphics();d.fillStyle(l,.3),d.fillRoundedRect(-a/2-8,-r/2-8,a+16,r+16,16),this.add(d),this.glowTween=e.tweens.add({targets:d,alpha:.5,duration:800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.bg=e.add.graphics(),this.bg.fillStyle(1973806,1),this.bg.fillRoundedRect(-a/2,-r/2,a,r,12),this.bg.lineStyle(3,l,1),this.bg.strokeRoundedRect(-a/2,-r/2,a,r,12),this.add(this.bg);const h=e.add.graphics();h.fillStyle(l,1),h.fillRoundedRect(-a/2,-r/2,a,6,{tl:12,tr:12,bl:0,br:0}),this.add(h);const f=e.add.text(0,-r/2+50,i.icon,{fontSize:"48px"});f.setOrigin(.5),this.add(f);const m=e.add.text(0,-r/2+100,i.name,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#ffffff",fontStyle:"bold",align:"center",wordWrap:{width:a-20}});m.setOrigin(.5),this.add(m);const u=e.add.text(0,-r/2+125,i.rarity.toUpperCase(),{fontFamily:"Arial, sans-serif",fontSize:"10px",color:"#"+l.toString(16).padStart(6,"0"),fontStyle:"bold"});u.setOrigin(.5),this.add(u);const y=e.add.text(0,-r/2+165,i.description,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#bdc3c7",align:"center",wordWrap:{width:a-24}});if(y.setOrigin(.5,0),this.add(y),i.synergies.length>0){const k=r/2-30,w=i.synergies.slice(0,2).map(x=>Y[x]).join(" ‚Ä¢ "),S=e.add.text(0,k,w,{fontFamily:"Arial, sans-serif",fontSize:"10px",color:"#"+ke[i.synergies[0]].toString(16).padStart(6,"0"),align:"center"});S.setOrigin(.5),this.add(S)}this.setSize(a,r),this.setInteractive({useHandCursor:!0}),this.on("pointerover",()=>{e.tweens.add({targets:this,y:s-10,scaleX:1.05,scaleY:1.05,duration:150,ease:"Power2"})}),this.on("pointerout",()=>{e.tweens.add({targets:this,y:s,scaleX:1,scaleY:1,duration:150,ease:"Power2"})}),this.on("pointerdown",n),e.add.existing(this)}destroy(e){this.glowTween&&this.glowTween.stop(),super.destroy(e)}}class Ce extends p.Scene{constructor(){super({key:"RunScene"});c(this,"character");c(this,"player");c(this,"ball");c(this,"teammates",[]);c(this,"enemies",[]);c(this,"inputSystem");c(this,"upgradeSystem");c(this,"momentSystem");c(this,"uiSystem");c(this,"audioSystem");c(this,"aiSystem");c(this,"particleManager");c(this,"trailManager");c(this,"toastManager");c(this,"fieldWidth",1200);c(this,"fieldHeight",700);c(this,"goalWidth",40);c(this,"goalHeight",120);c(this,"leftGoalSensor");c(this,"rightGoalSensor");c(this,"leftNetZone");c(this,"rightNetZone");c(this,"leftGoalGraphics");c(this,"rightGoalGraphics");c(this,"isPaused",!1);c(this,"isTransitioning",!1);c(this,"isGoalScored",!1);c(this,"isCountingDown",!1);c(this,"momentStats",{goalsScored:0,goalsConceded:0,tacklesWon:0,tacklesLost:0,passesCompleted:0,passesAttempted:0,shotsOnTarget:0,shotsTaken:0,possessionTime:0,totalTime:0});c(this,"lastPossessionCheck",0)}init(e){this.character=e.character,this.resetMomentStats()}create(){this.physics.world.setBounds(0,0,this.fieldWidth,this.fieldHeight),this.initializeSystems(),this.createField(),this.createGoals(),this.createEntities(),this.setupCollisions(),this.setupEventListeners(),this.uiSystem.createGameHUD(),this.particleManager.init(),this.momentSystem.startRun(10);const e=b.getInstance();e.getStat("hasSeenTutorial")?this.time.delayedCall(500,()=>{this.startMoment()}):this.uiSystem.showFirstRunTutorial(()=>{e.incrementStat("hasSeenTutorial"),this.startMoment()}),this.cameras.main.setBounds(0,0,this.fieldWidth,this.fieldHeight),this.cameras.main.startFollow(this.player,!0,.1,.1),this.cameras.main.setZoom(1),this.cameras.main.fadeIn(300),this.input.setTopOnly(!0)}initializeSystems(){this.inputSystem=new ce(this),this.upgradeSystem=new le(this),this.momentSystem=new fe(this),this.uiSystem=new pe(this),this.audioSystem=new R(this),this.aiSystem=new v(this),this.particleManager=new ue(this),this.trailManager=new ye(this),this.toastManager=new W(this),this.audioSystem=this.audioSystem,this.inputSystem=this.inputSystem}createField(){for(let t=0;t<this.fieldHeight;t+=40){const s=Math.floor(t/40)%2===0?2263842:1997598;this.add.rectangle(this.fieldWidth/2,t+20,this.fieldWidth,40,s).setDepth(0)}const e=this.add.graphics();e.lineStyle(4,16777215,.8),e.setDepth(1),e.strokeRect(20,20,this.fieldWidth-40,this.fieldHeight-40),e.beginPath(),e.moveTo(this.fieldWidth/2,20),e.lineTo(this.fieldWidth/2,this.fieldHeight-20),e.strokePath(),e.strokeCircle(this.fieldWidth/2,this.fieldHeight/2,60),e.beginPath(),e.moveTo(250,20),e.lineTo(250,this.fieldHeight-20),e.strokePath(),e.beginPath(),e.moveTo(this.fieldWidth-250,20),e.lineTo(this.fieldWidth-250,this.fieldHeight-20),e.strokePath(),e.strokeCircle(0,this.fieldHeight/2,120),e.strokeCircle(this.fieldWidth,this.fieldHeight/2,120),e.fillStyle(1727002,.5),e.fillRect(0,this.fieldHeight/2-60,20,120),e.fillRect(this.fieldWidth-20,this.fieldHeight/2-60,20,120)}createGoals(){const e=this.fieldHeight/2;this.leftGoalSensor=this.add.zone(8,e,16,this.goalHeight),this.physics.add.existing(this.leftGoalSensor,!0),this.leftNetZone=this.add.zone(-20,e,30,this.goalHeight+40),this.physics.add.existing(this.leftNetZone,!0),this.leftGoalGraphics=this.add.graphics(),this.drawGoal(this.leftGoalGraphics,0,e-60,!0),this.rightGoalSensor=this.add.zone(this.fieldWidth-8,e,16,this.goalHeight),this.physics.add.existing(this.rightGoalSensor,!0),this.rightNetZone=this.add.zone(this.fieldWidth+20,e,30,this.goalHeight+40),this.physics.add.existing(this.rightNetZone,!0),this.rightGoalGraphics=this.add.graphics(),this.drawGoal(this.rightGoalGraphics,this.fieldWidth-15,e-60,!1)}drawGoal(e,t,s,i){e.setDepth(2),e.fillStyle(16777215,1),e.fillRect(t,s,4,120),e.fillRect(t+11,s,4,120),e.fillRect(t,s-4,15,4),e.fillStyle(3355443,.9),e.fillRect(t,s,15,120),e.lineStyle(1,13421772,.5);for(let n=0;n<12;n++)e.beginPath(),e.moveTo(t,s+n*10),e.lineTo(t+15,s+n*10),e.strokePath();for(let n=0;n<3;n++)e.beginPath(),e.moveTo(t+n*5,s),e.lineTo(t+n*5,s+120),e.strokePath()}shakeGoalNet(e){const t=e?this.leftGoalGraphics:this.rightGoalGraphics;this.tweens.add({targets:t,x:t.x+(e?-5:5),duration:50,yoyo:!0,repeat:3,ease:"Sine.easeInOut"})}createEntities(){this.player=new oe(this,200,this.fieldHeight/2,this.character),this.player.setUpgradeSystem(this.upgradeSystem),this.player.onShoot=(e,t)=>{this.audioSystem.playShoot(),this.ball.shoot(e,t,this.player),this.momentStats.shotsTaken++,this.fieldWidth,Math.cos(t)>.3&&this.momentStats.shotsOnTarget++},this.player.onPass=e=>{this.audioSystem.playPass();const t=this.player.stats.passPower*25;this.ball.pass(t,e,this.player),this.momentStats.passesAttempted++},this.player.onTackle=()=>{this.audioSystem.playTackle(),this.attemptTackle(this.player)},this.player.onDodge=()=>{this.audioSystem.playDodge(),this.particleManager.dodgeEffect(this.player.x,this.player.y,this.player.getFacingAngle())},this.player.onShootFailed=()=>{this.uiSystem.showNoPossessionFeedback(),this.audioSystem.playClick()},this.ball=new ae(this,this.fieldWidth/2,this.fieldHeight/2),this.createTeammates(3),this.createEnemies(3),this.updateEntityReferences()}createTeammates(e){this.teammates.forEach(i=>i.destroy()),this.teammates=[];const t=["defender","midfielder","forward"],s=[{x:150,y:this.fieldHeight/2-150},{x:350,y:this.fieldHeight/2},{x:500,y:this.fieldHeight/2+100}];for(let i=0;i<Math.min(e,3);i++){const n=new ne(this,s[i].x,s[i].y,t[i],this.getColorIndex(this.character.color));n.onShoot=(a,r)=>{this.ball.shoot(a,r,n)},n.onPass=(a,r)=>{this.ball.pass(200,a,n)},n.onTackle=a=>{this.attemptTackle(n,a)},this.teammates.push(n)}}createEnemies(e,t=!1){this.enemies.forEach(r=>r.destroy()),this.enemies=[];const s=["defender","midfielder","forward"],i=[{x:this.fieldWidth-150,y:this.fieldHeight/2},{x:this.fieldWidth-350,y:this.fieldHeight/2-120},{x:this.fieldWidth-450,y:this.fieldHeight/2+120},{x:this.fieldWidth-550,y:this.fieldHeight/2},{x:this.fieldWidth-300,y:this.fieldHeight/2}],n=this.momentSystem.getCurrentMoment(),a=n?(n.difficulty-1)/4:.5;for(let r=0;r<Math.min(e,5);r++){const l=t&&r===0,d=new re(this,i[r].x,i[r].y,s[r%3],l?"boss":"normal",a);d.onShoot=(h,f)=>{this.ball.shoot(h,f,d)},d.onPass=(h,f)=>{this.ball.pass(180,h,d)},d.onTackle=h=>{this.attemptTackle(d,h)},this.enemies.push(d)}}updateEntityReferences(){this.teammates.forEach(e=>{e.setReferences(this.player,this.teammates,this.enemies,this.ball)}),this.enemies.forEach(e=>{e.setReferences(this.player,this.teammates,this.enemies,this.ball)})}getColorIndex(e){const s=[3447003,15158332,3066993,10181046,15965202,1752220,15105570,9323693,15844367,1482885,12597547,2600544,13849600,2719929,9109504,48340,6765239,16733986,3426654,15277667].indexOf(e);return s>=0?s:0}setupCollisions(){this.physics.add.overlap(this.player,this.ball,()=>{this.ball.isLoose&&!this.player.hasBall&&!this.player.isStunned&&(this.ball.attachTo(this.player),this.player.receiveBall(),this.momentStats.passesCompleted++)}),this.teammates.forEach(e=>{this.physics.add.overlap(e,this.ball,()=>{this.ball.isLoose&&!e.hasBall&&!e.isStunned&&(this.ball.attachTo(e),e.receiveBall())})}),this.enemies.forEach(e=>{this.physics.add.overlap(e,this.ball,()=>{this.ball.isLoose&&!e.hasBall&&!e.isStunned&&(this.ball.attachTo(e),e.receiveBall())})}),this.physics.add.overlap(this.ball,this.rightGoalSensor,()=>{!this.isGoalScored&&!this.isTransitioning&&this.isValidGoal(!0)&&this.scoreGoal(!0)}),this.physics.add.overlap(this.ball,this.leftGoalSensor,()=>{!this.isGoalScored&&!this.isTransitioning&&this.isValidGoal(!1)&&this.scoreGoal(!1)}),this.physics.add.overlap(this.ball,this.rightNetZone,()=>{!this.isGoalScored&&this.ball.isLoose&&this.bounceFromNet(!1)}),this.physics.add.overlap(this.ball,this.leftNetZone,()=>{!this.isGoalScored&&this.ball.isLoose&&this.bounceFromNet(!0)})}isValidGoal(e){if(!this.ball.isLoose)return!1;const t=this.ball.body.velocity;if(t.length()<30)return!1;const i=t.x>0,n=t.x<0;if(e&&!i||!e&&!n)return!1;const a=this.fieldHeight/2,r=this.goalHeight/2;return!(this.ball.y<a-r||this.ball.y>a+r)}bounceFromNet(e){const t=this.ball.body.velocity,s=e?Math.abs(t.x)*.4:-Math.abs(t.x)*.4,i=t.y*.5;this.ball.setVelocity(s,i),this.shakeGoalNet(e)}setupEventListeners(){this.momentSystem.on("momentStarted",e=>{this.toastManager.info(`${e.moment.name}`,e.moment.description)}),this.momentSystem.on("momentComplete",e=>{this.handleMomentComplete(e)}),this.momentSystem.on("timerTick",e=>{const t=this.momentSystem.getCurrentState();if(t){const s=this.momentSystem.getProgress();this.uiSystem.updateFromMomentState(t,s.current,s.total)}}),this.momentSystem.on("timerWarning",e=>{this.audioSystem.playTimer()}),this.momentSystem.on("runComplete",e=>{this.endRun(e)}),this.upgradeSystem.on("upgradeAdded",e=>{this.uiSystem.addUpgradeIcon(e.icon,e.name)})}startMoment(){this.isTransitioning=!1,this.isGoalScored=!1,this.resetMomentStats(),this.resetPositions();const e=this.momentSystem.getCurrentMoment();e&&(this.createTeammates(e.teamSize.player-1),this.createEnemies(e.teamSize.enemy,e.isBoss),this.updateEntityReferences(),this.setupCollisions(),e.modifiers.forEach(t=>{t.effect==="reducedControl"&&(this.player.stats.control*=.8)}),this.momentSystem.startMoment(),this.upgradeSystem.resetMoment(),e.objective==="defend"||e.objective==="survive"?this.enemies.length>0&&(this.ball.attachTo(this.enemies[0]),this.enemies[0].receiveBall()):(this.ball.attachTo(this.player),this.player.receiveBall()),this.audioSystem.playWhistle())}resetPositions(){this.player.setPosition(200,this.fieldHeight/2),this.player.setVelocity(0,0),this.player.hasBall=!1,this.ball.resetToCenter()}resetMomentStats(){this.momentStats={goalsScored:0,goalsConceded:0,tacklesWon:0,tacklesLost:0,passesCompleted:0,passesAttempted:0,shotsOnTarget:0,shotsTaken:0,possessionTime:0,totalTime:0},this.lastPossessionCheck=this.time.now}attemptTackle(e,t){var a;let i=null;if(t&&t.hasBall?i=t:i=[this.player,...this.teammates,...this.enemies].find(l=>l.hasBall&&l!==e),!i)return;if(p.Math.Distance.Between(e.x,e.y,i.x,i.y)<60){const r=.6+(((a=e.stats)==null?void 0:a.tackle)||5)*.04;Math.random()<r?(i.loseBall(),i.applyStun(300),this.ball.drop(),this.particleManager.tackleImpact(i.x,i.y),this.audioSystem.playSteal(),e===this.player&&(this.momentStats.tacklesWon++,this.upgradeSystem.trigger("onSteal",{player:this.player,target:i,scene:this}),b.getInstance().incrementStat("totalSteals"),this.momentSystem.playerStole())):(e.applyStun(200),e===this.player&&this.momentStats.tacklesLost++),b.getInstance().incrementStat("totalTackles")}}scoreGoal(e){if(this.isGoalScored=!0,this.isTransitioning=!0,this.ball.setVelocity(0,0),this.cameras.main.shake(200,.01),e){this.momentStats.goalsScored++,this.audioSystem.playGoal(),this.particleManager.goalCelebration(this.fieldWidth-50,this.fieldHeight/2),this.uiSystem.showGoalNotification(!0),this.shakeGoalNet(!1);const t=this.ball.isRebound,s=this.ball.lastOwner,i=s&&s!==this.ball.lastShooter;this.momentSystem.playerScored(t,i),this.upgradeSystem.trigger("onGoal",{player:this.player,scene:this}),b.getInstance().incrementStat("totalGoals"),t&&b.getInstance().incrementStat("totalReboundGoals"),i&&b.getInstance().incrementStat("totalAssists")}else this.momentStats.goalsConceded++,this.audioSystem.playConcede(),this.uiSystem.showGoalNotification(!1),this.shakeGoalNet(!0),this.momentSystem.enemyScored();this.time.delayedCall(900,()=>{this.showKickoffCountdown()})}showKickoffCountdown(){var s;if((s=this.momentSystem.getCurrentState())!=null&&s.isComplete){this.isGoalScored=!1;return}this.isCountingDown=!0,this.resetPositions();let e=3;const t=this.add.text(this.cameras.main.centerX,this.cameras.main.centerY,e.toString(),{fontFamily:"Arial, sans-serif",fontSize:"72px",color:"#ffffff",fontStyle:"bold",stroke:"#000000",strokeThickness:6});t.setOrigin(.5),t.setScrollFactor(0),t.setDepth(150),this.time.addEvent({delay:600,callback:()=>{e--,e>0?(t.setText(e.toString()),this.tweens.add({targets:t,scaleX:1.3,scaleY:1.3,duration:100,yoyo:!0})):(t.destroy(),this.isGoalScored=!1,this.isTransitioning=!1,this.isCountingDown=!1,this.ball.attachTo(this.player),this.player.receiveBall(),this.audioSystem.playWhistle())},repeat:3})}handleMomentComplete(e){var t,s,i;this.isTransitioning=!0,this.momentStats.totalTime=e.isWon?((t=this.momentSystem.getCurrentMoment())==null?void 0:t.duration)||45:(((s=this.momentSystem.getCurrentMoment())==null?void 0:s.duration)||45)-(((i=this.momentSystem.getCurrentState())==null?void 0:i.timeRemaining)||0),this.uiSystem.showMomentComplete(e.isWon),this.time.delayedCall(2e3,()=>{this.momentStats.shotsTaken>0||this.momentStats.tacklesWon>0?this.uiSystem.showMomentRecap(this.momentStats,()=>{this.proceedAfterMoment()}):this.proceedAfterMoment()})}proceedAfterMoment(){this.momentSystem.nextMoment()&&this.showUpgradeDraft()}showUpgradeDraft(){const e=this.momentSystem.getProgress(),t=b.getInstance(),s=t.getMetaUpgradeLevel("upgradeChoices"),i=t.getMetaUpgradeLevel("rerollCount");new xe(this,{momentNumber:e.current,ownedUpgradeIds:this.upgradeSystem.getOwnedUpgradeIds(),extraChoices:s,rerolls:i,onSelect:n=>{this.upgradeSystem.addUpgrade(n),this.audioSystem.playUpgrade(),this.toastManager.success(`${n.name}`,n.icon),this.time.delayedCall(500,()=>{this.startMoment()})},onSkip:()=>{this.startMoment()}})}endRun(e){this.time.delayedCall(1e3,()=>{this.cameras.main.fadeOut(500),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("EndRunScene",{stats:e.stats,reward:e.reward,breakdown:e.breakdown,upgrades:this.upgradeSystem.getOwnedUpgrades(),character:this.character})})})}update(e,t){if(this.isPaused||this.isCountingDown)return;const s=this.inputSystem.getState(this.player.x,this.player.y);if(s.showHelp){this.uiSystem.toggleControlsOverlay();return}if(this.uiSystem.isControlsVisible()){s.cancel&&this.uiSystem.hideControlsOverlay();return}if(s.pause){this.togglePause();return}if(this.isTransitioning)return;this.player.update(t,s),this.ball.update(t),this.aiSystem.updateTeamStates(this.ball,this.player,this.teammates,this.enemies,t),this.teammates.forEach(a=>a.update(t)),this.enemies.forEach(a=>a.update(t)),this.player.isMoving&&Math.sqrt(this.player.body.velocity.x**2+this.player.body.velocity.y**2)>150&&(this.trailManager.spawn(this.player.x,this.player.y,"speed"),this.particleManager.emitSprint(this.player.x,this.player.y,this.player.body.velocity.x,this.player.body.velocity.y)),this.trailManager.update(t);const i=this.player.getCooldowns();this.uiSystem.updateCooldown("shoot",i.shoot),this.uiSystem.updateCooldown("pass",i.pass),this.uiSystem.updateCooldown("tackle",i.tackle),this.uiSystem.updateCooldown("dodge",i.dodge);const n=this.player.hasBall||this.teammates.some(a=>a.hasBall);this.uiSystem.updatePossession(n),n&&(this.momentStats.possessionTime+=t/1e3),this.uiSystem.updateRadar(this.player,this.teammates,this.enemies,this.ball),this.upgradeSystem.trigger("onTick",{player:this.player,ball:this.ball,position:{x:this.player.x,y:this.player.y},scene:this})}togglePause(){this.isPaused=!this.isPaused,this.isPaused?(this.physics.pause(),this.showPauseMenu()):(this.physics.resume(),this.hidePauseMenu())}showPauseMenu(){const e=this.cameras.main.width,t=this.cameras.main.height,s=this.add.container(0,0);s.setScrollFactor(0),s.setDepth(200),this.pauseOverlay=s;const i=this.add.rectangle(e/2,t/2,e,t,0,.7);s.add(i);const n=this.add.text(e/2,t/2-100,"PAUSED",{fontFamily:"Arial, sans-serif",fontSize:"48px",color:"#ffffff",fontStyle:"bold"});n.setOrigin(.5),s.add(n);const a=this.createPauseButton(e/2,t/2,"RESUME",()=>{this.togglePause()});s.add(a);const r=this.createPauseButton(e/2,t/2+60,"CONTROLS",()=>{this.uiSystem.showControlsOverlay()});s.add(r);const l=this.createPauseButton(e/2,t/2+120,"QUIT RUN",()=>{this.scene.start("MenuScene")});s.add(l)}createPauseButton(e,t,s,i){const n=this.add.container(e,t),a=this.add.graphics();a.fillStyle(2899536,1),a.fillRoundedRect(-100,-20,200,40,8),n.add(a);const r=this.add.text(0,0,s,{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#ffffff",fontStyle:"bold"});r.setOrigin(.5),n.add(r);const l=this.add.rectangle(0,0,200,40,0,0);return l.setInteractive({useHandCursor:!0}),n.add(l),l.on("pointerdown",i),l.on("pointerover",()=>{a.clear(),a.fillStyle(3447003,1),a.fillRoundedRect(-100,-20,200,40,8)}),l.on("pointerout",()=>{a.clear(),a.fillStyle(2899536,1),a.fillRoundedRect(-100,-20,200,40,8)}),n}hidePauseMenu(){const e=this.pauseOverlay;e&&(e.destroy(),this.pauseOverlay=null)}}class ve extends p.Scene{constructor(){super({key:"EndRunScene"});c(this,"audioSystem");c(this,"runData");c(this,"tooltipContainer")}init(e){this.runData=e}create(){this.audioSystem=new R(this),this.cameras.main.setBackgroundColor(1710638);const e=this.runData.stats.momentsWon>this.runData.stats.momentsLost;this.createTitle(e),this.createStatsPanel(),this.createRewardsPanel(),this.createUpgradesPanel(),this.createButtons(),this.cameras.main.fadeIn(500),e?this.audioSystem.playGoal():this.audioSystem.playConcede()}createTitle(e){const t=this.cameras.main.centerX,s=e?"üèÜ RUN COMPLETE!":"üíî RUN OVER",i=e?"#f1c40f":"#e74c3c",n=this.add.text(t,50,s,{fontFamily:"Arial, sans-serif",fontSize:"42px",color:i,fontStyle:"bold",stroke:"#000000",strokeThickness:4});n.setOrigin(.5),this.add.text(t,95,`Played as ${this.runData.character.name}`,{fontFamily:"Arial, sans-serif",fontSize:"18px",color:"#bdc3c7"}).setOrigin(.5),this.tweens.add({targets:n,scaleX:1.05,scaleY:1.05,duration:1e3,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"})}createStatsPanel(){const n=this.add.graphics();n.fillStyle(2899536,.9),n.fillRoundedRect(200-300/2,150,300,280,15),n.lineStyle(2,3447003,.5),n.strokeRoundedRect(200-300/2,150,300,280,15),this.add.text(200,175,"üìä STATS",{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#3498db",fontStyle:"bold"}).setOrigin(.5),[{label:"Moments Won",value:this.runData.stats.momentsWon,color:"#27ae60"},{label:"Moments Lost",value:this.runData.stats.momentsLost,color:"#e74c3c"},{label:"Goals Scored",value:this.runData.stats.goalsScored,color:"#f1c40f"},{label:"Goals Conceded",value:this.runData.stats.goalsConceded,color:"#e67e22"},{label:"Rebound Goals",value:this.runData.stats.reboundGoals,color:"#9b59b6"},{label:"Clean Sheets",value:this.runData.stats.cleanSheets,color:"#1abc9c"},{label:"Bosses Beaten",value:this.runData.stats.bossesBeaten,color:"#e74c3c"}].forEach((l,d)=>{const h=210+d*30;this.add.text(80,h,l.label,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:"#bdc3c7"}),this.add.text(300,h,l.value.toString(),{fontFamily:"Arial, sans-serif",fontSize:"16px",color:l.color,fontStyle:"bold"}).setOrigin(1,0)})}createRewardsPanel(){const e=this.cameras.main.width-200,t=150,s=300,i=280,n=this.add.graphics();n.fillStyle(2899536,.9),n.fillRoundedRect(e-s/2,t,s,i,15),n.lineStyle(2,15844367,.5),n.strokeRoundedRect(e-s/2,t,s,i,15),this.add.text(e,t+25,"üíé REWARDS",{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#f1c40f",fontStyle:"bold"}).setOrigin(.5),[{label:"Base Reward",value:this.runData.breakdown.base},{label:"Moment Wins",value:this.runData.breakdown.momentWins},{label:"Boss Wins",value:this.runData.breakdown.bosses},{label:"Clean Sheets",value:this.runData.breakdown.cleanSheets},{label:"Goals",value:this.runData.breakdown.goals},{label:"Bonus",value:this.runData.breakdown.bonus}].forEach((f,m)=>{const u=t+60+m*28;this.add.text(e-120,u,f.label,{fontFamily:"Arial, sans-serif",fontSize:"13px",color:"#bdc3c7"}),this.add.text(e+100,u,`+${f.value}`,{fontFamily:"Arial, sans-serif",fontSize:"14px",color:f.value>0?"#f1c40f":"#7f8c8d"}).setOrigin(1,0)});const l=t+230;this.add.graphics().lineStyle(1,15844367,.5).lineBetween(e-120,l,e+100,l),this.add.text(e-120,l+10,"TOTAL",{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#ffffff",fontStyle:"bold"});const d=this.add.text(e+100,l+10,`üíé ${this.runData.reward}`,{fontFamily:"Arial, sans-serif",fontSize:"20px",color:"#f1c40f",fontStyle:"bold"});d.setOrigin(1,0),this.tweens.add({targets:d,scaleX:1.1,scaleY:1.1,duration:500,yoyo:!0,repeat:-1});const h=b.getInstance().getGems();this.add.text(e,t+i-20,`Total Gems: ${h}`,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#7f8c8d"}).setOrigin(.5)}createUpgradesPanel(){const e=this.cameras.main.centerX,t=460,s=700,i=120,n=this.add.graphics();n.fillStyle(2899536,.9),n.fillRoundedRect(e-s/2,t,s,i,15),n.lineStyle(2,10181046,.5),n.strokeRoundedRect(e-s/2,t,s,i,15),this.add.text(e,t+20,`‚ö° UPGRADES COLLECTED (${this.runData.upgrades.length})`,{fontFamily:"Arial, sans-serif",fontSize:"16px",color:"#9b59b6",fontStyle:"bold"}).setOrigin(.5);const a=12,r=this.runData.upgrades.slice(0,a),l=40,d=e-Math.min(r.length,12)*(l+10)/2+l/2;r.forEach((m,u)=>{const y=d+u*(l+10),k=t+70,w=E[m.rarity],S=this.add.circle(y,k,l/2,1710638);S.setStrokeStyle(2,w),this.add.text(y,k,m.icon,{fontSize:"20px"}).setOrigin(.5),S.setInteractive(),S.on("pointerover",()=>{this.showUpgradeTooltip(y,t-10,m)}),S.on("pointerout",()=>{this.hideUpgradeTooltip()})}),this.runData.upgrades.length>a&&this.add.text(e+320,t+70,`+${this.runData.upgrades.length-a} more`,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#7f8c8d"}).setOrigin(0,.5);const h=new Map;this.runData.upgrades.forEach(m=>{m.synergies.forEach(u=>{h.set(u,(h.get(u)||0)+1)})});const f=Array.from(h.entries()).filter(([m,u])=>u>=3).sort((m,u)=>u[1]-m[1]).slice(0,4);if(f.length>0){const m=f.map(([u,y])=>`${Y[u]} (${y})`).join("  ‚Ä¢  ");this.add.text(e,t+100,`Active Synergies: ${m}`,{fontFamily:"Arial, sans-serif",fontSize:"11px",color:"#27ae60"}).setOrigin(.5)}}showUpgradeTooltip(e,t,s){this.hideUpgradeTooltip(),this.tooltipContainer=this.add.container(e,t);const i=this.add.graphics();i.fillStyle(1710638,.95),i.fillRoundedRect(-80,-50,160,50,8),i.lineStyle(1,E[s.rarity],.8),i.strokeRoundedRect(-80,-50,160,50,8),this.tooltipContainer.add(i);const n=this.add.text(0,-40,s.name,{fontFamily:"Arial, sans-serif",fontSize:"12px",color:"#ffffff",fontStyle:"bold"});n.setOrigin(.5),this.tooltipContainer.add(n);const a=this.add.text(0,-22,s.description,{fontFamily:"Arial, sans-serif",fontSize:"10px",color:"#bdc3c7",align:"center",wordWrap:{width:150}});a.setOrigin(.5),this.tooltipContainer.add(a),this.tooltipContainer.setDepth(100)}hideUpgradeTooltip(){this.tooltipContainer&&(this.tooltipContainer.destroy(),this.tooltipContainer=void 0)}createButtons(){const e=this.cameras.main.centerX,t=this.cameras.main.height-60;new T(this,{x:e-120,y:t,width:180,height:50,text:"üîÑ Play Again",fontSize:18,style:"success",onClick:()=>{this.audioSystem.playClick(),this.cameras.main.fadeOut(300),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("CharacterSelectScene")})}}),new T(this,{x:e+120,y:t,width:180,height:50,text:"üè† Main Menu",fontSize:18,style:"secondary",onClick:()=>{this.audioSystem.playClick(),this.cameras.main.fadeOut(300),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start("MenuScene")})}})}}function Pe(g,o){if(console.error("[CRITICAL ERROR]",g,o),document.getElementById("critical-error-overlay"))return;const e=document.createElement("div");e.id="critical-error-overlay",e.style.cssText=`
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: #1a1a2e;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 99999;
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
    box-sizing: border-box;
  `,e.innerHTML=`
    <h1 style="color: #e74c3c; margin-bottom: 20px;">‚ùå Game Failed to Load</h1>
    <p style="color: #bdc3c7; margin-bottom: 10px; max-width: 500px;">${g}</p>
    ${o?`<pre style="background: #2c3e50; padding: 15px; border-radius: 8px; max-width: 600px; overflow-x: auto; font-size: 12px; color: #e74c3c; text-align: left;">${o}</pre>`:""}
    <p style="color: #7f8c8d; margin: 20px 0; font-size: 14px;">Press F12 to open DevTools for more info</p>
    <button onclick="location.reload()" style="
      background: #3498db;
      color: white;
      border: none;
      padding: 12px 30px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
    ">üîÑ Refresh Page</button>
  `,document.body.appendChild(e)}window.addEventListener("error",g=>{console.error("[Window Error]",g.message,g.filename,g.lineno)});window.addEventListener("unhandledrejection",g=>{console.error("[Unhandled Rejection]",g.reason)});console.log("üèë Stick & Shift - Field Hockey Roguelike");console.log("üì¶ Built with Phaser 3 + TypeScript + Vite");console.log("üöÄ Starting game initialization...");try{const g={type:p.AUTO,parent:"game-container",width:1200,height:700,backgroundColor:"#1a1a2e",scale:{mode:p.Scale.FIT,autoCenter:p.Scale.CENTER_BOTH,min:{width:800,height:450},max:{width:1920,height:1080}},physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}},render:{pixelArt:!1,antialias:!0,antialiasGL:!0},input:{keyboard:!0,mouse:!0,touch:!0},scene:[N,K,se,ie,Ce,ve],callbacks:{preBoot:e=>{console.log("[Phaser] Pre-boot")},postBoot:e=>{console.log("[Phaser] Post-boot - Game instance created")}}};console.log("[Main] Creating Phaser game instance...");const o=new p.Game(g);o.events.once("ready",()=>{console.log("[Phaser] Game ready")}),o.events.once("boot",()=>{console.log("[Phaser] Game boot")}),window.addEventListener("resize",()=>{o&&o.scale&&o.scale.refresh()}),document.addEventListener("contextmenu",e=>{e.preventDefault()}),console.log("[Main] Game instance created successfully"),window.game=o}catch(g){const o=g instanceof Error?g.message:String(g),e=g instanceof Error?g.stack:"";console.error("[Main] Fatal error during game initialization:",g),Pe("Failed to initialize game engine.",`${o}

${e}`)}
